<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Chipi</title>

    <!--
    Generative supports the most popular creative coding libraries. Simply uncomment the library you want to use below.
    Are we missing an important library? Let us know @generative_xyz.
    -->

    <!-- p5js@1.5.0
    <script sandbox="allow-scripts" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/p5.min.js"></script>
    -->

    <!-- c2.min.js@1.0.0
    <script sandbox="allow-scripts" type="text/javascript" src="https://cdn.generative.xyz/ajax/libs/c2/1.0.0/c2.min.js"></script>
    -->

    <!-- chromajs@2.4.2
    <script sandbox="allow-scripts" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/2.4.2/chroma.min.js"></script>
    -->

    <!-- p5.grain.js@0.6.1
    <script sandbox="allow-scripts" type="text/javascript" src="https://cdn.generative.xyz/ajax/libs/p5.grain/0.6.1/p5.grain.min.js"></script>
    -->

    <!-- threejs@r124
    <script sandbox="allow-scripts" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r124/three.min.js"></script>
    -->

    <!-- tonejs@14.8.49
    <script sandbox="allow-scripts" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    -->

    <!-- web3js@1.2.7
    <script sandbox="allow-scripts" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.2.7-rc.0/web3.min.js"></script>
    -->

    <!-- svgjs@3.1.2
    <script sandbox="allow-scripts" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/svg.js/3.1.2/svg.min.js"></script>
    -->

    <!-- aframejs@1.2.0
    <script sandbox="allow-scripts" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/aframe/1.2.0/aframe.min.js"></script>
    -->

    <!-- babylonjs@5.47.0
    <script sandbox="allow-scripts" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/babylonjs/5.47.0/babylon.js"></script>
    -->

    <!-- paperjs@0.12.17
    <script sandbox="allow-scripts" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/paper.js/0.12.17/paper-full.min.js"></script>
    -->

    <!-- regljs@2.1.0     -->    
    <script sandbox="allow-scripts" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/regl/2.1.0/regl.min.js"></script>

    <script type="text/javascript">

        // ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ Add your script for lib here ↓↓↓↓↓↓↓↓↓↓↓↓↓↓
        // MathRand function for randomness
    //    function mathRand(min, max) {
      //      return Math.random() * (max - min) + min;
        //}

        // Initialize regl
//        const regl = createRegl({
  //          container: document.getElementById('generativeContainer'),
     //   });

        // Load text.js
//        const text = createText(regl);

        // ADDING MORE:
            // MathRand function for randomness
        function mathRand(min, max) {
            return Math.random() * (max - min) + min;
        }

        // Initialize regl
        const regl = createRegl({
            container: document.getElementById('generativeContainer'),
        });

        // Load life.js
        const life = (function () {
            // Paste the content of life.js here
            // ...

            return regl({
                // Configuration options for life.js
                // ...
                /*
  tags: fbo, basic

  <p>This example implements the game of life in regl.</p>

 */
           (function e$$0(r, A, f) {
                function m(g, h) {
                    if (!A[g]) {
                        if (!r[g]) {
                            var a = "function" == typeof require && require;
                            if (!h && a)
                                return a(g, !0);
                            if (k)
                                return k(g, !0);
                            a = Error("Cannot find module '" + g + "'");
                            throw a.code = "MODULE_NOT_FOUND",
                            a;
                        }
                        a = A[g] = {
                            exports: {}
                        };
                        r[g][0].call(a.exports, function(a) {
                            var f = r[g][1][a];
                            return m(f ? f : a)
                        }, a, a.exports, e$$0, r, A, f)
                    }
                    return A[g].exports
                }
                for (var k = "function" == typeof require && require, l = 0; l < f.length; l++)
                    m(f[l]);
                return m
            }
            )({
                1: [function(c, r, A) {
                    var f = c("../regl")()
                      , m = Array(1048576).fill(0).map(function() {
                        return .9 < Math.random() ? 255 : 0
                    })
                      , k = Array(2).fill().map(function() {
                        return f.framebuffer({
                            color: f.texture({
                                radius: 512,
                                data: m,
                                wrap: "repeat"
                            }),
                            depthStencil: !1
                        })
                    })
                      , l = f({
                        frag: "\n  precision mediump float;\n  uniform sampler2D prevState;\n  varying vec2 uv;\n  void main() {\n    float n = 0.0;\n    for(int dx=-1; dx<=1; ++dx)\n    for(int dy=-1; dy<=1; ++dy) {\n      n += texture2D(prevState, uv+vec2(dx,dy)/float(512)).r;\n    }\n    float s = texture2D(prevState, uv).r;\n    if(n > 3.0+s || n < 3.0) {\n      gl_FragColor = vec4(0,0,0,1);\n    } else {\n      gl_FragColor = vec4(1,1,1,1);\n    }\n  }",
                        framebuffer: function(g) {
                            return k[(g.tick + 1) % 2]
                        }
                    })
                      , g = f({
                        frag: "\n  precision mediump float;\n  uniform sampler2D prevState;\n  varying vec2 uv;\n  void main() {\n    float state = texture2D(prevState, uv).r;\n    gl_FragColor = vec4(vec3(state), 1);\n  }",
                        vert: "\n  precision mediump float;\n  attribute vec2 position;\n  varying vec2 uv;\n  void main() {\n    uv = 0.5 * (position + 1.0);\n    gl_Position = vec4(position, 0, 1);\n  }",
                        attributes: {
                            position: [-4, -4, 4, -4, 0, 4]
                        },
                        uniforms: {
                            prevState: function(g) {
                                return k[g.tick % 2]
                            }
                        },
                        depth: {
                            enable: !1
                        },
                        count: 3
                    });
                    f.frame(function() {
                        g(function() {
                            f.draw();
                            l()
                        })
                    })
                }
                , {
                    "../regl": 35
                }],
                2: [function(c, r, A) {
                    function f() {
                        this.w = this.z = this.y = this.x = this.state = 0;
                        this.buffer = null;
                        this.size = 0;
                        this.normalized = !1;
                        this.type = 5126;
                        this.divisor = this.stride = this.offset = 0
                    }
                    r.exports = function(m, k, l, g, h) {
                        m = l.maxAttributes;
                        k = Array(m);
                        for (l = 0; l < m; ++l)
                            k[l] = new f;
                        return {
                            Record: f,
                            scope: {},
                            state: k
                        }
                    }
                }
                , {}],
                3: [function(c, r, A) {
                    function f(a) {
                        return v[Object.prototype.toString.call(a)] | 0
                    }
                    function m(a, g) {
                        for (var f = 0; f < g.length; ++f)
                            a[f] = g[f]
                    }
                    function k(a, g, f, h, k, l, n) {
                        for (var b = 0, e = 0; e < f; ++e)
                            for (var D = 0; D < h; ++D)
                                a[b++] = g[k * e + l * D + n]
                    }
                    var l = c("./util/check")
                      , g = c("./util/is-typed-array")
                      , h = c("./util/is-ndarray")
                      , a = c("./util/values")
                      , q = c("./util/pool");
                    A = c("./util/flatten");
                    var B = A.flatten
                      , E = A.shape
                      , v = c("./constants/arraytypes.json")
                      , n = c("./constants/dtypes.json")
                      , H = c("./constants/usage.json")
                      , F = [];
                    F[5120] = 1;
                    F[5122] = 2;
                    F[5124] = 4;
                    F[5121] = 1;
                    F[5123] = 2;
                    F[5125] = 4;
                    F[5126] = 4;
                    r.exports = function(c, v, z) {
                        function u(a) {
                            this.id = b++;
                            this.buffer = c.createBuffer();
                            this.type = a;
                            this.usage = 35044;
                            this.byteLength = 0;
                            this.dimension = 1;
                            this.dtype = 5121;
                            this.persistentData = null;
                            z.profile && (this.stats = {
                                size: 0
                            })
                        }
                        function Q(a, b, e) {
                            a.byteLength = b.byteLength;
                            c.bufferData(a.type, b, e)
                        }
                        function r(a, b, e, n, c, u) {
                            a.usage = e;
                            if (Array.isArray(b)) {
                                if (a.dtype = n || 5126,
                                0 < b.length)
                                    if (Array.isArray(b[0])) {
                                        c = E(b);
                                        for (var D = n = 1; D < c.length; ++D)
                                            n *= c[D];
                                        a.dimension = n;
                                        b = B(b, c, a.dtype);
                                        Q(a, b, e);
                                        u ? a.persistentData = b : q.freeType(b)
                                    } else
                                        "number" === typeof b[0] ? (a.dimension = c,
                                        c = q.allocType(a.dtype, b.length),
                                        m(c, b),
                                        Q(a, c, e),
                                        u ? a.persistentData = c : q.freeType(c)) : g(b[0]) ? (a.dimension = b[0].length,
                                        a.dtype = n || f(b[0]) || 5126,
                                        b = B(b, [b.length, b[0].length], a.dtype),
                                        Q(a, b, e),
                                        u ? a.persistentData = b : q.freeType(b)) : l.raise("invalid buffer data")
                            } else if (g(b))
                                a.dtype = n || f(b),
                                a.dimension = c,
                                Q(a, b, e),
                                u && (a.persistentData = new Uint8Array(new Uint8Array(b.buffer)));
                            else if (h(b)) {
                                c = b.shape;
                                var v = b.stride
                                  , D = b.offset
                                  , z = 0
                                  , x = 0
                                  , I = 0
                                  , G = 0;
                                1 === c.length ? (z = c[0],
                                x = 1,
                                I = v[0],
                                G = 0) : 2 === c.length ? (z = c[0],
                                x = c[1],
                                I = v[0],
                                G = v[1]) : l.raise("invalid shape");
                                a.dtype = n || f(b.data) || 5126;
                                a.dimension = x;
                                c = q.allocType(a.dtype, z * x);
                                k(c, b.data, z, x, I, G, D);
                                Q(a, c, e);
                                u ? a.persistentData = c : q.freeType(c)
                            } else
                                l.raise("invalid buffer data")
                        }
                        function G(a) {
                            v.bufferCount--;
                            var b = a.buffer;
                            l(b, "buffer must not be deleted already");
                            c.deleteBuffer(b);
                            a.buffer = null;
                            delete e[a.id]
                        }
                        var b = 0
                          , e = {};
                        u.prototype.bind = function() {
                            c.bindBuffer(this.type, this.buffer)
                        }
                        ;
                        u.prototype.destroy = function() {
                            G(this)
                        }
                        ;
                        var D = [];
                        z.profile && (v.getTotalBufferSize = function() {
                            var a = 0;
                            Object.keys(e).forEach(function(b) {
                                a += e[b].stats.size
                            });
                            return a
                        }
                        );
                        return {
                            create: function(a, b, D, Q) {
                                function L(a) {
                                    var b = 35044
                                      , e = null
                                      , f = 0
                                      , k = 0
                                      , V = 1;
                                    Array.isArray(a) || g(a) || h(a) ? e = a : "number" === typeof a ? f = a | 0 : a && (l.type(a, "object", "buffer arguments must be an object, a number or an array"),
                                    "data"in a && (l(null === e || Array.isArray(e) || g(e) || h(e), "invalid data for buffer"),
                                    e = a.data),
                                    "usage"in a && (l.parameter(a.usage, H, "invalid buffer usage"),
                                    b = H[a.usage]),
                                    "type"in a && (l.parameter(a.type, n, "invalid buffer type"),
                                    k = n[a.type]),
                                    "dimension"in a && (l.type(a.dimension, "number", "invalid dimension"),
                                    V = a.dimension | 0),
                                    "length"in a && (l.nni(f, "buffer length must be a nonnegative integer"),
                                    f = a.length | 0));
                                    J.bind();
                                    e ? r(J, e, b, k, V, Q) : (c.bufferData(J.type, f, b),
                                    J.dtype = k || 5121,
                                    J.usage = b,
                                    J.dimension = V,
                                    J.byteLength = f);
                                    z.profile && (J.stats.size = J.byteLength * F[J.dtype]);
                                    return L
                                }
                                function W(a, b) {
                                    l(b + a.byteLength <= J.byteLength, "invalid buffer subdata call, buffer is too small.  Can't write data of size " + a.byteLength + " starting from offset " + b + " to a buffer of size " + J.byteLength);
                                    c.bufferSubData(J.type, b, a)
                                }
                                v.bufferCount++;
                                var J = new u(b);
                                e[J.id] = J;
                                D || L(a);
                                L._reglType = "buffer";
                                L._buffer = J;
                                L.subdata = function(a, b) {
                                    var e = (b || 0) | 0, c;
                                    J.bind();
                                    if (Array.isArray(a)) {
                                        if (0 < a.length)
                                            if ("number" === typeof a[0]) {
                                                var n = q.allocType(J.dtype, a.length);
                                                m(n, a);
                                                W(n, e);
                                                q.freeType(n)
                                            } else
                                                Array.isArray(a[0]) || g(a[0]) ? (c = E(a),
                                                n = B(a, c, J.dtype),
                                                W(n, e),
                                                q.freeType(n)) : l.raise("invalid buffer data")
                                    } else if (g(a))
                                        W(a, e);
                                    else if (h(a)) {
                                        c = a.shape;
                                        var V = a.stride
                                          , u = n = 0
                                          , D = 0
                                          , v = 0;
                                        1 === c.length ? (n = c[0],
                                        u = 1,
                                        D = V[0],
                                        v = 0) : 2 === c.length ? (n = c[0],
                                        u = c[1],
                                        D = V[0],
                                        v = V[1]) : l.raise("invalid shape");
                                        c = Array.isArray(a.data) ? J.dtype : f(a.data);
                                        c = q.allocType(c, n * u);
                                        k(c, a.data, n, u, D, v, a.offset);
                                        W(c, e);
                                        q.freeType(c)
                                    } else
                                        l.raise("invalid data for buffer subdata");
                                    return L
                                }
                                ;
                                z.profile && (L.stats = J.stats);
                                L.destroy = function() {
                                    G(J)
                                }
                                ;
                                return L
                            },
                            createStream: function(a, b) {
                                var e = D.pop();
                                e || (e = new u(a));
                                e.bind();
                                r(e, b, 35040, 0, 1, !1);
                                return e
                            },
                            destroyStream: function(a) {
                                D.push(a)
                            },
                            clear: function() {
                                a(e).forEach(G);
                                D.forEach(G)
                            },
                            getBuffer: function(a) {
                                return a && a._buffer instanceof u ? a._buffer : null
                            },
                            restore: function() {
                                a(e).forEach(function(a) {
                                    a.buffer = c.createBuffer();
                                    c.bindBuffer(a.type, a.buffer);
                                    c.bufferData(a.type, a.persistentData || a.byteLength, a.usage)
                                })
                            },
                            _initBuffer: r
                        }
                    }
                }
                , {
                    "./constants/arraytypes.json": 4,
                    "./constants/dtypes.json": 5,
                    "./constants/usage.json": 7,
                    "./util/check": 21,
                    "./util/flatten": 25,
                    "./util/is-ndarray": 27,
                    "./util/is-typed-array": 28,
                    "./util/pool": 30,
                    "./util/values": 33
                }],
                4: [function(c, r, A) {
                    r.exports = {
                        "[object Int8Array]": 5120,
                        "[object Int16Array]": 5122,
                        "[object Int32Array]": 5124,
                        "[object Uint8Array]": 5121,
                        "[object Uint8ClampedArray]": 5121,
                        "[object Uint16Array]": 5123,
                        "[object Uint32Array]": 5125,
                        "[object Float32Array]": 5126,
                        "[object Float64Array]": 5121,
                        "[object ArrayBuffer]": 5121
                    }
                }
                , {}],
                5: [function(c, r, A) {
                    r.exports = {
                        int8: 5120,
                        int16: 5122,
                        int32: 5124,
                        uint8: 5121,
                        uint16: 5123,
                        uint32: 5125,
                        "float": 5126,
                        float32: 5126
                    }
                }
                , {}],
                6: [function(c, r, A) {
                    r.exports = {
                        points: 0,
                        point: 0,
                        lines: 1,
                        line: 1,
                        "line loop": 2,
                        "line strip": 3,
                        triangles: 4,
                        triangle: 4,
                        "triangle strip": 5,
                        "triangle fan": 6
                    }
                }
                , {}],
                7: [function(c, r, A) {
                    r.exports = {
                        "static": 35044,
                        dynamic: 35048,
                        stream: 35040
                    }
                }
                , {}],
                8: [function(c, r, A) {
                    function f(a) {
                        return Array.isArray(a) || E(a) || v(a)
                    }
                    function m(a) {
                        return a.sort(function(a, b) {
                            return "viewport" === a ? -1 : "viewport" === b ? 1 : a < b ? -1 : 1
                        })
                    }
                    function k(a, b, e, g) {
                        this.thisDep = a;
                        this.contextDep = b;
                        this.propDep = e;
                        this.append = g
                    }
                    function l(a) {
                        return a && !(a.thisDep || a.contextDep || a.propDep)
                    }
                    function g(a) {
                        return new k(!1,!1,!1,a)
                    }
                    function h(a, b) {
                        var e = a.type;
                        return 0 === e ? (e = a.data.length,
                        new k(!0,1 <= e,2 <= e,b)) : 4 === e ? (e = a.data,
                        new k(e.thisDep,e.contextDep,e.propDep,b)) : new k(3 === e,2 === e,1 === e,b)
                    }
                    var a = c("./util/check")
                      , q = c("./util/codegen")
                      , B = c("./util/loop")
                      , E = c("./util/is-typed-array")
                      , v = c("./util/is-ndarray")
                      , n = c("./util/is-array-like")
                      , H = c("./dynamic")
                      , F = c("./constants/primitives.json")
                      , K = c("./constants/dtypes.json")
                      , O = ["x", "y", "z", "w"]
                      , z = "blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" ")
                      , u = {
                        0: 0,
                        1: 1,
                        zero: 0,
                        one: 1,
                        "src color": 768,
                        "one minus src color": 769,
                        "src alpha": 770,
                        "one minus src alpha": 771,
                        "dst color": 774,
                        "one minus dst color": 775,
                        "dst alpha": 772,
                        "one minus dst alpha": 773,
                        "constant color": 32769,
                        "one minus constant color": 32770,
                        "constant alpha": 32771,
                        "one minus constant alpha": 32772,
                        "src alpha saturate": 776
                    }
                      , Q = "constant color, constant alpha;one minus constant color, constant alpha;constant color, one minus constant alpha;one minus constant color, one minus constant alpha;constant alpha, constant color;constant alpha, one minus constant color;one minus constant alpha, constant color;one minus constant alpha, one minus constant color".split(";")
                      , Y = {
                        never: 512,
                        less: 513,
                        "<": 513,
                        equal: 514,
                        "=": 514,
                        "==": 514,
                        "===": 514,
                        lequal: 515,
                        "<=": 515,
                        greater: 516,
                        ">": 516,
                        notequal: 517,
                        "!=": 517,
                        "!==": 517,
                        gequal: 518,
                        ">=": 518,
                        always: 519
                    }
                      , G = {
                        0: 0,
                        zero: 0,
                        keep: 7680,
                        replace: 7681,
                        increment: 7682,
                        decrement: 7683,
                        "increment wrap": 34055,
                        "decrement wrap": 34056,
                        invert: 5386
                    }
                      , b = {
                        frag: 35632,
                        vert: 35633
                    }
                      , e = {
                        cw: 2304,
                        ccw: 2305
                    }
                      , D = new k(!1,!1,!1,function() {}
                    );
                    r.exports = function(c, v, E, r, L, W, J, A, aa, x, I, Da, da, pa, va) {
                        function ea(a) {
                            return a.replace(".", "_")
                        }
                        function T(a, d, b) {
                            var e = ea(a);
                            Ia.push(a);
                            M[e] = p[e] = !!b;
                            za[e] = d
                        }
                        function N(a, d, b) {
                            var e = ea(a);
                            Ia.push(a);
                            Array.isArray(b) ? (p[e] = b.slice(),
                            M[e] = b.slice()) : p[e] = M[e] = b;
                            Aa[e] = d
                        }
                        function Ba() {
                            var d = q()
                              , b = d.link
                              , e = d.global;
                            d.id = Qa++;
                            d.batchId = "0";
                            var g = b(Oa)
                              , f = d.shared = {
                                props: "a0"
                            };
                            Object.keys(Oa).forEach(function(a) {
                                f[a] = e.def(g, ".", a)
                            });
                            a.optional(function() {
                                d.CHECK = b(a);
                                d.commandStr = a.guessCommand();
                                d.command = b(d.commandStr);
                                d.assert = function(a, d, y) {
                                    a("if(!(", d, "))", this.CHECK, ".commandRaise(", b(y), ",", this.command, ");")
                                }
                                ;
                                Ja.invalidBlendCombinations = Q
                            });
                            var P = d.next = {}
                              , Ra = d.current = {};
                            Object.keys(Aa).forEach(function(a) {
                                Array.isArray(p[a]) && (P[a] = e.def(f.next, ".", a),
                                Ra[a] = e.def(f.current, ".", a))
                            });
                            var Sa = d.constants = {};
                            Object.keys(Ja).forEach(function(a) {
                                Sa[a] = e.def(JSON.stringify(Ja[a]))
                            });
                            d.invoke = function(a, y) {
                                switch (y.type) {
                                case 0:
                                    var e = ["this", f.context, f.props, d.batchId];
                                    return a.def(b(y.data), ".call(", e.slice(0, Math.max(y.data.length + 1, 4)), ")");
                                case 1:
                                    return a.def(f.props, y.data);
                                case 2:
                                    return a.def(f.context, y.data);
                                case 3:
                                    return a.def("this", y.data);
                                case 4:
                                    return y.data.append(d, a),
                                    y.data.ref
                                }
                            }
                            ;
                            d.attribCache = {};
                            var y = {};
                            d.scopeAttrib = function(a) {
                                a = v.id(a);
                                if (a in y)
                                    return y[a];
                                var d = x.scope[a];
                                d || (d = x.scope[a] = new ra);
                                return y[a] = b(d)
                            }
                            ;
                            return d
                        }
                        function sa(a) {
                            var d = a["static"];
                            a = a.dynamic;
                            var b;
                            if ("profile"in d) {
                                var e = !!d.profile;
                                b = g(function(a, d) {
                                    return e
                                });
                                b.enable = e
                            } else if ("profile"in a) {
                                var f = a.profile;
                                b = h(f, function(a, d) {
                                    return a.invoke(d, f)
                                })
                            }
                            return b
                        }
                        function wa(d, b) {
                            var e = d["static"]
                              , f = d.dynamic;
                            if ("framebuffer"in e) {
                                var p = e.framebuffer;
                                return p ? (p = A.getFramebuffer(p),
                                a.command(p, "invalid framebuffer object"),
                                g(function(a, d) {
                                    var y = a.link(p)
                                      , b = a.shared;
                                    d.set(b.framebuffer, ".next", y);
                                    b = b.context;
                                    d.set(b, ".framebufferWidth", y + ".width");
                                    d.set(b, ".framebufferHeight", y + ".height");
                                    return y
                                })) : g(function(a, d) {
                                    var y = a.shared;
                                    d.set(y.framebuffer, ".next", "null");
                                    y = y.context;
                                    d.set(y, ".framebufferWidth", y + ".drawingBufferWidth");
                                    d.set(y, ".framebufferHeight", y + ".drawingBufferHeight");
                                    return "null"
                                })
                            }
                            if ("framebuffer"in f) {
                                var P = f.framebuffer;
                                return h(P, function(d, b) {
                                    var y = d.invoke(b, P)
                                      , e = d.shared
                                      , U = e.framebuffer
                                      , C = b.def(U, ".getFramebuffer(", y, ")");
                                    a.optional(function() {
                                        d.assert(b, "!" + y + "||" + C, "invalid framebuffer object")
                                    });
                                    b.set(U, ".next", C);
                                    e = e.context;
                                    b.set(e, ".framebufferWidth", C + "?" + C + ".width:" + e + ".drawingBufferWidth");
                                    b.set(e, ".framebufferHeight", C + "?" + C + ".height:" + e + ".drawingBufferHeight");
                                    return C
                                })
                            }
                            return null
                        }
                        function fa(d, b, e) {
                            function f(d) {
                                if (d in g) {
                                    var y = g[d];
                                    a.commandType(y, "object", "invalid " + d, e.commandStr);
                                    var t = !0, U = y.x | 0, p = y.y | 0, c, w;
                                    "width"in y ? (c = y.width | 0,
                                    a.command(0 <= c, "invalid " + d, e.commandStr)) : t = !1;
                                    "height"in y ? (w = y.height | 0,
                                    a.command(0 <= w, "invalid " + d, e.commandStr)) : t = !1;
                                    return new k(!t && b && b.thisDep,!t && b && b.contextDep,!t && b && b.propDep,function(a, d) {
                                        var b = a.shared.context
                                          , e = c;
                                        "width"in y || (e = d.def(b, ".", "framebufferWidth", "-", U));
                                        var t = w;
                                        "height"in y || (t = d.def(b, ".", "framebufferHeight", "-", p));
                                        return [U, p, e, t]
                                    }
                                    )
                                }
                                if (d in P) {
                                    var n = P[d]
                                      , t = h(n, function(b, y) {
                                        var e = b.invoke(y, n);
                                        a.optional(function() {
                                            b.assert(y, e + "&&typeof " + e + '==="object"', "invalid " + d)
                                        });
                                        var U = b.shared.context
                                          , t = y.def(e, ".x|0")
                                          , C = y.def(e, ".y|0")
                                          , f = y.def('"width" in ', e, "?", e, ".width|0:", "(", U, ".", "framebufferWidth", "-", t, ")")
                                          , g = y.def('"height" in ', e, "?", e, ".height|0:", "(", U, ".", "framebufferHeight", "-", C, ")");
                                        a.optional(function() {
                                            b.assert(y, f + ">=0&&" + g + ">=0", "invalid " + d)
                                        });
                                        return [t, C, f, g]
                                    });
                                    b && (t.thisDep = t.thisDep || b.thisDep,
                                    t.contextDep = t.contextDep || b.contextDep,
                                    t.propDep = t.propDep || b.propDep);
                                    return t
                                }
                                return b ? new k(b.thisDep,b.contextDep,b.propDep,function(a, d) {
                                    var b = a.shared.context;
                                    return [0, 0, d.def(b, ".", "framebufferWidth"), d.def(b, ".", "framebufferHeight")]
                                }
                                ) : null
                            }
                            var g = d["static"]
                              , P = d.dynamic;
                            if (d = f("viewport")) {
                                var p = d;
                                d = new k(d.thisDep,d.contextDep,d.propDep,function(a, d) {
                                    var b = p.append(a, d)
                                      , e = a.shared.context;
                                    d.set(e, ".viewportWidth", b[2]);
                                    d.set(e, ".viewportHeight", b[3]);
                                    return b
                                }
                                )
                            }
                            return {
                                viewport: d,
                                scissor_box: f("scissor.box")
                            }
                        }
                        function ka(d) {
                            function e(d) {
                                if (d in f) {
                                    var y = v.id(f[d]);
                                    a.optional(function() {
                                        I.shader(b[d], y, a.guessCommand())
                                    });
                                    var t = g(function() {
                                        return y
                                    });
                                    t.id = y;
                                    return t
                                }
                                if (d in p) {
                                    var U = p[d];
                                    return h(U, function(y, e) {
                                        var t = y.invoke(e, U)
                                          , C = e.def(y.shared.strings, ".id(", t, ")");
                                        a.optional(function() {
                                            e(y.shared.shader, ".shader(", b[d], ",", C, ",", y.command, ");")
                                        });
                                        return C
                                    })
                                }
                                return null
                            }
                            var f = d["static"]
                              , p = d.dynamic
                              , c = e("frag")
                              , P = e("vert")
                              , w = null;
                            l(c) && l(P) ? (w = I.program(P.id, c.id),
                            d = g(function(a, d) {
                                return a.link(w)
                            })) : d = new k(c && c.thisDep || P && P.thisDep,c && c.contextDep || P && P.contextDep,c && c.propDep || P && P.propDep,function(d, b) {
                                var e = d.shared.shader, U;
                                U = c ? c.append(d, b) : b.def(e, ".", "frag");
                                var t;
                                t = P ? P.append(d, b) : b.def(e, ".", "vert");
                                var C = e + ".program(" + t + "," + U;
                                a.optional(function() {
                                    C += "," + d.command
                                });
                                return b.def(C + ")")
                            }
                            );
                            return {
                                frag: c,
                                vert: P,
                                progVar: d,
                                program: w
                            }
                        }
                        function la(d, b) {
                            function e(d, y) {
                                if (d in p) {
                                    var t = p[d] | 0;
                                    a.command(!y || 0 <= t, "invalid " + d, b.commandStr);
                                    return g(function(a, d) {
                                        y && (a.OFFSET = t);
                                        return t
                                    })
                                }
                                if (d in c) {
                                    var U = c[d];
                                    return h(U, function(b, e) {
                                        var t = b.invoke(e, U);
                                        y && (b.OFFSET = t,
                                        a.optional(function() {
                                            b.assert(e, t + ">=0", "invalid " + d)
                                        }));
                                        return t
                                    })
                                }
                                return y && P ? g(function(a, d) {
                                    a.OFFSET = "0";
                                    return 0
                                }) : null
                            }
                            var p = d["static"]
                              , c = d.dynamic
                              , P = function() {
                                if ("elements"in p) {
                                    var d = p.elements;
                                    f(d) ? d = W.getElements(W.create(d, !0)) : d && (d = W.getElements(d),
                                    a.command(d, "invalid elements", b.commandStr));
                                    var e = g(function(a, b) {
                                        if (d) {
                                            var e = a.link(d);
                                            return a.ELEMENTS = e
                                        }
                                        return a.ELEMENTS = null
                                    });
                                    e.value = d;
                                    return e
                                }
                                if ("elements"in c) {
                                    var t = c.elements;
                                    return h(t, function(d, b) {
                                        var e = d.shared
                                          , y = e.isBufferArgs
                                          , e = e.elements
                                          , C = d.invoke(b, t)
                                          , f = b.def("null")
                                          , y = b.def(y, "(", C, ")")
                                          , g = d.cond(y).then(f, "=", e, ".createStream(", C, ");")["else"](f, "=", e, ".getElements(", C, ");");
                                        a.optional(function() {
                                            d.assert(g["else"], "!" + C + "||" + f, "invalid elements")
                                        });
                                        b.entry(g);
                                        b.exit(d.cond(y).then(e, ".destroyStream(", f, ");"));
                                        return d.ELEMENTS = f
                                    })
                                }
                                return null
                            }()
                              , w = e("offset", !0);
                            return {
                                elements: P,
                                primitive: function() {
                                    if ("primitive"in p) {
                                        var d = p.primitive;
                                        a.commandParameter(d, F, "invalid primitve", b.commandStr);
                                        return g(function(a, b) {
                                            return F[d]
                                        })
                                    }
                                    if ("primitive"in c) {
                                        var e = c.primitive;
                                        return h(e, function(d, b) {
                                            var t = d.constants.primTypes
                                              , C = d.invoke(b, e);
                                            a.optional(function() {
                                                d.assert(b, C + " in " + t, "invalid primitive, must be one of " + Object.keys(F))
                                            });
                                            return b.def(t, "[", C, "]")
                                        })
                                    }
                                    return P ? l(P) ? P.value ? g(function(a, d) {
                                        return d.def(a.ELEMENTS, ".primType")
                                    }) : g(function() {
                                        return 4
                                    }) : new k(P.thisDep,P.contextDep,P.propDep,function(a, d) {
                                        var b = a.ELEMENTS;
                                        return d.def(b, "?", b, ".primType:", 4)
                                    }
                                    ) : null
                                }(),
                                count: function() {
                                    if ("count"in p) {
                                        var d = p.count | 0;
                                        a.command("number" === typeof d && 0 <= d, "invalid vertex count", b.commandStr);
                                        return g(function() {
                                            return d
                                        })
                                    }
                                    if ("count"in c) {
                                        var e = c.count;
                                        return h(e, function(d, b) {
                                            var t = d.invoke(b, e);
                                            a.optional(function() {
                                                d.assert(b, "typeof " + t + '==="number"&&' + t + ">=0&&" + t + "===(" + t + "|0)", "invalid vertex count")
                                            });
                                            return t
                                        })
                                    }
                                    if (P) {
                                        if (l(P)) {
                                            if (P)
                                                return w ? new k(w.thisDep,w.contextDep,w.propDep,function(d, b) {
                                                    var e = b.def(d.ELEMENTS, ".vertCount-", d.OFFSET);
                                                    a.optional(function() {
                                                        d.assert(b, e + ">=0", "invalid vertex offset/element buffer too small")
                                                    });
                                                    return e
                                                }
                                                ) : g(function(a, d) {
                                                    return d.def(a.ELEMENTS, ".vertCount")
                                                });
                                            var t = g(function() {
                                                return -1
                                            });
                                            a.optional(function() {
                                                t.MISSING = !0
                                            });
                                            return t
                                        }
                                        var U = new k(P.thisDep || w.thisDep,P.contextDep || w.contextDep,P.propDep || w.propDep,function(a, d) {
                                            var b = a.ELEMENTS;
                                            return a.OFFSET ? d.def(b, "?", b, ".vertCount-", a.OFFSET, ":-1") : d.def(b, "?", b, ".vertCount:-1")
                                        }
                                        );
                                        a.optional(function() {
                                            U.DYNAMIC = !0
                                        });
                                        return U
                                    }
                                    return null
                                }(),
                                instances: e("instances", !1),
                                offset: w
                            }
                        }
                        function ma(d, b) {
                            var f = d["static"]
                              , p = d.dynamic
                              , c = {};
                            Ia.forEach(function(d) {
                                function t(a, b) {
                                    if (d in f) {
                                        var e = a(f[d]);
                                        c[w] = g(function() {
                                            return e
                                        })
                                    } else if (d in p) {
                                        var C = p[d];
                                        c[w] = h(C, function(a, d) {
                                            return b(a, d, a.invoke(d, C))
                                        })
                                    }
                                }
                                var w = ea(d);
                                switch (d) {
                                case "cull.enable":
                                case "blend.enable":
                                case "dither":
                                case "stencil.enable":
                                case "depth.enable":
                                case "scissor.enable":
                                case "polygonOffset.enable":
                                case "sample.alpha":
                                case "sample.enable":
                                case "depth.mask":
                                    return t(function(e) {
                                        a.commandType(e, "boolean", d, b.commandStr);
                                        return e
                                    }, function(b, e, t) {
                                        a.optional(function() {
                                            b.assert(e, "typeof " + t + '==="boolean"', "invalid flag " + d, b.commandStr)
                                        });
                                        return t
                                    });
                                case "depth.func":
                                    return t(function(e) {
                                        a.commandParameter(e, Y, "invalid " + d, b.commandStr);
                                        return Y[e]
                                    }, function(b, e, t) {
                                        var C = b.constants.compareFuncs;
                                        a.optional(function() {
                                            b.assert(e, t + " in " + C, "invalid " + d + ", must be one of " + Object.keys(Y))
                                        });
                                        return e.def(C, "[", t, "]")
                                    });
                                case "depth.range":
                                    return t(function(d) {
                                        a.command(n(d) && 2 === d.length && "number" === typeof d[0] && "number" === typeof d[1] && d[0] <= d[1], "depth range is 2d array", b.commandStr);
                                        return d
                                    }, function(d, b, e) {
                                        a.optional(function() {
                                            d.assert(b, d.shared.isArrayLike + "(" + e + ")&&" + e + ".length===2&&typeof " + e + '[0]==="number"&&typeof ' + e + '[1]==="number"&&' + e + "[0]<=" + e + "[1]", "depth range must be a 2d array")
                                        });
                                        var t = b.def("+", e, "[0]")
                                          , C = b.def("+", e, "[1]");
                                        return [t, C]
                                    });
                                case "blend.func":
                                    return t(function(d) {
                                        a.commandType(d, "object", "blend.func", b.commandStr);
                                        var e = "srcRGB"in d ? d.srcRGB : d.src
                                          , t = "srcAlpha"in d ? d.srcAlpha : d.src
                                          , f = "dstRGB"in d ? d.dstRGB : d.dst;
                                        d = "dstAlpha"in d ? d.dstAlpha : d.dst;
                                        a.commandParameter(e, u, w + ".srcRGB", b.commandStr);
                                        a.commandParameter(t, u, w + ".srcAlpha", b.commandStr);
                                        a.commandParameter(f, u, w + ".dstRGB", b.commandStr);
                                        a.commandParameter(d, u, w + ".dstAlpha", b.commandStr);
                                        a.command(-1 === Q.indexOf(e + ", " + f), "unallowed blending combination (srcRGB, dstRGB) = (" + e + ", " + f + ")", b.commandStr);
                                        return [u[e], u[f], u[t], u[d]]
                                    }, function(b, e, t) {
                                        function C(g, p) {
                                            var w = e.def('"', g, p, '" in ', t, "?", t, ".", g, p, ":", t, ".", g);
                                            a.optional(function() {
                                                b.assert(e, w + " in " + f, "invalid " + d + "." + g + p + ", must be one of " + Object.keys(u))
                                            });
                                            return w
                                        }
                                        var f = b.constants.blendFuncs;
                                        a.optional(function() {
                                            b.assert(e, t + "&&typeof " + t + '==="object"', "invalid blend func, must be an object")
                                        });
                                        var g = C("src", "RGB")
                                          , p = C("dst", "RGB");
                                        a.optional(function() {
                                            b.assert(e, b.constants.invalidBlendCombinations + ".indexOf(" + g + '+", "+' + p + ") === -1 ", "unallowed blending combination for (srcRGB, dstRGB)")
                                        });
                                        var w = e.def(f, "[", g, "]")
                                          , c = e.def(f, "[", C("src", "Alpha"), "]")
                                          , h = e.def(f, "[", p, "]")
                                          , n = e.def(f, "[", C("dst", "Alpha"), "]");
                                        return [w, h, c, n]
                                    });
                                case "blend.equation":
                                    return t(function(e) {
                                        if ("string" === typeof e)
                                            return a.commandParameter(e, ga, "invalid " + d, b.commandStr),
                                            [ga[e], ga[e]];
                                        if ("object" === typeof e)
                                            return a.commandParameter(e.rgb, ga, d + ".rgb", b.commandStr),
                                            a.commandParameter(e.alpha, ga, d + ".alpha", b.commandStr),
                                            [ga[e.rgb], ga[e.alpha]];
                                        a.commandRaise("invalid blend.equation", b.commandStr)
                                    }, function(b, e, t) {
                                        var C = b.constants.blendEquations
                                          , f = e.def()
                                          , g = e.def()
                                          , p = b.cond("typeof ", t, '==="string"');
                                        a.optional(function() {
                                            function a(d, e, t) {
                                                b.assert(d, t + " in " + C, "invalid " + e + ", must be one of " + Object.keys(ga))
                                            }
                                            a(p.then, d, t);
                                            b.assert(p["else"], t + "&&typeof " + t + '==="object"', "invalid " + d);
                                            a(p["else"], d + ".rgb", t + ".rgb");
                                            a(p["else"], d + ".alpha", t + ".alpha")
                                        });
                                        p.then(f, "=", g, "=", C, "[", t, "];");
                                        p["else"](f, "=", C, "[", t, ".rgb];", g, "=", C, "[", t, ".alpha];");
                                        e(p);
                                        return [f, g]
                                    });
                                case "blend.color":
                                    return t(function(d) {
                                        a.command(n(d) && 4 === d.length, "blend.color must be a 4d array", b.commandStr);
                                        return B(4, function(a) {
                                            return +d[a]
                                        })
                                    }, function(d, b, e) {
                                        a.optional(function() {
                                            d.assert(b, d.shared.isArrayLike + "(" + e + ")&&" + e + ".length===4", "blend.color must be a 4d array")
                                        });
                                        return B(4, function(d) {
                                            return b.def("+", e, "[", d, "]")
                                        })
                                    });
                                case "stencil.mask":
                                    return t(function(d) {
                                        a.commandType(d, "number", w, b.commandStr);
                                        return d | 0
                                    }, function(d, b, e) {
                                        a.optional(function() {
                                            d.assert(b, "typeof " + e + '==="number"', "invalid stencil.mask")
                                        });
                                        return b.def(e, "|0")
                                    });
                                case "stencil.func":
                                    return t(function(e) {
                                        a.commandType(e, "object", w, b.commandStr);
                                        var t = e.cmp || "keep"
                                          , f = e.ref || 0;
                                        e = "mask"in e ? e.mask : -1;
                                        a.commandParameter(t, Y, d + ".cmp", b.commandStr);
                                        a.commandType(f, "number", d + ".ref", b.commandStr);
                                        a.commandType(e, "number", d + ".mask", b.commandStr);
                                        return [Y[t], f, e]
                                    }, function(d, b, e) {
                                        var t = d.constants.compareFuncs;
                                        a.optional(function() {
                                            function a() {
                                                d.assert(b, Array.prototype.join.call(arguments, ""), "invalid stencil.func")
                                            }
                                            a(e + "&&typeof ", e, '==="object"');
                                            a('!("cmp" in ', e, ")||(", e, ".cmp in ", t, ")")
                                        });
                                        var C = b.def('"cmp" in ', e, "?", t, "[", e, ".cmp]", ":", 7680)
                                          , f = b.def(e, ".ref|0")
                                          , p = b.def('"mask" in ', e, "?", e, ".mask|0:-1");
                                        return [C, f, p]
                                    });
                                case "stencil.opFront":
                                case "stencil.opBack":
                                    return t(function(e) {
                                        a.commandType(e, "object", w, b.commandStr);
                                        var t = e.fail || "keep"
                                          , f = e.zfail || "keep";
                                        e = e.zpass || "keep";
                                        a.commandParameter(t, G, d + ".fail", b.commandStr);
                                        a.commandParameter(f, G, d + ".zfail", b.commandStr);
                                        a.commandParameter(e, G, d + ".zpass", b.commandStr);
                                        return ["stencil.opBack" === d ? 1029 : 1028, G[t], G[f], G[e]]
                                    }, function(b, e, t) {
                                        function f(p) {
                                            a.optional(function() {
                                                b.assert(e, '!("' + p + '" in ' + t + ")||(" + t + "." + p + " in " + C + ")", "invalid " + d + "." + p + ", must be one of " + Object.keys(G))
                                            });
                                            return e.def('"', p, '" in ', t, "?", C, "[", t, ".", p, "]:", 7680)
                                        }
                                        var C = b.constants.stencilOps;
                                        a.optional(function() {
                                            b.assert(e, t + "&&typeof " + t + '==="object"', "invalid " + d)
                                        });
                                        return ["stencil.opBack" === d ? 1029 : 1028, f("fail"), f("zfail"), f("zpass")]
                                    });
                                case "polygonOffset.offset":
                                    return t(function(d) {
                                        a.commandType(d, "object", w, b.commandStr);
                                        var e = d.factor | 0;
                                        d = d.units | 0;
                                        a.commandType(e, "number", w + ".factor", b.commandStr);
                                        a.commandType(d, "number", w + ".units", b.commandStr);
                                        return [e, d]
                                    }, function(b, e, t) {
                                        a.optional(function() {
                                            b.assert(e, t + "&&typeof " + t + '==="object"', "invalid " + d)
                                        });
                                        var f = e.def(t, ".factor|0")
                                          , C = e.def(t, ".units|0");
                                        return [f, C]
                                    });
                                case "cull.face":
                                    return t(function(d) {
                                        var e = 0;
                                        "front" === d ? e = 1028 : "back" === d && (e = 1029);
                                        a.command(!!e, w, b.commandStr);
                                        return e
                                    }, function(d, b, e) {
                                        a.optional(function() {
                                            d.assert(b, e + '==="front"||' + e + '==="back"', "invalid cull.face")
                                        });
                                        return b.def(e, '==="front"?', 1028, ":", 1029)
                                    });
                                case "lineWidth":
                                    return t(function(d) {
                                        a.command("number" === typeof d && d >= r.lineWidthDims[0] && d <= r.lineWidthDims[1], "invalid line width, must positive number between " + r.lineWidthDims[0] + " and " + r.lineWidthDims[1], b.commandStr);
                                        return d
                                    }, function(d, b, e) {
                                        a.optional(function() {
                                            d.assert(b, "typeof " + e + '==="number"&&' + e + ">=" + r.lineWidthDims[0] + "&&" + e + "<=" + r.lineWidthDims[1], "invalid line width")
                                        });
                                        return e
                                    });
                                case "frontFace":
                                    return t(function(d) {
                                        a.commandParameter(d, e, w, b.commandStr);
                                        return e[d]
                                    }, function(d, b, e) {
                                        a.optional(function() {
                                            d.assert(b, e + '==="cw"||' + e + '==="ccw"', "invalid frontFace, must be one of cw,ccw")
                                        });
                                        return b.def(e + '==="cw"?2304:2305')
                                    });
                                case "colorMask":
                                    return t(function(d) {
                                        a.command(n(d) && 4 === d.length, "color.mask must be length 4 array", b.commandStr);
                                        return d.map(function(d) {
                                            return !!d
                                        })
                                    }, function(d, b, e) {
                                        a.optional(function() {
                                            d.assert(b, d.shared.isArrayLike + "(" + e + ")&&" + e + ".length===4", "invalid color.mask")
                                        });
                                        return B(4, function(d) {
                                            return "!!" + e + "[" + d + "]"
                                        })
                                    });
                                case "sample.coverage":
                                    return t(function(d) {
                                        a.command("object" === typeof d && d, w, b.commandStr);
                                        var e = "value"in d ? d.value : 1;
                                        d = !!d.invert;
                                        a.command("number" === typeof e && 0 <= e && 1 >= e, "sample.coverage.value must be a number between 0 and 1", b.commandStr);
                                        return [e, d]
                                    }, function(d, b, e) {
                                        a.optional(function() {
                                            d.assert(b, e + "&&typeof " + e + '==="object"', "invalid sample.coverage")
                                        });
                                        var t = b.def('"value" in ', e, "?+", e, ".value:1")
                                          , f = b.def("!!", e, ".invert");
                                        return [t, f]
                                    })
                                }
                            });
                            return c
                        }
                        function na(d, b) {
                            var e = d["static"]
                              , f = d.dynamic
                              , p = {};
                            Object.keys(e).forEach(function(d) {
                                var t = e[d], f;
                                if ("number" === typeof t || "boolean" === typeof t)
                                    f = g(function() {
                                        return t
                                    });
                                else if ("function" === typeof t) {
                                    var w = t._reglType;
                                    "texture2d" === w || "textureCube" === w ? f = g(function(d) {
                                        return d.link(t)
                                    }) : "framebuffer" === w || "framebufferCube" === w ? (a.command(0 < t.color.length, 'missing color attachment for framebuffer sent to uniform "' + d + '"', b.commandStr),
                                    f = g(function(d) {
                                        return d.link(t.color[0])
                                    })) : a.commandRaise('invalid data for uniform "' + d + '"', b.commandStr)
                                } else
                                    n(t) ? f = g(function(b) {
                                        return b.global.def("[", B(t.length, function(e) {
                                            a.command("number" === typeof t[e] || "boolean" === typeof t[e], "invalid uniform " + d, b.commandStr);
                                            return t[e]
                                        }), "]")
                                    }) : a.commandRaise('invalid or missing data for uniform "' + d + '"', b.commandStr);
                                f.value = t;
                                p[d] = f
                            });
                            Object.keys(f).forEach(function(d) {
                                var a = f[d];
                                p[d] = h(a, function(d, b) {
                                    return d.invoke(b, a)
                                })
                            });
                            return p
                        }
                        function qa(b, e) {
                            var p = b["static"]
                              , w = b.dynamic
                              , c = {};
                            Object.keys(p).forEach(function(b) {
                                var t = p[b]
                                  , w = v.id(b)
                                  , y = new ra;
                                if (f(t))
                                    y.state = 1,
                                    y.buffer = L.getBuffer(L.create(t, 34962, !1, !0)),
                                    y.type = 0;
                                else {
                                    var h = L.getBuffer(t);
                                    if (h)
                                        y.state = 1,
                                        y.buffer = h,
                                        y.type = 0;
                                    else if (a.command("object" === typeof t && t, "invalid data for attribute " + b, e.commandStr),
                                    t.constant) {
                                        var U = t.constant;
                                        y.buffer = "null";
                                        y.state = 2;
                                        "number" === typeof U ? y.x = U : (a.command(n(U) && 0 < U.length && 4 >= U.length, "invalid constant for attribute " + b, e.commandStr),
                                        O.forEach(function(d, a) {
                                            a < U.length && (y[d] = U[a])
                                        }))
                                    } else {
                                        h = f(t.buffer) ? L.getBuffer(L.create(t.buffer, 34962, !1, !0)) : L.getBuffer(t.buffer);
                                        a.command(!!h, 'missing buffer for attribute "' + b + '"', e.commandStr);
                                        var k = t.offset | 0;
                                        a.command(0 <= k, 'invalid offset for attribute "' + b + '"', e.commandStr);
                                        var l = t.stride | 0;
                                        a.command(0 <= l && 256 > l, 'invalid stride for attribute "' + b + '", must be integer betweeen [0, 255]', e.commandStr);
                                        var u = t.size | 0;
                                        a.command(!("size"in t) || 0 < u && 4 >= u, 'invalid size for attribute "' + b + '", must be 1,2,3,4', e.commandStr);
                                        var D = !!t.normalized
                                          , M = 0;
                                        "type"in t && (a.commandParameter(t.type, K, "invalid type for attribute " + b, e.commandStr),
                                        M = K[t.type]);
                                        var m = t.divisor | 0;
                                        "divisor"in t && (a.command(0 === m || d, 'cannot specify divisor for attribute "' + b + '", instancing not supported', e.commandStr),
                                        a.command(0 <= m, 'invalid divisor for attribute "' + b + '"', e.commandStr));
                                        a.optional(function() {
                                            var d = e.commandStr
                                              , f = "buffer offset divisor normalized type size stride".split(" ");
                                            Object.keys(t).forEach(function(e) {
                                                a.command(0 <= f.indexOf(e), 'unknown parameter "' + e + '" for attribute pointer "' + b + '" (valid parameters are ' + f + ")", d)
                                            })
                                        });
                                        y.buffer = h;
                                        y.state = 1;
                                        y.size = u;
                                        y.normalized = D;
                                        y.type = M || h.dtype;
                                        y.offset = k;
                                        y.stride = l;
                                        y.divisor = m
                                    }
                                }
                                c[b] = g(function(d, a) {
                                    var b = d.attribCache;
                                    if (w in b)
                                        return b[w];
                                    var e = {
                                        isStream: !1
                                    };
                                    Object.keys(y).forEach(function(d) {
                                        e[d] = y[d]
                                    });
                                    y.buffer && (e.buffer = d.link(y.buffer),
                                    e.type = e.type || e.buffer + ".dtype");
                                    return b[w] = e
                                })
                            });
                            Object.keys(w).forEach(function(d) {
                                var b = w[d];
                                c[d] = h(b, function(e, t) {
                                    function f(d) {
                                        t(c[d], "=", p, ".", d, "|0;")
                                    }
                                    var p = e.invoke(t, b)
                                      , C = e.shared
                                      , g = C.isBufferArgs
                                      , w = C.buffer;
                                    a.optional(function() {
                                        e.assert(t, p + "&&(typeof " + p + '==="object"||typeof ' + p + '==="function")&&(' + g + "(" + p + ")||" + w + ".getBuffer(" + p + ")||" + w + ".getBuffer(" + p + ".buffer)||" + g + "(" + p + '.buffer)||("constant" in ' + p + "&&(typeof " + p + '.constant==="number"||' + C.isArrayLike + "(" + p + ".constant))))", 'invalid dynamic attribute "' + d + '"')
                                    });
                                    var c = {
                                        isStream: t.def(!1)
                                    }
                                      , h = new ra;
                                    h.state = 1;
                                    Object.keys(h).forEach(function(d) {
                                        c[d] = t.def("" + h[d])
                                    });
                                    var n = c.buffer
                                      , k = c.type;
                                    t("if(", g, "(", p, ")){", c.isStream, "=true;", n, "=", w, ".createStream(", 34962, ",", p, ");", k, "=", n, ".dtype;", "}else{", n, "=", w, ".getBuffer(", p, ");", "if(", n, "){", k, "=", n, ".dtype;", '}else if("constant" in ', p, "){", c.state, "=", 2, ";", "if(typeof " + p + '.constant === "number"){', c[O[0]], "=", p, ".constant;", O.slice(1).map(function(d) {
                                        return c[d]
                                    }).join("="), "=0;", "}else{", O.map(function(d, a) {
                                        return c[d] + "=" + p + ".constant.length>=" + a + "?" + p + ".constant[" + a + "]:0;"
                                    }).join(""), "}}else{", "if(", g, "(", p, ".buffer)){", n, "=", w, ".createStream(", 34962, ",", p, ".buffer);", "}else{", n, "=", w, ".getBuffer(", p, ".buffer);", "}", k, '="type" in ', p, "?", C.glTypes, "[", p, ".type]:", n, ".dtype;", c.normalized, "=!!", p, ".normalized;");
                                    f("size");
                                    f("offset");
                                    f("stride");
                                    f("divisor");
                                    t("}}");
                                    t.exit("if(", c.isStream, "){", w, ".destroyStream(", n, ");", "}");
                                    return c
                                })
                            });
                            return c
                        }
                        function xa(d) {
                            var a = d["static"]
                              , b = d.dynamic
                              , e = {};
                            Object.keys(a).forEach(function(d) {
                                var b = a[d];
                                e[d] = g(function(d, a) {
                                    return "number" === typeof b || "boolean" === typeof b ? "" + b : d.link(b)
                                })
                            });
                            Object.keys(b).forEach(function(d) {
                                var a = b[d];
                                e[d] = h(a, function(d, b) {
                                    return d.invoke(b, a)
                                })
                            });
                            return e
                        }
                        function X(d, b, e, f, p) {
                            function g(d) {
                                var a = n[d];
                                a && (l[d] = a)
                            }
                            var w = d["static"]
                              , c = d.dynamic;
                            a.optional(function() {
                                function d(e) {
                                    Object.keys(e).forEach(function(d) {
                                        a.command(0 <= b.indexOf(d), 'unknown parameter "' + d + '"', p.commandStr)
                                    })
                                }
                                var b = "framebuffer vert frag elements primitive offset count instances profile".split(" ").concat(Ia);
                                d(w);
                                d(c)
                            });
                            var h = wa(d, p)
                              , n = fa(d, h, p)
                              , k = la(d, p)
                              , l = ma(d, p)
                              , u = ka(d, p);
                            g("viewport");
                            g(ea("scissor.box"));
                            var D = 0 < Object.keys(l).length
                              , h = {
                                framebuffer: h,
                                draw: k,
                                shader: u,
                                state: l,
                                dirty: D
                            };
                            h.profile = sa(d, p);
                            h.uniforms = na(e, p);
                            h.attributes = qa(b, p);
                            h.context = xa(f, p);
                            return h
                        }
                        function R(d, a, b) {
                            var e = d.shared.context
                              , f = d.scope();
                            Object.keys(b).forEach(function(p) {
                                a.save(e, "." + p);
                                f(e, ".", p, "=", b[p].append(d, a), ";")
                            });
                            a(f)
                        }
                        function ia(d, a, b, e) {
                            var p = d.shared, f = p.gl, g = p.framebuffer, c;
                            w && (c = a.def(p.extensions, ".webgl_draw_buffers"));
                            var h = d.constants
                              , p = h.drawBuffer
                              , h = h.backBuffer;
                            d = b ? b.append(d, a) : a.def(g, ".next");
                            e || a("if(", d, "!==", g, ".cur){");
                            a("if(", d, "){", f, ".bindFramebuffer(", 36160, ",", d, ".framebuffer);");
                            w && a(c, ".drawBuffersWEBGL(", p, "[", d, ".colorAttachments.length]);");
                            a("}else{", f, ".bindFramebuffer(", 36160, ",null);");
                            w && a(c, ".drawBuffersWEBGL(", h, ");");
                            a("}", g, ".cur=", d, ";");
                            e || a("}")
                        }
                        function oa(d, a, b) {
                            var e = d.shared
                              , f = e.gl
                              , g = d.current
                              , w = d.next
                              , c = e.current
                              , h = e.next
                              , n = d.cond(c, ".dirty");
                            Ia.forEach(function(a) {
                                a = ea(a);
                                if (!(a in b.state)) {
                                    var e, C;
                                    if (a in w) {
                                        e = w[a];
                                        C = g[a];
                                        var k = B(p[a].length, function(d) {
                                            return n.def(e, "[", d, "]")
                                        });
                                        n(d.cond(k.map(function(d, a) {
                                            return d + "!==" + C + "[" + a + "]"
                                        }).join("||")).then(f, ".", Aa[a], "(", k, ");", k.map(function(d, a) {
                                            return C + "[" + a + "]=" + d
                                        }).join(";"), ";"))
                                    } else
                                        e = n.def(h, ".", a),
                                        k = d.cond(e, "!==", c, ".", a),
                                        n(k),
                                        a in za ? k(d.cond(e).then(f, ".enable(", za[a], ");")["else"](f, ".disable(", za[a], ");"), c, ".", a, "=", e, ";") : k(f, ".", Aa[a], "(", e, ");", c, ".", a, "=", e, ";")
                                }
                            });
                            0 === Object.keys(b.state).length && n(c, ".dirty=false;");
                            a(n)
                        }
                        function S(d, a, b, e) {
                            var f = d.shared
                              , p = d.current
                              , g = f.current
                              , c = f.gl;
                            m(Object.keys(b)).forEach(function(f) {
                                var w = b[f];
                                if (!e || e(w)) {
                                    var h = w.append(d, a);
                                    if (za[f]) {
                                        var k = za[f];
                                        l(w) ? h ? a(c, ".enable(", k, ");") : a(c, ".disable(", k, ");") : a(d.cond(h).then(c, ".enable(", k, ");")["else"](c, ".disable(", k, ");"));
                                        a(g, ".", f, "=", h, ";")
                                    } else if (n(h)) {
                                        var u = p[f];
                                        a(c, ".", Aa[f], "(", h, ");", h.map(function(d, a) {
                                            return u + "[" + a + "]=" + d
                                        }).join(";"), ";")
                                    } else
                                        a(c, ".", Aa[f], "(", h, ");", g, ".", f, "=", h, ";")
                                }
                            })
                        }
                        function ca(a, b) {
                            d && (a.instancing = b.def(a.shared.extensions, ".angle_instanced_arrays"))
                        }
                        function ha(d, a, b, e, f) {
                            function p() {
                                return "undefined" === typeof performance ? "Date.now()" : "performance.now()"
                            }
                            function g(d) {
                                D = a.def();
                                d(D, "=", p(), ";");
                                "string" === typeof f ? d(n, ".count+=", f, ";") : d(n, ".count++;");
                                pa && (e ? (v = a.def(),
                                d(v, "=", u, ".getNumPendingQueries();")) : d(u, ".beginQuery(", n, ");"))
                            }
                            function c(d) {
                                d(n, ".cpuTime+=", p(), "-", D, ";");
                                pa && (e ? d(u, ".pushScopeStats(", v, ",", u, ".getNumPendingQueries(),", n, ");") : d(u, ".endQuery();"))
                            }
                            function w(d) {
                                var b = a.def(k, ".profile");
                                a(k, ".profile=", d, ";");
                                a.exit(k, ".profile=", b, ";")
                            }
                            var h = d.shared
                              , n = d.stats
                              , k = h.current
                              , u = h.timer;
                            b = b.profile;
                            var D, v;
                            if (b) {
                                if (l(b)) {
                                    b.enable ? (g(a),
                                    c(a.exit),
                                    w("true")) : w("false");
                                    return
                                }
                                b = b.append(d, a);
                                w(b)
                            } else
                                b = a.def(k, ".profile");
                            h = d.block();
                            g(h);
                            a("if(", b, "){", h, "}");
                            d = d.block();
                            c(d);
                            a.exit("if(", b, "){", d, "}")
                        }
                        function ya(b, e, f, p, g) {
                            function c(d) {
                                switch (d) {
                                case 35664:
                                case 35667:
                                case 35671:
                                    return 2;
                                case 35665:
                                case 35668:
                                case 35672:
                                    return 3;
                                case 35666:
                                case 35669:
                                case 35673:
                                    return 4;
                                default:
                                    return 1
                                }
                            }
                            function w(a, f, p) {
                                function g() {
                                    e("if(!", l, ".buffer){", n, ".enableVertexAttribArray(", k, ");}");
                                    var a = p.type, c;
                                    c = p.size ? e.def(p.size, "||", f) : f;
                                    e("if(", l, ".type!==", a, "||", l, ".size!==", c, "||", v.map(function(d) {
                                        return l + "." + d + "!==" + p[d]
                                    }).join("||"), "){", n, ".bindBuffer(", 34962, ",", u, ".buffer);", n, ".vertexAttribPointer(", [k, c, a, p.normalized, p.stride, p.offset], ");", l, ".type=", a, ";", l, ".size=", c, ";", v.map(function(d) {
                                        return l + "." + d + "=" + p[d] + ";"
                                    }).join(""), "}");
                                    d && (a = p.divisor,
                                    e("if(", l, ".divisor!==", a, "){", b.instancing, ".vertexAttribDivisorANGLE(", [k, a], ");", l, ".divisor=", a, ";}"))
                                }
                                function c() {
                                    e("if(", l, ".buffer){", n, ".disableVertexAttribArray(", k, ");", "}if(", O.map(function(d, a) {
                                        return l + "." + d + "!==" + D[a]
                                    }).join("||"), "){", n, ".vertexAttrib4f(", k, ",", D, ");", O.map(function(d, a) {
                                        return l + "." + d + "=" + D[a] + ";"
                                    }).join(""), "}")
                                }
                                var n = h.gl
                                  , k = e.def(a, ".location")
                                  , l = e.def(h.attributes, "[", k, "]");
                                a = p.state;
                                var u = p.buffer
                                  , D = [p.x, p.y, p.z, p.w]
                                  , v = ["buffer", "normalized", "offset", "stride"];
                                1 === a ? g() : 2 === a ? c() : (e("if(", a, "===", 1, "){"),
                                g(),
                                e("}else{"),
                                c(),
                                e("}"))
                            }
                            var h = b.shared;
                            p.forEach(function(d) {
                                var p = d.name, h = f.attributes[p], n;
                                if (h) {
                                    if (!g(h))
                                        return;
                                    n = h.append(b, e)
                                } else {
                                    if (!g(D))
                                        return;
                                    var k = b.scopeAttrib(p);
                                    a.optional(function() {
                                        b.assert(e, k + ".state", "missing attribute " + p)
                                    });
                                    n = {};
                                    Object.keys(new ra).forEach(function(d) {
                                        n[d] = e.def(k, ".", d)
                                    })
                                }
                                w(b.link(d), c(d.info.type), n)
                            })
                        }
                        function ja(d, b, e, p, f) {
                            for (var g = d.shared, c = g.gl, w, h = 0; h < p.length; ++h) {
                                var k = p[h], u = k.name, M = k.info.type, m = e.uniforms[u], k = d.link(k) + ".location", q;
                                if (m) {
                                    if (!f(m))
                                        continue;
                                    if (l(m)) {
                                        var x = m.value;
                                        a.command(null !== x && "undefined" !== typeof x, 'missing uniform "' + u + '"', d.commandStr);
                                        if (35678 === M || 35680 === M)
                                            a.command("function" === typeof x && (35678 === M && ("texture2d" === x._reglType || "framebuffer" === x._reglType) || 35680 === M && ("textureCube" === x._reglType || "framebufferCube" === x._reglType)), "invalid texture for uniform " + u, d.commandStr),
                                            m = d.link(x._texture || x.color[0]._texture),
                                            b(c, ".uniform1i(", k, ",", m + ".bind());"),
                                            b.exit(m, ".unbind();");
                                        else if (35674 === M || 35675 === M || 35676 === M) {
                                            a.optional(function() {
                                                a.command(n(x), "invalid matrix for uniform " + u, d.commandStr);
                                                a.command(35674 === M && 4 === x.length || 35675 === M && 9 === x.length || 35676 === M && 16 === x.length, "invalid length for matrix uniform " + u, d.commandStr)
                                            });
                                            var m = d.global.def("new Float32Array([" + Array.prototype.slice.call(x) + "])")
                                              , z = 2;
                                            35675 === M ? z = 3 : 35676 === M && (z = 4);
                                            b(c, ".uniformMatrix", z, "fv(", k, ",false,", m, ");")
                                        } else {
                                            switch (M) {
                                            case 5126:
                                                a.commandType(x, "number", "uniform " + u, d.commandStr);
                                                w = "1f";
                                                break;
                                            case 35664:
                                                a.command(n(x) && 2 === x.length, "uniform " + u, d.commandStr);
                                                w = "2f";
                                                break;
                                            case 35665:
                                                a.command(n(x) && 3 === x.length, "uniform " + u, d.commandStr);
                                                w = "3f";
                                                break;
                                            case 35666:
                                                a.command(n(x) && 4 === x.length, "uniform " + u, d.commandStr);
                                                w = "4f";
                                                break;
                                            case 35670:
                                                a.commandType(x, "boolean", "uniform " + u, d.commandStr);
                                                w = "1i";
                                                break;
                                            case 5124:
                                                a.commandType(x, "number", "uniform " + u, d.commandStr);
                                                w = "1i";
                                                break;
                                            case 35671:
                                                a.command(n(x) && 2 === x.length, "uniform " + u, d.commandStr);
                                                w = "2i";
                                                break;
                                            case 35667:
                                                a.command(n(x) && 2 === x.length, "uniform " + u, d.commandStr);
                                                w = "2i";
                                                break;
                                            case 35672:
                                                a.command(n(x) && 3 === x.length, "uniform " + u, d.commandStr);
                                                w = "3i";
                                                break;
                                            case 35668:
                                                a.command(n(x) && 3 === x.length, "uniform " + u, d.commandStr);
                                                w = "3i";
                                                break;
                                            case 35673:
                                                a.command(n(x) && 4 === x.length, "uniform " + u, d.commandStr);
                                                w = "4i";
                                                break;
                                            case 35669:
                                                a.command(n(x) && 4 === x.length, "uniform " + u, d.commandStr),
                                                w = "4i"
                                            }
                                            b(c, ".uniform", w, "(", k, ",", n(x) ? Array.prototype.slice.call(x) : x, ");")
                                        }
                                        continue
                                    } else
                                        q = m.append(d, b)
                                } else {
                                    if (!f(D))
                                        continue;
                                    q = b.def(g.uniforms, "[", v.id(u), "]")
                                }
                                35678 === M ? b("if(", q, "&&", q, '._reglType==="framebuffer"){', q, "=", q, ".color[0];", "}") : 35680 === M && b("if(", q, "&&", q, '._reglType==="framebufferCube"){', q, "=", q, ".color[0];", "}");
                                a.optional(function() {
                                    function a(e, p) {
                                        d.assert(b, e, 'bad data or missing for uniform "' + u + '".  ' + p)
                                    }
                                    function e(d) {
                                        a("typeof " + q + '==="' + d + '"', "invalid type, expected " + d)
                                    }
                                    function p(b, e) {
                                        a(g.isArrayLike + "(" + q + ")&&" + q + ".length===" + b, "invalid vector, should have length " + b, d.commandStr)
                                    }
                                    function f(b) {
                                        a("typeof " + q + '==="function"&&' + q + '._reglType==="texture' + (3553 === b ? "2d" : "Cube") + '"', "invalid texture type", d.commandStr)
                                    }
                                    switch (M) {
                                    case 5124:
                                        e("number");
                                        break;
                                    case 35667:
                                        p(2, "number");
                                        break;
                                    case 35668:
                                        p(3, "number");
                                        break;
                                    case 35669:
                                        p(4, "number");
                                        break;
                                    case 5126:
                                        e("number");
                                        break;
                                    case 35664:
                                        p(2, "number");
                                        break;
                                    case 35665:
                                        p(3, "number");
                                        break;
                                    case 35666:
                                        p(4, "number");
                                        break;
                                    case 35670:
                                        e("boolean");
                                        break;
                                    case 35671:
                                        p(2, "boolean");
                                        break;
                                    case 35672:
                                        p(3, "boolean");
                                        break;
                                    case 35673:
                                        p(4, "boolean");
                                        break;
                                    case 35674:
                                        p(4, "number");
                                        break;
                                    case 35675:
                                        p(9, "number");
                                        break;
                                    case 35676:
                                        p(16, "number");
                                        break;
                                    case 35678:
                                        f(3553);
                                        break;
                                    case 35680:
                                        f(34067)
                                    }
                                });
                                m = 1;
                                switch (M) {
                                case 35678:
                                case 35680:
                                    m = b.def(q, "._texture");
                                    b(c, ".uniform1i(", k, ",", m, ".bind());");
                                    b.exit(m, ".unbind();");
                                    continue;
                                case 5124:
                                case 35670:
                                    w = "1i";
                                    break;
                                case 35667:
                                case 35671:
                                    w = "2i";
                                    m = 2;
                                    break;
                                case 35668:
                                case 35672:
                                    w = "3i";
                                    m = 3;
                                    break;
                                case 35669:
                                case 35673:
                                    w = "4i";
                                    m = 4;
                                    break;
                                case 5126:
                                    w = "1f";
                                    break;
                                case 35664:
                                    w = "2f";
                                    m = 2;
                                    break;
                                case 35665:
                                    w = "3f";
                                    m = 3;
                                    break;
                                case 35666:
                                    w = "4f";
                                    m = 4;
                                    break;
                                case 35674:
                                    w = "Matrix2fv";
                                    break;
                                case 35675:
                                    w = "Matrix3fv";
                                    break;
                                case 35676:
                                    w = "Matrix4fv"
                                }
                                b(c, ".uniform", w, "(", k, ",");
                                if ("M" === w.charAt(0)) {
                                    var k = Math.pow(M - 35674 + 2, 2)
                                      , da = d.global.def("new Float32Array(", k, ")");
                                    b("false,(Array.isArray(", q, ")||", q, " instanceof Float32Array)?", q, ":(", B(k, function(d) {
                                        return da + "[" + d + "]=" + q + "[" + d + "]"
                                    }), ",", da, ")")
                                } else
                                    1 < m ? b(B(m, function(d) {
                                        return q + "[" + d + "]"
                                    })) : b(q);
                                b(");")
                            }
                        }
                        function ta(b, e, p, f) {
                            function w(d) {
                                var a = u[d];
                                return a ? a.contextDep && f.contextDynamic || a.propDep ? a.append(b, p) : a.append(b, e) : e.def(n, ".", d)
                            }
                            function g() {
                                function d() {
                                    p(v, ".drawElementsInstancedANGLE(", [m, M, z, D + "<<((" + z + "-5121)>>1)", q], ");")
                                }
                                function a() {
                                    p(v, ".drawArraysInstancedANGLE(", [m, D, M, q], ");")
                                }
                                x ? da ? d() : (p("if(", x, "){"),
                                d(),
                                p("}else{"),
                                a(),
                                p("}")) : a()
                            }
                            function c() {
                                function d() {
                                    p(k + ".drawElements(" + [m, M, z, D + "<<((" + z + "-5121)>>1)"] + ");")
                                }
                                function a() {
                                    p(k + ".drawArrays(" + [m, D, M] + ");")
                                }
                                x ? da ? d() : (p("if(", x, "){"),
                                d(),
                                p("}else{"),
                                a(),
                                p("}")) : a()
                            }
                            var h = b.shared
                              , k = h.gl
                              , n = h.draw
                              , u = f.draw
                              , x = function() {
                                var d = u.elements
                                  , a = e;
                                if (d) {
                                    if (d.contextDep && f.contextDynamic || d.propDep)
                                        a = p;
                                    d = d.append(b, a)
                                } else
                                    d = a.def(n, ".", "elements");
                                d && a("if(" + d + ")" + k + ".bindBuffer(34963," + d + ".buffer.buffer);");
                                return d
                            }()
                              , m = w("primitive")
                              , D = w("offset")
                              , M = function() {
                                var d = u.count, w, g = e;
                                if (d) {
                                    if (d.contextDep && f.contextDynamic || d.propDep)
                                        g = p;
                                    w = d.append(b, g);
                                    a.optional(function() {
                                        d.MISSING && b.assert(e, "false", "missing vertex count");
                                        d.DYNAMIC && b.assert(g, w + ">=0", "missing vertex count")
                                    })
                                } else
                                    w = g.def(n, ".", "count"),
                                    a.optional(function() {
                                        b.assert(g, w + ">=0", "missing vertex count")
                                    });
                                return w
                            }();
                            if ("number" === typeof M) {
                                if (0 === M)
                                    return
                            } else
                                p("if(", M, "){"),
                                p.exit("}");
                            var q, v;
                            d && (q = w("instances"),
                            v = b.instancing);
                            var z = x + ".type"
                              , da = u.elements && l(u.elements);
                            d && ("number" !== typeof q || 0 <= q) ? "string" === typeof q ? (p("if(", q, ">0){"),
                            g(),
                            p("}else if(", q, "<0){"),
                            c(),
                            p("}")) : g() : c()
                        }
                        function Ea(b, e, p, f, w) {
                            var g = Ba();
                            w = g.proc("body", w);
                            a.optional(function() {
                                g.commandStr = e.commandStr;
                                g.command = g.link(e.commandStr)
                            });
                            d && (g.instancing = w.def(g.shared.extensions, ".angle_instanced_arrays"));
                            b(g, w, p, f);
                            return g.compile().body
                        }
                        function Ha(d, a, b, e) {
                            ca(d, a);
                            ya(d, a, b, e.attributes, function() {
                                return !0
                            });
                            ja(d, a, b, e.uniforms, function() {
                                return !0
                            });
                            ta(d, a, a, b)
                        }
                        function Ka(d, a) {
                            var b = d.proc("draw", 1);
                            ca(d, b);
                            R(d, b, a.context);
                            ia(d, b, a.framebuffer);
                            oa(d, b, a);
                            S(d, b, a.state);
                            ha(d, b, a, !1, !0);
                            var e = a.shader.progVar.append(d, b);
                            b(d.shared.gl, ".useProgram(", e, ".program);");
                            if (a.shader.program)
                                Ha(d, b, a, a.shader.program);
                            else {
                                var p = d.global.def("{}")
                                  , f = b.def(e, ".id")
                                  , g = b.def(p, "[", f, "]");
                                b(d.cond(g).then(g, ".call(this,a0);")["else"](g, "=", p, "[", f, "]=", d.link(function(b) {
                                    return Ea(Ha, d, a, b, 1)
                                }), "(", e, ");", g, ".call(this,a0);"))
                            }
                            0 < Object.keys(a.state).length && b(d.shared.current, ".dirty=true;")
                        }
                        function Fa(d, a, b, e) {
                            function p() {
                                return !0
                            }
                            d.batchId = "a1";
                            ca(d, a);
                            ya(d, a, b, e.attributes, p);
                            ja(d, a, b, e.uniforms, p);
                            ta(d, a, a, b)
                        }
                        function La(d, a, b, e) {
                            function p(d) {
                                return d.contextDep && g || d.propDep
                            }
                            function f(d) {
                                return !p(d)
                            }
                            ca(d, a);
                            var g = b.contextDep
                              , w = a.def()
                              , c = a.def();
                            d.shared.props = c;
                            d.batchId = w;
                            var h = d.scope()
                              , k = d.scope();
                            a(h.entry, "for(", w, "=0;", w, "<", "a1", ";++", w, "){", c, "=", "a0", "[", w, "];", k, "}", h.exit);
                            b.needsContext && R(d, k, b.context);
                            b.needsFramebuffer && ia(d, k, b.framebuffer);
                            S(d, k, b.state, p);
                            b.profile && p(b.profile) && ha(d, k, b, !1, !0);
                            e ? (ya(d, h, b, e.attributes, f),
                            ya(d, k, b, e.attributes, p),
                            ja(d, h, b, e.uniforms, f),
                            ja(d, k, b, e.uniforms, p),
                            ta(d, h, k, b)) : (a = d.global.def("{}"),
                            e = b.shader.progVar.append(d, k),
                            c = k.def(e, ".id"),
                            h = k.def(a, "[", c, "]"),
                            k(d.shared.gl, ".useProgram(", e, ".program);", "if(!", h, "){", h, "=", a, "[", c, "]=", d.link(function(a) {
                                return Ea(Fa, d, b, a, 2)
                            }), "(", e, ");}", h, ".call(this,a0[", w, "],", w, ");"))
                        }
                        function Ma(d, a) {
                            function b(d) {
                                return d.contextDep && p || d.propDep
                            }
                            var e = d.proc("batch", 2);
                            d.batchId = "0";
                            ca(d, e);
                            var p = !1
                              , f = !0;
                            Object.keys(a.context).forEach(function(d) {
                                p = p || a.context[d].propDep
                            });
                            p || (R(d, e, a.context),
                            f = !1);
                            var w = a.framebuffer
                              , g = !1;
                            w ? (w.propDep ? p = g = !0 : w.contextDep && p && (g = !0),
                            g || ia(d, e, w)) : ia(d, e, null);
                            a.state.viewport && a.state.viewport.propDep && (p = !0);
                            oa(d, e, a);
                            S(d, e, a.state, function(d) {
                                return !b(d)
                            });
                            a.profile && b(a.profile) || ha(d, e, a, !1, "a1");
                            a.contextDep = p;
                            a.needsContext = f;
                            a.needsFramebuffer = g;
                            f = a.shader.progVar;
                            if (f.contextDep && p || f.propDep)
                                La(d, e, a, null);
                            else if (f = f.append(d, e),
                            e(d.shared.gl, ".useProgram(", f, ".program);"),
                            a.shader.program)
                                La(d, e, a, a.shader.program);
                            else {
                                var w = d.global.def("{}")
                                  , g = e.def(f, ".id")
                                  , c = e.def(w, "[", g, "]");
                                e(d.cond(c).then(c, ".call(this,a0,a1);")["else"](c, "=", w, "[", g, "]=", d.link(function(b) {
                                    return Ea(La, d, a, b, 2)
                                }), "(", f, ");", c, ".call(this,a0,a1);"))
                            }
                            0 < Object.keys(a.state).length && e(d.shared.current, ".dirty=true;")
                        }
                        function Na(d, a) {
                            function b(f) {
                                var w = a.shader[f];
                                w && e.set(p.shader, "." + f, w.append(d, e))
                            }
                            var e = d.proc("scope", 3);
                            d.batchId = "a2";
                            var p = d.shared
                              , f = p.current;
                            R(d, e, a.context);
                            a.framebuffer && a.framebuffer.append(d, e);
                            m(Object.keys(a.state)).forEach(function(b) {
                                var f = a.state[b].append(d, e);
                                n(f) ? f.forEach(function(a, p) {
                                    e.set(d.next[b], "[" + p + "]", a)
                                }) : e.set(p.next, "." + b, f)
                            });
                            ha(d, e, a, !0, !0);
                            ["elements", "offset", "count", "instances", "primitive"].forEach(function(b) {
                                var f = a.draw[b];
                                f && e.set(p.draw, "." + b, "" + f.append(d, e))
                            });
                            Object.keys(a.uniforms).forEach(function(b) {
                                e.set(p.uniforms, "[" + v.id(b) + "]", a.uniforms[b].append(d, e))
                            });
                            Object.keys(a.attributes).forEach(function(b) {
                                var p = a.attributes[b].append(d, e)
                                  , f = d.scopeAttrib(b);
                                Object.keys(new ra).forEach(function(d) {
                                    e.set(f, "." + d, p[d])
                                })
                            });
                            b("vert");
                            b("frag");
                            0 < Object.keys(a.state).length && (e(f, ".dirty=true;"),
                            e.exit(f, ".dirty=true;"));
                            e("a1(", d.shared.context, ",a0,", d.batchId, ");")
                        }
                        function Pa(d) {
                            if ("object" === typeof d && !n(d)) {
                                for (var a = Object.keys(d), b = 0; b < a.length; ++b)
                                    if (H.isDynamic(d[a[b]]))
                                        return !0;
                                return !1
                            }
                        }
                        function ua(d, a, b) {
                            function e(d, a) {
                                w.forEach(function(b) {
                                    var e = p[b];
                                    H.isDynamic(e) && (e = d.invoke(a, e),
                                    a(n, ".", b, "=", e, ";"))
                                })
                            }
                            var p = a["static"][b];
                            if (p && Pa(p)) {
                                var f = d.global
                                  , w = Object.keys(p)
                                  , g = !1
                                  , c = !1
                                  , k = !1
                                  , n = d.global.def("{}");
                                w.forEach(function(a) {
                                    var b = p[a];
                                    if (H.isDynamic(b))
                                        "function" === typeof b && (b = p[a] = H.unbox(b)),
                                        a = h(b, null),
                                        g = g || a.thisDep,
                                        k = k || a.propDep,
                                        c = c || a.contextDep;
                                    else {
                                        f(n, ".", a, "=");
                                        switch (typeof b) {
                                        case "number":
                                            f(b);
                                            break;
                                        case "string":
                                            f('"', b, '"');
                                            break;
                                        case "object":
                                            Array.isArray(b) && f("[", b.join(), "]");
                                            break;
                                        default:
                                            f(d.link(b))
                                        }
                                        f(";")
                                    }
                                });
                                a.dynamic[b] = new H.DynamicVariable(4,{
                                    thisDep: g,
                                    contextDep: c,
                                    propDep: k,
                                    ref: n,
                                    append: e
                                });
                                delete a["static"][b]
                            }
                        }
                        var ra = x.Record
                          , ga = {
                            add: 32774,
                            subtract: 32778,
                            "reverse subtract": 32779
                        };
                        E.ext_blend_minmax && (ga.min = 32775,
                        ga.max = 32776);
                        var d = E.angle_instanced_arrays
                          , w = E.webgl_draw_buffers
                          , p = {
                            dirty: !0,
                            profile: va.profile
                        }
                          , M = {}
                          , Ia = []
                          , za = {}
                          , Aa = {};
                        T("dither", 3024);
                        T("blend.enable", 3042);
                        N("blend.color", "blendColor", [0, 0, 0, 0]);
                        N("blend.equation", "blendEquationSeparate", [32774, 32774]);
                        N("blend.func", "blendFuncSeparate", [1, 0, 1, 0]);
                        T("depth.enable", 2929, !0);
                        N("depth.func", "depthFunc", 513);
                        N("depth.range", "depthRange", [0, 1]);
                        N("depth.mask", "depthMask", !0);
                        N("colorMask", "colorMask", [!0, !0, !0, !0]);
                        T("cull.enable", 2884);
                        N("cull.face", "cullFace", 1029);
                        N("frontFace", "frontFace", 2305);
                        N("lineWidth", "lineWidth", 1);
                        T("polygonOffset.enable", 32823);
                        N("polygonOffset.offset", "polygonOffset", [0, 0]);
                        T("sample.alpha", 32926);
                        T("sample.enable", 32928);
                        N("sample.coverage", "sampleCoverage", [1, !1]);
                        T("stencil.enable", 2960);
                        N("stencil.mask", "stencilMask", -1);
                        N("stencil.func", "stencilFunc", [519, 0, -1]);
                        N("stencil.opFront", "stencilOpSeparate", [1028, 7680, 7680, 7680]);
                        N("stencil.opBack", "stencilOpSeparate", [1029, 7680, 7680, 7680]);
                        T("scissor.enable", 3089);
                        N("scissor.box", "scissor", [0, 0, c.drawingBufferWidth, c.drawingBufferHeight]);
                        N("viewport", "viewport", [0, 0, c.drawingBufferWidth, c.drawingBufferHeight]);
                        var Oa = {
                            gl: c,
                            context: da,
                            strings: v,
                            next: M,
                            current: p,
                            draw: Da,
                            elements: W,
                            buffer: L,
                            shader: I,
                            attributes: x.state,
                            uniforms: aa,
                            framebuffer: A,
                            extensions: E,
                            timer: pa,
                            isBufferArgs: f
                        }
                          , Ja = {
                            primTypes: F,
                            compareFuncs: Y,
                            blendFuncs: u,
                            blendEquations: ga,
                            stencilOps: G,
                            glTypes: K,
                            orientationType: e
                        };
                        a.optional(function() {
                            Oa.isArrayLike = n
                        });
                        w && (Ja.backBuffer = [1029],
                        Ja.drawBuffer = B(r.maxDrawbuffers, function(d) {
                            return 0 === d ? [0] : B(d, function(d) {
                                return 36064 + d
                            })
                        }));
                        var Qa = 0;
                        return {
                            next: M,
                            current: p,
                            procs: function() {
                                var d = Ba()
                                  , a = d.proc("poll")
                                  , b = d.proc("refresh")
                                  , e = d.block();
                                a(e);
                                b(e);
                                var f = d.shared
                                  , w = f.gl
                                  , g = f.next
                                  , h = f.current;
                                e(h, ".dirty=false;");
                                ia(d, a);
                                ia(d, b, null, !0);
                                var k = c.getExtension("angle_instanced_arrays"), u;
                                k && (u = d.link(k));
                                for (var l = 0; l < r.maxAttributes; ++l) {
                                    var x = b.def(f.attributes, "[", l, "]")
                                      , m = d.cond(x, ".buffer");
                                    m.then(w, ".enableVertexAttribArray(", l, ");", w, ".bindBuffer(", 34962, ",", x, ".buffer.buffer);", w, ".vertexAttribPointer(", l, ",", x, ".size,", x, ".type,", x, ".normalized,", x, ".stride,", x, ".offset);")["else"](w, ".disableVertexAttribArray(", l, ");", w, ".vertexAttrib4f(", l, ",", x, ".x,", x, ".y,", x, ".z,", x, ".w);", x, ".buffer=null;");
                                    b(m);
                                    k && b(u, ".vertexAttribDivisorANGLE(", l, ",", x, ".divisor);")
                                }
                                Object.keys(za).forEach(function(p) {
                                    var f = za[p]
                                      , c = e.def(g, ".", p)
                                      , k = d.block();
                                    k("if(", c, "){", w, ".enable(", f, ")}else{", w, ".disable(", f, ")}", h, ".", p, "=", c, ";");
                                    b(k);
                                    a("if(", c, "!==", h, ".", p, "){", k, "}")
                                });
                                Object.keys(Aa).forEach(function(f) {
                                    var c = Aa[f], k = p[f], u, l, x = d.block();
                                    x(w, ".", c, "(");
                                    n(k) ? (c = k.length,
                                    u = d.global.def(g, ".", f),
                                    l = d.global.def(h, ".", f),
                                    x(B(c, function(d) {
                                        return u + "[" + d + "]"
                                    }), ");", B(c, function(d) {
                                        return l + "[" + d + "]=" + u + "[" + d + "];"
                                    }).join("")),
                                    a("if(", B(c, function(d) {
                                        return u + "[" + d + "]!==" + l + "[" + d + "]"
                                    }).join("||"), "){", x, "}")) : (u = e.def(g, ".", f),
                                    l = e.def(h, ".", f),
                                    x(u, ");", h, ".", f, "=", u, ";"),
                                    a("if(", u, "!==", l, "){", x, "}"));
                                    b(x)
                                });
                                return d.compile()
                            }(),
                            compile: function(d, a, b, e, p) {
                                var f = Ba();
                                f.stats = f.link(p);
                                Object.keys(a["static"]).forEach(function(d) {
                                    ua(f, a, d)
                                });
                                z.forEach(function(a) {
                                    ua(f, d, a)
                                });
                                b = X(d, a, b, e, f);
                                Ka(f, b);
                                Na(f, b);
                                Ma(f, b);
                                return f.compile()
                            }
                        }
                    }
                }
                , {
                    "./constants/dtypes.json": 5,
                    "./constants/primitives.json": 6,
                    "./dynamic": 9,
                    "./util/check": 21,
                    "./util/codegen": 23,
                    "./util/is-array-like": 26,
                    "./util/is-ndarray": 27,
                    "./util/is-typed-array": 28,
                    "./util/loop": 29
                }],
                9: [function(c, r, A) {
                    function f(f, c) {
                        this.id = l++;
                        this.type = f;
                        this.data = c
                    }
                    function m(f) {
                        if (0 === f.length)
                            return [];
                        var c = f.charAt(0)
                          , a = f.charAt(f.length - 1);
                        if (1 < f.length && c === a && ('"' === c || "'" === c))
                            return ['"' + f.substr(1, f.length - 2).replace(/\\/g, "\\\\").replace(/"/g, '\\"') + '"'];
                        if (c = /\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(f))
                            return m(f.substr(0, c.index)).concat(m(c[1])).concat(m(f.substr(c.index + c[0].length)));
                        c = f.split(".");
                        if (1 === c.length)
                            return ['"' + f.replace(/\\/g, "\\\\").replace(/"/g, '\\"') + '"'];
                        f = [];
                        for (a = 0; a < c.length; ++a)
                            f = f.concat(m(c[a]));
                        return f
                    }
                    function k(f) {
                        return "[" + m(f).join("][") + "]"
                    }
                    var l = 0;
                    r.exports = {
                        DynamicVariable: f,
                        define: function(c, h) {
                            return new f(c,k(h + ""))
                        },
                        isDynamic: function(c) {
                            return "function" === typeof c && !c._reglType || c instanceof f
                        },
                        unbox: function(c, k) {
                            return "function" === typeof c ? new f(0,c) : c
                        },
                        accessor: k
                    }
                }
                , {}],
                10: [function(c, r, A) {
                    var f = c("./util/check")
                      , m = c("./util/is-typed-array")
                      , k = c("./util/is-ndarray")
                      , l = c("./util/values")
                      , g = c("./constants/primitives.json")
                      , h = c("./constants/usage.json");
                    r.exports = function(a, c, B, r) {
                        function v(a) {
                            this.id = K++;
                            F[this.id] = this;
                            this.buffer = a;
                            this.primType = 4;
                            this.type = this.vertCount = 0
                        }
                        function n(g, h, n, l, b, e, D) {
                            g.buffer.bind();
                            if (h) {
                                var v = D;
                                D || m(h) && (!k(h) || m(h.data)) || (v = c.oes_element_index_uint ? 5125 : 5123);
                                B._initBuffer(g.buffer, h, n, v, 3)
                            } else
                                a.bufferData(34963, e, n),
                                g.buffer.dtype = v || 5121,
                                g.buffer.usage = n,
                                g.buffer.dimension = 3,
                                g.buffer.byteLength = e;
                            v = D;
                            if (!D) {
                                switch (g.buffer.dtype) {
                                case 5121:
                                case 5120:
                                    v = 5121;
                                    break;
                                case 5123:
                                case 5122:
                                    v = 5123;
                                    break;
                                case 5125:
                                case 5124:
                                    v = 5125;
                                    break;
                                default:
                                    f.raise("unsupported type for element array")
                                }
                                g.buffer.dtype = v
                            }
                            g.type = v;
                            f(5125 !== v || !!c.oes_element_index_uint, "32 bit element buffers not supported, enable oes_element_index_uint first");
                            h = b;
                            0 > h && (h = g.buffer.byteLength,
                            5123 === v ? h >>= 1 : 5125 === v && (h >>= 2));
                            g.vertCount = h;
                            h = l;
                            0 > l && (h = 4,
                            l = g.buffer.dimension,
                            1 === l && (h = 0),
                            2 === l && (h = 1),
                            3 === l && (h = 4));
                            g.primType = h
                        }
                        function H(a) {
                            r.elementsCount--;
                            f(null !== a.buffer, "must not double destroy elements");
                            delete F[a.id];
                            a.buffer.destroy();
                            a.buffer = null
                        }
                        var F = {}
                          , K = 0
                          , O = {
                            uint8: 5121,
                            uint16: 5123
                        };
                        c.oes_element_index_uint && (O.uint32 = 5125);
                        v.prototype.bind = function() {
                            this.buffer.bind()
                        }
                        ;
                        var z = [];
                        return {
                            create: function(a, c) {
                                function l(a) {
                                    if (a)
                                        if ("number" === typeof a)
                                            q(a),
                                            b.primType = 4,
                                            b.vertCount = a | 0,
                                            b.type = 5121;
                                        else {
                                            var c = null
                                              , u = 35044
                                              , v = -1
                                              , z = -1
                                              , B = 0
                                              , r = 0;
                                            if (Array.isArray(a) || m(a) || k(a))
                                                c = a;
                                            else if (f.type(a, "object", "invalid arguments for elements"),
                                            "data"in a && (c = a.data,
                                            f(Array.isArray(c) || m(c) || k(c), "invalid data for element buffer")),
                                            "usage"in a && (f.parameter(a.usage, h, "invalid element buffer usage"),
                                            u = h[a.usage]),
                                            "primitive"in a && (f.parameter(a.primitive, g, "invalid element buffer primitive"),
                                            v = g[a.primitive]),
                                            "count"in a && (f("number" === typeof a.count && 0 <= a.count, "invalid vertex count for elements"),
                                            z = a.count | 0),
                                            "type"in a && (f.parameter(a.type, O, "invalid buffer type"),
                                            r = O[a.type]),
                                            "length"in a)
                                                B = a.length | 0;
                                            else if (B = z,
                                            5123 === r || 5122 === r)
                                                B *= 2;
                                            else if (5125 === r || 5124 === r)
                                                B *= 4;
                                            n(b, c, u, v, z, B, r)
                                        }
                                    else
                                        q(),
                                        b.primType = 4,
                                        b.vertCount = 0,
                                        b.type = 5121;
                                    return l
                                }
                                var q = B.create(null, 34963, !0)
                                  , b = new v(q._buffer);
                                r.elementsCount++;
                                l(a);
                                l._reglType = "elements";
                                l._elements = b;
                                l.subdata = function(a, b) {
                                    q.subdata(a, b);
                                    return l
                                }
                                ;
                                l.destroy = function() {
                                    H(b)
                                }
                                ;
                                return l
                            },
                            createStream: function(a) {
                                var f = z.pop();
                                f || (f = new v(B.create(null, 34963, !0, !1)._buffer));
                                n(f, a, 35040, -1, -1, 0, 0);
                                return f
                            },
                            destroyStream: function(a) {
                                z.push(a)
                            },
                            getElements: function(a) {
                                return "function" === typeof a && a._elements instanceof v ? a._elements : null
                            },
                            clear: function() {
                                l(F).forEach(H)
                            }
                        }
                    }
                }
                , {
                    "./constants/primitives.json": 6,
                    "./constants/usage.json": 7,
                    "./util/check": 21,
                    "./util/is-ndarray": 27,
                    "./util/is-typed-array": 28,
                    "./util/values": 33
                }],
                11: [function(c, r, A) {
                    var f = c("./util/check");
                    r.exports = function(c, k) {
                        function l(a) {
                            f.type(a, "string", "extension name must be string");
                            a = a.toLowerCase();
                            var h;
                            try {
                                h = g[a] = c.getExtension(a)
                            } catch (k) {}
                            return !!h
                        }
                        for (var g = {}, h = 0; h < k.extensions.length; ++h) {
                            var a = k.extensions[h];
                            if (!l(a))
                                return k.onDestroy(),
                                k.onDone('"' + a + '" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),
                                null
                        }
                        k.optionalExtensions.forEach(l);
                        return {
                            extensions: g,
                            restore: function() {
                                Object.keys(g).forEach(function(a) {
                                    if (!l(a))
                                        throw Error("(regl): error restoring extension " + a);
                                })
                            }
                        }
                    }
                }
                , {
                    "./util/check": 21
                }],
                12: [function(c, r, A) {
                    var f = c("./util/check")
                      , m = c("./util/values")
                      , k = c("./util/extend")
                      , l = [6408]
                      , g = [];
                    g[6408] = 4;
                    var h = [];
                    h[5121] = 1;
                    h[5126] = 4;
                    h[36193] = 2;
                    var a = [32854, 32855, 36194, 35907, 34842, 34843, 34836]
                      , q = {
                        36053: "complete",
                        36054: "incomplete attachment",
                        36057: "incomplete dimensions",
                        36055: "incomplete, missing attachment",
                        36061: "unsupported"
                    };
                    r.exports = function(c, r, v, n, H, F) {
                        function K(a, b, e) {
                            this.target = a;
                            this.texture = b;
                            this.renderbuffer = e;
                            var f = a = 0;
                            b ? (a = b.width,
                            f = b.height) : e && (a = e.width,
                            f = e.height);
                            this.width = a;
                            this.height = f
                        }
                        function O(a) {
                            a && (a.texture && a.texture._texture.decRef(),
                            a.renderbuffer && a.renderbuffer._renderbuffer.decRef())
                        }
                        function z(a, b, e) {
                            if (a) {
                                if (a.texture) {
                                    a = a.texture._texture;
                                    var c = Math.max(1, a.height);
                                    f(Math.max(1, a.width) === b && c === e, "inconsistent width/height for supplied texture")
                                } else
                                    a = a.renderbuffer._renderbuffer,
                                    f(a.width === b && a.height === e, "inconsistent width/height for renderbuffer");
                                a.refCount += 1
                            }
                        }
                        function u(a, b) {
                            b && (b.texture ? c.framebufferTexture2D(36160, a, b.target, b.texture._texture.texture, 0) : c.framebufferRenderbuffer(36160, a, 36161, b.renderbuffer._renderbuffer.renderbuffer))
                        }
                        function Q(a) {
                            var b = 3553
                              , e = null
                              , c = null
                              , g = a;
                            "object" === typeof a && (g = a.data,
                            "target"in a && (b = a.target | 0));
                            f.type(g, "function", "invalid attachment data");
                            a = g._reglType;
                            "texture2d" === a ? (e = g,
                            f(3553 === b)) : "textureCube" === a ? (e = g,
                            f(34069 <= b && 34075 > b, "invalid cube map target")) : "renderbuffer" === a ? (c = g,
                            b = 36161) : f.raise("invalid regl object for attachment");
                            return new K(b,e,c)
                        }
                        function Y(a, b, e, f, c) {
                            if (e)
                                return a = n.create2D({
                                    width: a,
                                    height: b,
                                    format: f,
                                    type: c
                                }),
                                a._texture.refCount = 0,
                                new K(3553,a,null);
                            a = H.create({
                                width: a,
                                height: b,
                                format: f
                            });
                            a._renderbuffer.refCount = 0;
                            return new K(36161,null,a)
                        }
                        function G(a) {
                            return a && (a.texture || a.renderbuffer)
                        }
                        function b(a, b, e) {
                            a && (a.texture ? a.texture.resize(b, e) : a.renderbuffer && a.renderbuffer.resize(b, e))
                        }
                        function e() {
                            this.id = ba++;
                            aa[this.id] = this;
                            this.framebuffer = c.createFramebuffer();
                            this.height = this.width = 0;
                            this.colorAttachments = [];
                            this.depthStencilAttachment = this.stencilAttachment = this.depthAttachment = null
                        }
                        function D(a) {
                            a.colorAttachments.forEach(O);
                            O(a.depthAttachment);
                            O(a.stencilAttachment);
                            O(a.depthStencilAttachment)
                        }
                        function V(a) {
                            var b = a.framebuffer;
                            f(b, "must not double destroy framebuffer");
                            c.deleteFramebuffer(b);
                            a.framebuffer = null;
                            F.framebufferCount--;
                            delete aa[a.id]
                        }
                        function Ga(a) {
                            var b;
                            c.bindFramebuffer(36160, a.framebuffer);
                            var e = a.colorAttachments;
                            for (b = 0; b < e.length; ++b)
                                u(36064 + b, e[b]);
                            for (b = e.length; b < v.maxColorAttachments; ++b)
                                c.framebufferTexture2D(36160, 36064 + b, 3553, null, 0);
                            c.framebufferTexture2D(36160, 33306, 3553, null, 0);
                            c.framebufferTexture2D(36160, 36096, 3553, null, 0);
                            c.framebufferTexture2D(36160, 36128, 3553, null, 0);
                            u(36096, a.depthAttachment);
                            u(36128, a.stencilAttachment);
                            u(33306, a.depthStencilAttachment);
                            a = c.checkFramebufferStatus(36160);
                            36053 !== a && f.raise("framebuffer configuration not supported, status = " + q[a]);
                            c.bindFramebuffer(36160, Z.next);
                            Z.cur = Z.next;
                            c.getError()
                        }
                        function A(c, n) {
                            function u(b, e) {
                                var c;
                                f(Z.next !== m, "can not update framebuffer which is currently in use");
                                var k = r.webgl_draw_buffers
                                  , n = 0
                                  , q = 0
                                  , x = !0
                                  , B = !0;
                                c = null;
                                var K = !0
                                  , H = "rgba"
                                  , V = "uint8"
                                  , F = 1
                                  , O = null
                                  , I = null
                                  , A = null
                                  , Ca = !1;
                                if ("number" === typeof b)
                                    n = b | 0,
                                    q = e | 0 || n;
                                else if (b) {
                                    f.type(b, "object", "invalid arguments for framebuffer");
                                    "shape"in b ? (q = b.shape,
                                    f(Array.isArray(q) && 2 <= q.length, "invalid shape for framebuffer"),
                                    n = q[0],
                                    q = q[1]) : ("radius"in b && (n = q = b.radius),
                                    "width"in b && (n = b.width),
                                    "height"in b && (q = b.height));
                                    if ("color"in b || "colors"in b)
                                        c = b.color || b.colors,
                                        Array.isArray(c) && f(1 === c.length || k, "multiple render targets not supported");
                                    if (!c) {
                                        "colorCount"in b && (F = b.colorCount | 0,
                                        f(0 < F, "invalid color buffer count"));
                                        "colorTexture"in b && (K = !!b.colorTexture,
                                        H = "rgba4");
                                        if ("colorType"in b) {
                                            V = b.colorType;
                                            if (K)
                                                f(r.oes_texture_float || !("float" === V || "float32" === V), "you must enable OES_texture_float in order to use floating point framebuffer objects"),
                                                f(r.oes_texture_half_float || !("half float" === V || "float16" === V), "you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects");
                                            else if ("half float" === V || "float16" === V)
                                                f(r.ext_color_buffer_half_float, "you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),
                                                H = "rgba16f";
                                            else if ("float" === V || "float32" === V)
                                                f(r.webgl_color_buffer_float, "you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),
                                                H = "rgba32f";
                                            f.oneOf(V, J, "invalid color type")
                                        }
                                        if ("colorFormat"in b)
                                            if (H = b.colorFormat,
                                            0 <= L.indexOf(H))
                                                K = !0;
                                            else if (0 <= W.indexOf(H))
                                                K = !1;
                                            else if (K)
                                                f.oneOf(b.colorFormat, L, "invalid color format for texture");
                                            else
                                                f.oneOf(b.colorFormat, W, "invalid color format for renderbuffer")
                                    }
                                    if ("depthTexture"in b || "depthStencilTexture"in b)
                                        Ca = !(!b.depthTexture && !b.depthStencilTexture),
                                        f(!Ca || r.webgl_depth_texture, "webgl_depth_texture extension not supported");
                                    "depth"in b && ("boolean" === typeof b.depth ? x = b.depth : (O = b.depth,
                                    B = !1));
                                    "stencil"in b && ("boolean" === typeof b.stencil ? B = b.stencil : (I = b.stencil,
                                    x = !1));
                                    "depthStencil"in b && ("boolean" === typeof b.depthStencil ? x = B = b.depthStencil : (A = b.depthStencil,
                                    B = x = !1))
                                } else
                                    n = q = 1;
                                var R = k = null
                                  , aa = null
                                  , ba = null;
                                if (Array.isArray(c))
                                    k = c.map(Q);
                                else if (c)
                                    k = [Q(c)];
                                else
                                    for (k = Array(F),
                                    c = 0; c < F; ++c)
                                        k[c] = Y(n, q, K, H, V);
                                f(r.webgl_draw_buffers || 1 >= k.length, "you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers.");
                                f(k.length <= v.maxColorAttachments, "too many color attachments, not supported");
                                n = n || k[0].width;
                                q = q || k[0].height;
                                O ? R = Q(O) : x && !B && (R = Y(n, q, Ca, "depth", "uint32"));
                                I ? aa = Q(I) : B && !x && (aa = Y(n, q, !1, "stencil", "uint8"));
                                A ? ba = Q(A) : !O && !I && B && x && (ba = Y(n, q, Ca, "depth stencil", "depth stencil"));
                                f(1 >= !!O + !!I + !!A, "invalid framebuffer configuration, can specify exactly one depth/stencil attachment");
                                x = null;
                                for (c = 0; c < k.length; ++c)
                                    z(k[c], n, q),
                                    f(!k[c] || k[c].texture && 0 <= l.indexOf(k[c].texture._texture.format) || k[c].renderbuffer && 0 <= a.indexOf(k[c].renderbuffer._renderbuffer.format), "framebuffer color attachment " + c + " is invalid"),
                                    k[c] && k[c].texture && (B = g[k[c].texture._texture.format] * h[k[c].texture._texture.type],
                                    null === x ? x = B : f(x === B, "all color attachments much have the same number of bits per pixel."));
                                z(R, n, q);
                                f(!R || R.texture && 6402 === R.texture._texture.format || R.renderbuffer && 33189 === R.renderbuffer._renderbuffer.format, "invalid depth attachment for framebuffer object");
                                z(aa, n, q);
                                f(!aa || aa.renderbuffer && 36168 === aa.renderbuffer._renderbuffer.format, "invalid stencil attachment for framebuffer object");
                                z(ba, n, q);
                                f(!ba || ba.texture && 34041 === ba.texture._texture.format || ba.renderbuffer && 34041 === ba.renderbuffer._renderbuffer.format, "invalid depth-stencil attachment for framebuffer object");
                                D(m);
                                m.width = n;
                                m.height = q;
                                m.colorAttachments = k;
                                m.depthAttachment = R;
                                m.stencilAttachment = aa;
                                m.depthStencilAttachment = ba;
                                u.color = k.map(G);
                                u.depth = G(R);
                                u.stencil = G(aa);
                                u.depthStencil = G(ba);
                                u.width = m.width;
                                u.height = m.height;
                                Ga(m);
                                return u
                            }
                            var m = new e;
                            F.framebufferCount++;
                            u(c, n);
                            return k(u, {
                                resize: function(a, e) {
                                    f(Z.next !== m, "can not resize a framebuffer which is currently in use");
                                    var c = a | 0
                                      , g = e | 0 || c;
                                    if (c === m.width && g === m.height)
                                        return u;
                                    for (var k = m.colorAttachments, h = 0; h < k.length; ++h)
                                        b(k[h], c, g);
                                    b(m.depthAttachment, c, g);
                                    b(m.stencilAttachment, c, g);
                                    b(m.depthStencilAttachment, c, g);
                                    m.width = u.width = c;
                                    m.height = u.height = g;
                                    Ga(m);
                                    return u
                                },
                                _reglType: "framebuffer",
                                _framebuffer: m,
                                destroy: function() {
                                    V(m);
                                    D(m)
                                },
                                bind: function(a) {
                                    Z.setFBO({
                                        framebuffer: u
                                    }, a)
                                }
                            })
                        }
                        var Z = {
                            cur: null,
                            next: null,
                            dirty: !1,
                            setFBO: null
                        }
                          , L = ["rgba"]
                          , W = ["rgba4", "rgb565", "rgb5 a1"];
                        r.ext_srgb && W.push("srgba");
                        r.ext_color_buffer_half_float && W.push("rgba16f", "rgb16f");
                        r.webgl_color_buffer_float && W.push("rgba32f");
                        var J = ["uint8"];
                        r.oes_texture_half_float && J.push("half float", "float16");
                        r.oes_texture_float && J.push("float", "float32");
                        var ba = 0
                          , aa = {};
                        return k(Z, {
                            getFramebuffer: function(a) {
                                return "function" === typeof a && "framebuffer" === a._reglType && (a = a._framebuffer,
                                a instanceof e) ? a : null
                            },
                            create: A,
                            createCube: function(a) {
                                function b(a) {
                                    var c;
                                    f(0 > e.indexOf(Z.next), "can not update framebuffer which is currently in use");
                                    var g = r.webgl_draw_buffers
                                      , h = {
                                        color: null
                                    }
                                      , l = 0
                                      , m = null;
                                    c = "rgba";
                                    var u = "uint8"
                                      , q = 1;
                                    if ("number" === typeof a)
                                        l = a | 0;
                                    else if (a) {
                                        f.type(a, "object", "invalid arguments for framebuffer");
                                        "shape"in a ? (l = a.shape,
                                        f(Array.isArray(l) && 2 <= l.length, "invalid shape for framebuffer"),
                                        f(l[0] === l[1], "cube framebuffer must be square"),
                                        l = l[0]) : ("radius"in a && (l = a.radius | 0),
                                        "width"in a ? (l = a.width | 0,
                                        "height"in a && f(a.height === l, "must be square")) : "height"in a && (l = a.height | 0));
                                        if ("color"in a || "colors"in a)
                                            m = a.color || a.colors,
                                            Array.isArray(m) && f(1 === m.length || g, "multiple render targets not supported");
                                        m || ("colorCount"in a && (q = a.colorCount | 0,
                                        f(0 < q, "invalid color buffer count")),
                                        "colorType"in a && (f.oneOf(a.colorType, J, "invalid color type"),
                                        u = a.colorType),
                                        "colorFormat"in a && (c = a.colorFormat,
                                        f.oneOf(a.colorFormat, L, "invalid color format for texture")));
                                        "depth"in a && (h.depth = a.depth);
                                        "stencil"in a && (h.stencil = a.stencil);
                                        "depthStencil"in a && (h.depthStencil = a.depthStencil)
                                    } else
                                        l = 1;
                                    if (m)
                                        if (Array.isArray(m))
                                            for (a = [],
                                            c = 0; c < m.length; ++c)
                                                a[c] = m[c];
                                        else
                                            a = [m];
                                    else
                                        for (a = Array(q),
                                        m = {
                                            radius: l,
                                            format: c,
                                            type: u
                                        },
                                        c = 0; c < q; ++c)
                                            a[c] = n.createCube(m);
                                    h.color = Array(a.length);
                                    for (c = 0; c < a.length; ++c)
                                        q = a[c],
                                        f("function" === typeof q && "textureCube" === q._reglType, "invalid cube map"),
                                        l = l || q.width,
                                        f(q.width === l && q.height === l, "invalid cube map shape"),
                                        h.color[c] = {
                                            target: 34069,
                                            data: a[c]
                                        };
                                    for (c = 0; 6 > c; ++c) {
                                        for (q = 0; q < a.length; ++q)
                                            h.color[q].target = 34069 + c;
                                        0 < c && (h.depth = e[0].depth,
                                        h.stencil = e[0].stencil,
                                        h.depthStencil = e[0].depthStencil);
                                        if (e[c])
                                            e[c](h);
                                        else
                                            e[c] = A(h)
                                    }
                                    return k(b, {
                                        width: l,
                                        height: l,
                                        color: a
                                    })
                                }
                                var e = Array(6);
                                b(a);
                                return k(b, {
                                    faces: e,
                                    resize: function(a) {
                                        var c = a | 0;
                                        f(0 < c && c <= v.maxCubeMapSize, "invalid radius for cube fbo");
                                        if (c === b.width)
                                            return b;
                                        var g = b.color;
                                        for (a = 0; a < g.length; ++a)
                                            g[a].resize(c);
                                        for (a = 0; 6 > a; ++a)
                                            e[a].resize(c);
                                        b.width = b.height = c;
                                        return b
                                    },
                                    _reglType: "framebufferCube",
                                    destroy: function() {
                                        e.forEach(function(a) {
                                            a.destroy()
                                        })
                                    }
                                })
                            },
                            clear: function() {
                                m(aa).forEach(V)
                            },
                            restore: function() {
                                m(aa).forEach(function(a) {
                                    a.framebuffer = c.createFramebuffer();
                                    Ga(a)
                                })
                            }
                        })
                    }
                }
                , {
                    "./util/check": 21,
                    "./util/extend": 24,
                    "./util/values": 33
                }],
                13: [function(c, r, A) {
                    r.exports = function(f, c) {
                        var k = 1;
                        c.ext_texture_filter_anisotropic && (k = f.getParameter(34047));
                        var l = 1
                          , g = 1;
                        c.webgl_draw_buffers && (l = f.getParameter(34852),
                        g = f.getParameter(36063));
                        return {
                            colorBits: [f.getParameter(3410), f.getParameter(3411), f.getParameter(3412), f.getParameter(3413)],
                            depthBits: f.getParameter(3414),
                            stencilBits: f.getParameter(3415),
                            subpixelBits: f.getParameter(3408),
                            extensions: Object.keys(c).filter(function(f) {
                                return !!c[f]
                            }),
                            maxAnisotropic: k,
                            maxDrawbuffers: l,
                            maxColorAttachments: g,
                            pointSizeDims: f.getParameter(33901),
                            lineWidthDims: f.getParameter(33902),
                            maxViewportDims: f.getParameter(3386),
                            maxCombinedTextureUnits: f.getParameter(35661),
                            maxCubeMapSize: f.getParameter(34076),
                            maxRenderbufferSize: f.getParameter(34024),
                            maxTextureUnits: f.getParameter(34930),
                            maxTextureSize: f.getParameter(3379),
                            maxAttributes: f.getParameter(34921),
                            maxVertexUniforms: f.getParameter(36347),
                            maxVertexTextureUnits: f.getParameter(35660),
                            maxVaryingVectors: f.getParameter(36348),
                            maxFragmentUniforms: f.getParameter(36349),
                            glsl: f.getParameter(35724),
                            renderer: f.getParameter(7937),
                            vendor: f.getParameter(7936),
                            version: f.getParameter(7938)
                        }
                    }
                }
                , {}],
                14: [function(c, r, A) {
                    var f = c("./util/check")
                      , m = c("./util/is-typed-array");
                    r.exports = function(c, l, g, h, a, q) {
                        function r(v) {
                            var n;
                            null === l.next ? (f(a.preserveDrawingBuffer, 'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),
                            n = 5121) : (f(null !== l.next.colorAttachments[0].texture, "You cannot read from a renderbuffer"),
                            n = l.next.colorAttachments[0].texture._texture.type,
                            q.oes_texture_float ? f(5121 === n || 5126 === n, "Reading from a framebuffer is only allowed for the types 'uint8' and 'float'") : f(5121 === n, "Reading from a framebuffer is only allowed for the type 'uint8'"));
                            var B = 0
                              , F = 0
                              , K = h.framebufferWidth
                              , E = h.framebufferHeight
                              , z = null;
                            m(v) ? z = v : v && (f.type(v, "object", "invalid arguments to regl.read()"),
                            B = v.x | 0,
                            F = v.y | 0,
                            f(0 <= B && B < h.framebufferWidth, "invalid x offset for regl.read"),
                            f(0 <= F && F < h.framebufferHeight, "invalid y offset for regl.read"),
                            K = (v.width || h.framebufferWidth - B) | 0,
                            E = (v.height || h.framebufferHeight - F) | 0,
                            z = v.data || null);
                            z && (5121 === n ? f(z instanceof Uint8Array, "buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'") : 5126 === n && f(z instanceof Float32Array, "buffer must be 'Float32Array' when reading from a framebuffer of type 'float'"));
                            f(0 < K && K + B <= h.framebufferWidth, "invalid width for read pixels");
                            f(0 < E && E + F <= h.framebufferHeight, "invalid height for read pixels");
                            g();
                            v = K * E * 4;
                            z || (5121 === n ? z = new Uint8Array(v) : 5126 === n && (z = z || new Float32Array(v)));
                            f.isTypedArray(z, "data buffer for regl.read() must be a typedarray");
                            f(z.byteLength >= v, "data buffer for regl.read() too small");
                            c.pixelStorei(3333, 4);
                            c.readPixels(B, F, K, E, 6408, n, z);
                            return z
                        }
                        function E(a) {
                            var f;
                            l.setFBO({
                                framebuffer: a.framebuffer
                            }, function() {
                                f = r(a)
                            });
                            return f
                        }
                        return function(a) {
                            return a && "framebuffer"in a ? E(a) : r(a)
                        }
                    }
                }
                , {
                    "./util/check": 21,
                    "./util/is-typed-array": 28
                }],
                15: [function(c, r, A) {
                    var f = c("./util/check")
                      , m = c("./util/values")
                      , k = [];
                    k[32854] = 2;
                    k[32855] = 2;
                    k[36194] = 2;
                    k[33189] = 2;
                    k[36168] = 1;
                    k[34041] = 4;
                    k[35907] = 4;
                    k[34836] = 16;
                    k[34842] = 8;
                    k[34843] = 6;
                    r.exports = function(c, g, h, a, q) {
                        function r(a) {
                            this.id = H++;
                            this.refCount = 1;
                            this.renderbuffer = a;
                            this.format = 32854;
                            this.height = this.width = 0;
                            q.profile && (this.stats = {
                                size: 0
                            })
                        }
                        function E(g) {
                            var k = g.renderbuffer;
                            f(k, "must not double destroy renderbuffer");
                            c.bindRenderbuffer(36161, null);
                            c.deleteRenderbuffer(k);
                            g.renderbuffer = null;
                            g.refCount = 0;
                            delete F[g.id];
                            a.renderbufferCount--
                        }
                        var v = {
                            rgba4: 32854,
                            rgb565: 36194,
                            "rgb5 a1": 32855,
                            depth: 33189,
                            stencil: 36168,
                            "depth stencil": 34041
                        };
                        g.ext_srgb && (v.srgba = 35907);
                        g.ext_color_buffer_half_float && (v.rgba16f = 34842,
                        v.rgb16f = 34843);
                        g.webgl_color_buffer_float && (v.rgba32f = 34836);
                        var n = [];
                        Object.keys(v).forEach(function(a) {
                            n[v[a]] = a
                        });
                        var H = 0
                          , F = {};
                        r.prototype.decRef = function() {
                            0 >= --this.refCount && E(this)
                        }
                        ;
                        q.profile && (a.getTotalRenderbufferSize = function() {
                            var a = 0;
                            Object.keys(F).forEach(function(c) {
                                a += F[c].stats.size
                            });
                            return a
                        }
                        );
                        return {
                            create: function(g, m) {
                                function z(a, g) {
                                    var m = 0
                                      , b = 0
                                      , e = 32854;
                                    "object" === typeof a && a ? ("shape"in a ? (b = a.shape,
                                    f(Array.isArray(b) && 2 <= b.length, "invalid renderbuffer shape"),
                                    m = b[0] | 0,
                                    b = b[1] | 0) : ("radius"in a && (m = b = a.radius | 0),
                                    "width"in a && (m = a.width | 0),
                                    "height"in a && (b = a.height | 0)),
                                    "format"in a && (f.parameter(a.format, v, "invalid renderbuffer format"),
                                    e = v[a.format])) : "number" === typeof a ? (m = a | 0,
                                    b = "number" === typeof g ? g | 0 : m) : a ? f.raise("invalid arguments to renderbuffer constructor") : m = b = 1;
                                    f(0 < m && 0 < b && m <= h.maxRenderbufferSize && b <= h.maxRenderbufferSize, "invalid renderbuffer size");
                                    if (m !== u.width || b !== u.height || e !== u.format)
                                        return z.width = u.width = m,
                                        z.height = u.height = b,
                                        u.format = e,
                                        c.bindRenderbuffer(36161, u.renderbuffer),
                                        c.renderbufferStorage(36161, e, m, b),
                                        q.profile && (u.stats.size = k[u.format] * u.width * u.height),
                                        z.format = n[u.format],
                                        z
                                }
                                var u = new r(c.createRenderbuffer());
                                F[u.id] = u;
                                a.renderbufferCount++;
                                z(g, m);
                                z.resize = function(a, g) {
                                    var n = a | 0
                                      , b = g | 0 || n;
                                    if (n === u.width && b === u.height)
                                        return z;
                                    f(0 < n && 0 < b && n <= h.maxRenderbufferSize && b <= h.maxRenderbufferSize, "invalid renderbuffer size");
                                    z.width = u.width = n;
                                    z.height = u.height = b;
                                    c.bindRenderbuffer(36161, u.renderbuffer);
                                    c.renderbufferStorage(36161, u.format, n, b);
                                    q.profile && (u.stats.size = k[u.format] * u.width * u.height);
                                    return z
                                }
                                ;
                                z._reglType = "renderbuffer";
                                z._renderbuffer = u;
                                q.profile && (z.stats = u.stats);
                                z.destroy = function() {
                                    u.decRef()
                                }
                                ;
                                return z
                            },
                            clear: function() {
                                m(F).forEach(E)
                            },
                            restore: function() {
                                m(F).forEach(function(a) {
                                    a.renderbuffer = c.createRenderbuffer();
                                    c.bindRenderbuffer(36161, a.renderbuffer);
                                    c.renderbufferStorage(36161, a.format, a.width, a.height)
                                });
                                c.bindRenderbuffer(36161, null)
                            }
                        }
                    }
                }
                , {
                    "./util/check": 21,
                    "./util/values": 33
                }],
                16: [function(c, r, A) {
                    var f = c("./util/check")
                      , m = c("./util/values");
                    r.exports = function(c, l, g, h) {
                        function a(a, c, f, g) {
                            this.name = a;
                            this.id = c;
                            this.location = f;
                            this.info = g
                        }
                        function q(a, c) {
                            for (var f = 0; f < a.length; ++f)
                                if (a[f].id === c.id) {
                                    a[f].location = c.location;
                                    return
                                }
                            a.push(c)
                        }
                        function r(a, g, h) {
                            var m = 35632 === a ? n : H
                              , q = m[g];
                            if (!q) {
                                var b = l.str(g)
                                  , q = c.createShader(a);
                                c.shaderSource(q, b);
                                c.compileShader(q);
                                f.shaderError(c, q, b, a, h);
                                m[g] = q
                            }
                            return q
                        }
                        function E(a, c) {
                            this.id = A++;
                            this.fragId = a;
                            this.vertId = c;
                            this.program = null;
                            this.uniforms = [];
                            this.attributes = [];
                            h.profile && (this.stats = {
                                uniformsCount: 0,
                                attributesCount: 0
                            })
                        }
                        function v(g, n) {
                            var m, v;
                            m = r(35632, g.fragId);
                            v = r(35633, g.vertId);
                            var H = g.program = c.createProgram();
                            c.attachShader(H, m);
                            c.attachShader(H, v);
                            c.linkProgram(H);
                            f.linkError(c, H, l.str(g.fragId), l.str(g.vertId), n);
                            var b = c.getProgramParameter(H, 35718);
                            h.profile && (g.stats.uniformsCount = b);
                            var e = g.uniforms;
                            for (m = 0; m < b; ++m)
                                if (v = c.getActiveUniform(H, m))
                                    if (1 < v.size)
                                        for (var D = 0; D < v.size; ++D) {
                                            var V = v.name.replace("[0]", "[" + D + "]");
                                            q(e, new a(V,l.id(V),c.getUniformLocation(H, V),v))
                                        }
                                    else
                                        q(e, new a(v.name,l.id(v.name),c.getUniformLocation(H, v.name),v));
                            b = c.getProgramParameter(H, 35721);
                            h.profile && (g.stats.attributesCount = b);
                            e = g.attributes;
                            for (m = 0; m < b; ++m)
                                (v = c.getActiveAttrib(H, m)) && q(e, new a(v.name,l.id(v.name),c.getAttribLocation(H, v.name),v))
                        }
                        var n = {}
                          , H = {}
                          , F = {}
                          , K = []
                          , A = 0;
                        h.profile && (g.getMaxUniformsCount = function() {
                            var a = 0;
                            K.forEach(function(c) {
                                c.stats.uniformsCount > a && (a = c.stats.uniformsCount)
                            });
                            return a
                        }
                        ,
                        g.getMaxAttributesCount = function() {
                            var a = 0;
                            K.forEach(function(c) {
                                c.stats.attributesCount > a && (a = c.stats.attributesCount)
                            });
                            return a
                        }
                        );
                        return {
                            clear: function() {
                                var a = c.deleteShader.bind(c);
                                m(n).forEach(a);
                                n = {};
                                m(H).forEach(a);
                                H = {};
                                K.forEach(function(a) {
                                    c.deleteProgram(a.program)
                                });
                                K.length = 0;
                                F = {};
                                g.shaderCount = 0
                            },
                            program: function(a, c, h) {
                                f.command(0 <= a, "missing vertex shader", h);
                                f.command(0 <= c, "missing fragment shader", h);
                                var k = F[c];
                                k || (k = F[c] = {});
                                var n = k[a];
                                n || (n = new E(c,a),
                                g.shaderCount++,
                                v(n, h),
                                k[a] = n,
                                K.push(n));
                                return n
                            },
                            restore: function() {
                                n = {};
                                H = {};
                                for (var a = 0; a < K.length; ++a)
                                    v(K[a])
                            },
                            shader: r,
                            frag: -1,
                            vert: -1
                        }
                    }
                }
                , {
                    "./util/check": 21,
                    "./util/values": 33
                }],
                17: [function(c, r, A) {
                    r.exports = function() {
                        return {
                            bufferCount: 0,
                            elementsCount: 0,
                            framebufferCount: 0,
                            shaderCount: 0,
                            textureCount: 0,
                            cubeCount: 0,
                            renderbufferCount: 0,
                            maxTextureUnits: 0
                        }
                    }
                }
                , {}],
                18: [function(c, r, A) {
                    r.exports = function() {
                        var c = {
                            "": 0
                        }
                          , m = [""];
                        return {
                            id: function(k) {
                                var l = c[k];
                                if (l)
                                    return l;
                                l = c[k] = m.length;
                                m.push(k);
                                return l
                            },
                            str: function(c) {
                                return m[c]
                            }
                        }
                    }
                }
                , {}],
                19: [function(c, r, A) {
                    function f(a) {
                        return Array.isArray(a) && (0 === a.length || "number" === typeof a[0])
                    }
                    function m(a) {
                        return Array.isArray(a) && 0 !== a.length && F(a[0]) ? !0 : !1
                    }
                    function k(a) {
                        return Object.prototype.toString.call(a)
                    }
                    function l(a) {
                        if (!a)
                            return !1;
                        var b = k(a);
                        return 0 <= Y.indexOf(b) ? !0 : f(a) || m(a) || v(a)
                    }
                    function g(a, b) {
                        36193 === a.type ? (a.data = H(b),
                        n.freeType(b)) : a.data = b
                    }
                    function h(a, c, f, g, h, k) {
                        a = "undefined" !== typeof b[a] ? b[a] : Q[a] * G[c];
                        k && (a *= 6);
                        if (h) {
                            for (g = 0; 1 <= f; )
                                g += a * f * f,
                                f /= 2;
                            return g
                        }
                        return a * f * g
                    }
                    var a = c("./util/check")
                      , q = c("./util/extend")
                      , B = c("./util/values")
                      , E = c("./util/is-typed-array")
                      , v = c("./util/is-ndarray")
                      , n = c("./util/pool")
                      , H = c("./util/to-half-float")
                      , F = c("./util/is-array-like")
                      , K = c("./util/flatten");
                    A = c("./constants/arraytypes.json");
                    var O = c("./constants/arraytypes.json")
                      , z = [9984, 9986, 9985, 9987]
                      , u = [0, 6409, 6410, 6407, 6408]
                      , Q = {};
                    Q[6409] = Q[6406] = Q[6402] = 1;
                    Q[34041] = Q[6410] = 2;
                    Q[6407] = Q[35904] = 3;
                    Q[6408] = Q[35906] = 4;
                    var Y = Object.keys(A).concat(["[object HTMLCanvasElement]", "[object CanvasRenderingContext2D]", "[object HTMLImageElement]", "[object HTMLVideoElement]"])
                      , G = [];
                    G[5121] = 1;
                    G[5126] = 4;
                    G[36193] = 2;
                    G[5123] = 2;
                    G[5125] = 4;
                    var b = [];
                    b[32854] = 2;
                    b[32855] = 2;
                    b[36194] = 2;
                    b[34041] = 4;
                    b[33776] = .5;
                    b[33777] = .5;
                    b[33778] = 1;
                    b[33779] = 1;
                    b[35986] = .5;
                    b[35987] = 1;
                    b[34798] = 1;
                    b[35840] = .5;
                    b[35841] = .25;
                    b[35842] = .5;
                    b[35843] = .25;
                    b[36196] = .5;
                    r.exports = function(b, c, r, A, G, Z, L) {
                        function W() {
                            this.format = this.internalformat = 6408;
                            this.type = 5121;
                            this.flipY = this.premultiplyAlpha = this.compressed = !1;
                            this.unpackAlignment = 1;
                            this.channels = this.height = this.width = this.colorSpace = 0
                        }
                        function J(a, b) {
                            a.internalformat = b.internalformat;
                            a.format = b.format;
                            a.type = b.type;
                            a.compressed = b.compressed;
                            a.premultiplyAlpha = b.premultiplyAlpha;
                            a.flipY = b.flipY;
                            a.unpackAlignment = b.unpackAlignment;
                            a.colorSpace = b.colorSpace;
                            a.width = b.width;
                            a.height = b.height;
                            a.channels = b.channels
                        }
                        function ba(d, b) {
                            if ("object" === typeof b && b) {
                                "premultiplyAlpha"in b && (a.type(b.premultiplyAlpha, "boolean", "invalid premultiplyAlpha"),
                                d.premultiplyAlpha = b.premultiplyAlpha);
                                "flipY"in b && (a.type(b.flipY, "boolean", "invalid texture flip"),
                                d.flipY = b.flipY);
                                "alignment"in b && (a.oneOf(b.alignment, [1, 2, 4, 8], "invalid texture unpack alignment"),
                                d.unpackAlignment = b.alignment);
                                "colorSpace"in b && (a.parameter(b.colorSpace, oa, "invalid colorSpace"),
                                d.colorSpace = oa[b.colorSpace]);
                                if ("type"in b) {
                                    var e = b.type;
                                    a(c.oes_texture_float || !("float" === e || "float32" === e), "you must enable the OES_texture_float extension in order to use floating point textures.");
                                    a(c.oes_texture_half_float || !("half float" === e || "float16" === e), "you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures.");
                                    a(c.webgl_depth_texture || !("uint16" === e || "uint32" === e || "depth stencil" === e), "you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures.");
                                    a.parameter(e, S, "invalid texture type");
                                    d.type = S[e]
                                }
                                var f = d.width
                                  , g = d.height
                                  , h = d.channels
                                  , e = !1;
                                "shape"in b ? (a(Array.isArray(b.shape) && 2 <= b.shape.length, "shape must be an array"),
                                f = b.shape[0],
                                g = b.shape[1],
                                3 === b.shape.length && (h = b.shape[2],
                                a(0 < h && 4 >= h, "invalid number of channels"),
                                e = !0),
                                a(0 <= f && f <= r.maxTextureSize, "invalid width"),
                                a(0 <= g && g <= r.maxTextureSize, "invalid height")) : ("radius"in b && (f = g = b.radius,
                                a(0 <= f && f <= r.maxTextureSize, "invalid radius")),
                                "width"in b && (f = b.width,
                                a(0 <= f && f <= r.maxTextureSize, "invalid width")),
                                "height"in b && (g = b.height,
                                a(0 <= g && g <= r.maxTextureSize, "invalid height")),
                                "channels"in b && (h = b.channels,
                                a(0 < h && 4 >= h, "invalid number of channels"),
                                e = !0));
                                d.width = f | 0;
                                d.height = g | 0;
                                d.channels = h | 0;
                                f = !1;
                                "format"in b && (f = b.format,
                                a(c.webgl_depth_texture || !("depth" === f || "depth stencil" === f), "you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),
                                a.parameter(f, ca, "invalid texture format"),
                                g = d.internalformat = ca[f],
                                d.format = La[g],
                                f in S && !("type"in b) && (d.type = S[f]),
                                f in ha && (d.compressed = !0),
                                f = !0);
                                !e && f ? d.channels = Q[d.format] : e && !f ? d.channels !== u[d.format] && (d.format = d.internalformat = u[d.channels]) : f && e && a(d.channels === Q[d.format], "number of channels inconsistent with specified format")
                            }
                        }
                        function aa(a) {
                            b.pixelStorei(37440, a.flipY);
                            b.pixelStorei(37441, a.premultiplyAlpha);
                            b.pixelStorei(37443, a.colorSpace);
                            b.pixelStorei(3317, a.unpackAlignment)
                        }
                        function x() {
                            W.call(this);
                            this.yOffset = this.xOffset = 0;
                            this.data = null;
                            this.needsFree = !1;
                            this.element = null;
                            this.needsCopy = !1
                        }
                        function I(d, b) {
                            var e = null;
                            l(b) ? e = b : b && (a.type(b, "object", "invalid pixel data type"),
                            ba(d, b),
                            "x"in b && (d.xOffset = b.x | 0),
                            "y"in b && (d.yOffset = b.y | 0),
                            l(b.data) && (e = b.data));
                            a(!d.compressed || e instanceof Uint8Array, "compressed texture data must be stored in a uint8array");
                            if (b.copy) {
                                a(!e, "can not specify copy and data field for the same texture");
                                var c = G.viewportWidth
                                  , h = G.viewportHeight;
                                d.width = d.width || c - d.xOffset;
                                d.height = d.height || h - d.yOffset;
                                d.needsCopy = !0;
                                a(0 <= d.xOffset && d.xOffset < c && 0 <= d.yOffset && d.yOffset < h && 0 < d.width && d.width <= c && 0 < d.height && d.height <= h, "copy texture read out of bounds")
                            } else if (!e)
                                d.width = d.width || 1,
                                d.height = d.height || 1,
                                d.channels = d.channels || 4;
                            else if (E(e))
                                d.channels = d.channels || 4,
                                d.data = e,
                                "type"in b || 5121 !== d.type || (d.type = O[Object.prototype.toString.call(e)] | 0);
                            else if (f(e)) {
                                d.channels = d.channels || 4;
                                c = e;
                                h = c.length;
                                switch (d.type) {
                                case 5121:
                                case 5123:
                                case 5125:
                                case 5126:
                                    h = n.allocType(d.type, h);
                                    h.set(c);
                                    d.data = h;
                                    break;
                                case 36193:
                                    d.data = H(c);
                                    break;
                                default:
                                    a.raise("unsupported texture type, must specify a typed array")
                                }
                                d.alignment = 1;
                                d.needsFree = !0
                            } else if (v(e)) {
                                c = e.data;
                                Array.isArray(c) || 5121 !== d.type || (d.type = O[Object.prototype.toString.call(c)] | 0);
                                var h = e.shape, q = e.stride, D, x, B, z;
                                3 === h.length ? (B = h[2],
                                z = q[2]) : (a(2 === h.length, "invalid ndarray pixel data, must be 2 or 3D"),
                                z = B = 1);
                                D = h[0];
                                x = h[1];
                                h = q[0];
                                q = q[1];
                                d.alignment = 1;
                                d.width = D;
                                d.height = x;
                                d.channels = B;
                                d.format = d.internalformat = u[B];
                                d.needsFree = !0;
                                D = z;
                                e = e.offset;
                                B = d.width;
                                z = d.height;
                                x = d.channels;
                                for (var t = n.allocType(36193 === d.type ? 5126 : d.type, B * z * x), C = 0, J = 0; J < z; ++J)
                                    for (var L = 0; L < B; ++L)
                                        for (var A = 0; A < x; ++A)
                                            t[C++] = c[h * L + q * J + D * A + e];
                                g(d, t)
                            } else if ("[object HTMLCanvasElement]" === k(e) || "[object CanvasRenderingContext2D]" === k(e))
                                "[object HTMLCanvasElement]" === k(e) ? d.element = e : d.element = e.canvas,
                                d.width = d.element.width,
                                d.height = d.element.height,
                                d.channels = 4;
                            else if ("[object HTMLImageElement]" === k(e))
                                d.element = e,
                                d.width = e.naturalWidth,
                                d.height = e.naturalHeight,
                                d.channels = 4;
                            else if ("[object HTMLVideoElement]" === k(e))
                                d.element = e,
                                d.width = e.videoWidth,
                                d.height = e.videoHeight,
                                d.channels = 4;
                            else if (m(e)) {
                                c = d.width || e[0].length;
                                h = d.height || e.length;
                                q = d.channels;
                                q = F(e[0][0]) ? q || e[0][0].length : q || 1;
                                D = K.shape(e);
                                B = 1;
                                for (z = 0; z < D.length; ++z)
                                    B *= D[z];
                                B = n.allocType(36193 === d.type ? 5126 : d.type, B);
                                K.flatten(e, D, "", B);
                                g(d, B);
                                d.alignment = 1;
                                d.width = c;
                                d.height = h;
                                d.channels = q;
                                d.format = d.internalformat = u[q];
                                d.needsFree = !0
                            }
                            5126 === d.type ? a(0 <= r.extensions.indexOf("oes_texture_float"), "oes_texture_float extension not enabled") : 36193 === d.type && a(0 <= r.extensions.indexOf("oes_texture_half_float"), "oes_texture_half_float extension not enabled")
                        }
                        function Y(a, c, f, g, h) {
                            var k = a.element
                              , n = a.data
                              , m = a.internalformat
                              , l = a.format
                              , q = a.type
                              , t = a.width
                              , v = a.height;
                            aa(a);
                            k ? b.texSubImage2D(c, h, f, g, l, q, k) : a.compressed ? b.compressedTexSubImage2D(c, h, f, g, m, t, v, n) : a.needsCopy ? (A(),
                            b.copyTexSubImage2D(c, h, f, g, a.xOffset, a.yOffset, t, v)) : b.texSubImage2D(c, h, f, g, t, v, l, q, n)
                        }
                        function da() {
                            return Ma.pop() || new x
                        }
                        function pa(a) {
                            a.needsFree && n.freeType(a.data);
                            x.call(a);
                            Ma.push(a)
                        }
                        function va() {
                            W.call(this);
                            this.genMipmaps = !1;
                            this.mipmapHint = 4352;
                            this.mipmask = 0;
                            this.images = Array(16)
                        }
                        function ea(a, b, e) {
                            var c = a.images[0] = da();
                            a.mipmask = 1;
                            c.width = a.width = b;
                            c.height = a.height = e;
                            c.channels = a.channels = 4
                        }
                        function T(d, b) {
                            var e = null;
                            if (l(b))
                                e = d.images[0] = da(),
                                J(e, d),
                                I(e, b),
                                d.mipmask = 1;
                            else if (ba(d, b),
                            Array.isArray(b.mipmap))
                                for (var c = b.mipmap, f = 0; f < c.length; ++f)
                                    e = d.images[f] = da(),
                                    J(e, d),
                                    e.width >>= f,
                                    e.height >>= f,
                                    I(e, c[f]),
                                    d.mipmask |= 1 << f;
                            else
                                e = d.images[0] = da(),
                                J(e, d),
                                I(e, b),
                                d.mipmask = 1;
                            J(d, d.images[0]);
                            (d.compressed && 33776 === d.internalformat || 33777 === d.internalformat || 33778 === d.internalformat || 33779 === d.internalformat) && a(0 === d.width % 4 && 0 === d.height % 4, "for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")
                        }
                        function N(a, c) {
                            for (var f = a.images, g = 0; g < f.length && f[g]; ++g) {
                                var h = f[g]
                                  , k = c
                                  , n = g
                                  , m = h.element
                                  , l = h.data
                                  , q = h.internalformat
                                  , t = h.format
                                  , v = h.type
                                  , u = h.width
                                  , r = h.height;
                                aa(h);
                                m ? b.texImage2D(k, n, t, t, v, m) : h.compressed ? b.compressedTexImage2D(k, n, q, u, r, 0, l) : h.needsCopy ? (A(),
                                b.copyTexImage2D(k, n, t, h.xOffset, h.yOffset, u, r, 0)) : b.texImage2D(k, n, t, u, r, 0, t, v, l)
                            }
                        }
                        function Ba() {
                            var a = Na.pop() || new va;
                            W.call(a);
                            for (var b = a.mipmask = 0; 16 > b; ++b)
                                a.images[b] = null;
                            return a
                        }
                        function sa(a) {
                            for (var b = a.images, e = 0; e < b.length; ++e)
                                b[e] && pa(b[e]),
                                b[e] = null;
                            Na.push(a)
                        }
                        function wa() {
                            this.magFilter = this.minFilter = 9728;
                            this.wrapT = this.wrapS = 33071;
                            this.anisotropic = 1;
                            this.genMipmaps = !1;
                            this.mipmapHint = 4352
                        }
                        function fa(b, e) {
                            if ("min"in e) {
                                var c = e.min;
                                a.parameter(c, ia);
                                b.minFilter = ia[c];
                                0 <= z.indexOf(b.minFilter) && (b.genMipmaps = !0)
                            }
                            "mag"in e && (c = e.mag,
                            a.parameter(c, R),
                            b.magFilter = R[c]);
                            var c = b.wrapS
                              , f = b.wrapT;
                            if ("wrap"in e) {
                                var g = e.wrap;
                                "string" === typeof g ? (a.parameter(g, X),
                                c = f = X[g]) : Array.isArray(g) && (a.parameter(g[0], X),
                                a.parameter(g[1], X),
                                c = X[g[0]],
                                f = X[g[1]])
                            } else
                                "wrapS"in e && (c = e.wrapS,
                                a.parameter(c, X),
                                c = X[c]),
                                "wrapT"in e && (f = e.wrapT,
                                a.parameter(f, X),
                                f = X[f]);
                            b.wrapS = c;
                            b.wrapT = f;
                            "anisotropic"in e && (c = e.anisotropic,
                            a("number" === typeof c && 1 <= c && c <= r.maxAnisotropic, "aniso samples must be between 1 and "),
                            b.anisotropic = e.anisotropic);
                            if ("mipmap"in e) {
                                c = !1;
                                switch (typeof e.mipmap) {
                                case "string":
                                    a.parameter(e.mipmap, xa, "invalid mipmap hint");
                                    b.mipmapHint = xa[e.mipmap];
                                    c = b.genMipmaps = !0;
                                    break;
                                case "boolean":
                                    c = b.genMipmaps = e.mipmap;
                                    break;
                                case "object":
                                    a(Array.isArray(e.mipmap), "invalid mipmap type");
                                    b.genMipmaps = !1;
                                    c = !0;
                                    break;
                                default:
                                    a.raise("invalid mipmap type")
                                }
                                !c || "min"in e || (b.minFilter = 9984)
                            }
                        }
                        function ka(a, f) {
                            b.texParameteri(f, 10241, a.minFilter);
                            b.texParameteri(f, 10240, a.magFilter);
                            b.texParameteri(f, 10242, a.wrapS);
                            b.texParameteri(f, 10243, a.wrapT);
                            c.ext_texture_filter_anisotropic && b.texParameteri(f, 34046, a.anisotropic);
                            a.genMipmaps && (b.hint(33170, a.mipmapHint),
                            b.generateMipmap(f))
                        }
                        function la(a) {
                            W.call(this);
                            this.mipmask = 0;
                            this.internalformat = 6408;
                            this.id = Pa++;
                            this.refCount = 1;
                            this.target = a;
                            this.texture = b.createTexture();
                            this.unit = -1;
                            this.bindCount = 0;
                            this.texInfo = new wa;
                            L.profile && (this.stats = {
                                size: 0
                            })
                        }
                        function ma(a) {
                            b.activeTexture(33984);
                            b.bindTexture(a.target, a.texture)
                        }
                        function na() {
                            var a = ga[0];
                            a ? b.bindTexture(a.target, a.texture) : b.bindTexture(3553, null)
                        }
                        function qa(d) {
                            var c = d.texture;
                            a(c, "must not double destroy texture");
                            var f = d.unit
                              , g = d.target;
                            0 <= f && (b.activeTexture(33984 + f),
                            b.bindTexture(g, null),
                            ga[f] = null);
                            b.deleteTexture(c);
                            d.texture = null;
                            d.params = null;
                            d.pixels = null;
                            d.refCount = 0;
                            delete ua[d.id];
                            Z.textureCount--
                        }
                        var xa = {
                            "don't care": 4352,
                            "dont care": 4352,
                            nice: 4354,
                            fast: 4353
                        }
                          , X = {
                            repeat: 10497,
                            clamp: 33071,
                            mirror: 33648
                        }
                          , R = {
                            nearest: 9728,
                            linear: 9729
                        }
                          , ia = q({
                            mipmap: 9987,
                            "nearest mipmap nearest": 9984,
                            "linear mipmap nearest": 9985,
                            "nearest mipmap linear": 9986,
                            "linear mipmap linear": 9987
                        }, R)
                          , oa = {
                            none: 0,
                            browser: 37444
                        }
                          , S = {
                            uint8: 5121,
                            rgba4: 32819,
                            rgb565: 33635,
                            "rgb5 a1": 32820
                        }
                          , ca = {
                            alpha: 6406,
                            luminance: 6409,
                            "luminance alpha": 6410,
                            rgb: 6407,
                            rgba: 6408,
                            rgba4: 32854,
                            "rgb5 a1": 32855,
                            rgb565: 36194
                        }
                          , ha = {};
                        c.ext_srgb && (ca.srgb = 35904,
                        ca.srgba = 35906);
                        c.oes_texture_float && (S.float32 = S["float"] = 5126);
                        c.oes_texture_half_float && (S.float16 = S["half float"] = 36193);
                        c.webgl_depth_texture && (q(ca, {
                            depth: 6402,
                            "depth stencil": 34041
                        }),
                        q(S, {
                            uint16: 5123,
                            uint32: 5125,
                            "depth stencil": 34042
                        }));
                        c.webgl_compressed_texture_s3tc && q(ha, {
                            "rgb s3tc dxt1": 33776,
                            "rgba s3tc dxt1": 33777,
                            "rgba s3tc dxt3": 33778,
                            "rgba s3tc dxt5": 33779
                        });
                        c.webgl_compressed_texture_atc && q(ha, {
                            "rgb atc": 35986,
                            "rgba atc explicit alpha": 35987,
                            "rgba atc interpolated alpha": 34798
                        });
                        c.webgl_compressed_texture_pvrtc && q(ha, {
                            "rgb pvrtc 4bppv1": 35840,
                            "rgb pvrtc 2bppv1": 35841,
                            "rgba pvrtc 4bppv1": 35842,
                            "rgba pvrtc 2bppv1": 35843
                        });
                        c.webgl_compressed_texture_etc1 && (ha["rgb etc1"] = 36196);
                        var ya = Array.prototype.slice.call(b.getParameter(34467));
                        Object.keys(ha).forEach(function(a) {
                            var b = ha[a];
                            0 <= ya.indexOf(b) && (ca[a] = b)
                        });
                        var ja = Object.keys(ca);
                        r.textureFormats = ja;
                        var ta = [];
                        Object.keys(ca).forEach(function(a) {
                            ta[ca[a]] = a
                        });
                        var Ea = [];
                        Object.keys(S).forEach(function(a) {
                            Ea[S[a]] = a
                        });
                        var Ha = [];
                        Object.keys(R).forEach(function(a) {
                            Ha[R[a]] = a
                        });
                        var Ka = [];
                        Object.keys(ia).forEach(function(a) {
                            Ka[ia[a]] = a
                        });
                        var Fa = [];
                        Object.keys(X).forEach(function(a) {
                            Fa[X[a]] = a
                        });
                        var La = ja.reduce(function(a, b) {
                            var e = ca[b];
                            6409 === e || 6406 === e || 6409 === e || 6410 === e || 6402 === e || 34041 === e ? a[e] = e : 32855 === e || 0 <= b.indexOf("rgba") ? a[e] = 6408 : a[e] = 6407;
                            return a
                        }, {})
                          , Ma = []
                          , Na = []
                          , Pa = 0
                          , ua = {}
                          , ra = r.maxTextureUnits
                          , ga = Array(ra).map(function() {
                            return null
                        });
                        q(la.prototype, {
                            bind: function() {
                                this.bindCount += 1;
                                var d = this.unit;
                                if (0 > d) {
                                    for (var c = 0; c < ra; ++c) {
                                        var f = ga[c];
                                        if (f) {
                                            if (0 < f.bindCount)
                                                continue;
                                            f.unit = -1
                                        }
                                        ga[c] = this;
                                        d = c;
                                        break
                                    }
                                    d >= ra && a.raise("insufficient number of texture units");
                                    L.profile && Z.maxTextureUnits < d + 1 && (Z.maxTextureUnits = d + 1);
                                    this.unit = d;
                                    b.activeTexture(33984 + d);
                                    b.bindTexture(this.target, this.texture)
                                }
                                return d
                            },
                            unbind: function() {
                                --this.bindCount
                            },
                            decRef: function() {
                                0 >= --this.refCount && qa(this)
                            }
                        });
                        L.profile && (Z.getTotalTextureSize = function() {
                            var a = 0;
                            Object.keys(ua).forEach(function(b) {
                                a += ua[b].stats.size
                            });
                            return a
                        }
                        );
                        return {
                            create2D: function(d, c) {
                                function f(b, d) {
                                    var e = g.texInfo;
                                    wa.call(e);
                                    var c = Ba();
                                    "number" === typeof b ? "number" === typeof d ? ea(c, b | 0, d | 0) : ea(c, b | 0, b | 0) : b ? (a.type(b, "object", "invalid arguments to regl.texture"),
                                    fa(e, b),
                                    T(c, b)) : ea(c, 1, 1);
                                    e.genMipmaps && (c.mipmask = (c.width << 1) - 1);
                                    g.mipmask = c.mipmask;
                                    J(g, c);
                                    a.texture2D(e, c, r);
                                    g.internalformat = c.internalformat;
                                    f.width = c.width;
                                    f.height = c.height;
                                    ma(g);
                                    N(c, 3553);
                                    ka(e, 3553);
                                    na();
                                    sa(c);
                                    L.profile && (g.stats.size = h(g.internalformat, g.type, c.width, c.height, e.genMipmaps, !1));
                                    f.format = ta[g.internalformat];
                                    f.type = Ea[g.type];
                                    f.mag = Ha[e.magFilter];
                                    f.min = Ka[e.minFilter];
                                    f.wrapS = Fa[e.wrapS];
                                    f.wrapT = Fa[e.wrapT];
                                    return f
                                }
                                var g = new la(3553);
                                ua[g.id] = g;
                                Z.textureCount++;
                                f(d, c);
                                f.subimage = function(b, d, e, c) {
                                    a(!!b, "must specify image data");
                                    d |= 0;
                                    e |= 0;
                                    c |= 0;
                                    var h = da();
                                    J(h, g);
                                    h.width = 0;
                                    h.height = 0;
                                    I(h, b);
                                    h.width = h.width || (g.width >> c) - d;
                                    h.height = h.height || (g.height >> c) - e;
                                    a(g.type === h.type && g.format === h.format && g.internalformat === h.internalformat, "incompatible format for texture.subimage");
                                    a(0 <= d && 0 <= e && d + h.width <= g.width && e + h.height <= g.height, "texture.subimage write out of bounds");
                                    a(g.mipmask & 1 << c, "missing mipmap data");
                                    a(h.data || h.element || h.needsCopy, "missing image data");
                                    ma(g);
                                    Y(h, 3553, d, e, c);
                                    na();
                                    pa(h);
                                    return f
                                }
                                ;
                                f.resize = function(a, d) {
                                    var c = a | 0
                                      , k = d | 0 || c;
                                    if (c === g.width && k === g.height)
                                        return f;
                                    f.width = g.width = c;
                                    f.height = g.height = k;
                                    ma(g);
                                    for (var n = 0; g.mipmask >> n; ++n)
                                        b.texImage2D(3553, n, g.format, c >> n, k >> n, 0, g.format, g.type, null);
                                    na();
                                    L.profile && (g.stats.size = h(g.internalformat, g.type, c, k, !1, !1));
                                    return f
                                }
                                ;
                                f._reglType = "texture2d";
                                f._texture = g;
                                L.profile && (f.stats = g.stats);
                                f.destroy = function() {
                                    g.decRef()
                                }
                                ;
                                return f
                            },
                            createCube: function(d, c, f, g, k, n) {
                                function m(b, d, e, c, f, g) {
                                    var k, n = l.texInfo;
                                    wa.call(n);
                                    for (k = 0; 6 > k; ++k)
                                        q[k] = Ba();
                                    if ("number" !== typeof b && b)
                                        if ("object" === typeof b)
                                            if (d)
                                                T(q[0], b),
                                                T(q[1], d),
                                                T(q[2], e),
                                                T(q[3], c),
                                                T(q[4], f),
                                                T(q[5], g);
                                            else if (fa(n, b),
                                            ba(l, b),
                                            "faces"in b)
                                                for (b = b.faces,
                                                a(Array.isArray(b) && 6 === b.length, "cube faces must be a length 6 array"),
                                                k = 0; 6 > k; ++k)
                                                    a("object" === typeof b[k] && !!b[k], "invalid input for cube map face"),
                                                    J(q[k], l),
                                                    T(q[k], b[k]);
                                            else
                                                for (k = 0; 6 > k; ++k)
                                                    T(q[k], b);
                                        else
                                            a.raise("invalid arguments to cube map");
                                    else
                                        for (b = b | 0 || 1,
                                        k = 0; 6 > k; ++k)
                                            ea(q[k], b, b);
                                    J(l, q[0]);
                                    l.mipmask = n.genMipmaps ? (q[0].width << 1) - 1 : q[0].mipmask;
                                    a.textureCube(l, n, q, r);
                                    l.internalformat = q[0].internalformat;
                                    m.width = q[0].width;
                                    m.height = q[0].height;
                                    ma(l);
                                    for (k = 0; 6 > k; ++k)
                                        N(q[k], 34069 + k);
                                    ka(n, 34067);
                                    na();
                                    L.profile && (l.stats.size = h(l.internalformat, l.type, m.width, m.height, n.genMipmaps, !0));
                                    m.format = ta[l.internalformat];
                                    m.type = Ea[l.type];
                                    m.mag = Ha[n.magFilter];
                                    m.min = Ka[n.minFilter];
                                    m.wrapS = Fa[n.wrapS];
                                    m.wrapT = Fa[n.wrapT];
                                    for (k = 0; 6 > k; ++k)
                                        sa(q[k]);
                                    return m
                                }
                                var l = new la(34067);
                                ua[l.id] = l;
                                Z.cubeCount++;
                                var q = Array(6);
                                m(d, c, f, g, k, n);
                                m.subimage = function(b, d, e, c, f) {
                                    a(!!d, "must specify image data");
                                    a("number" === typeof b && b === (b | 0) && 0 <= b && 6 > b, "invalid face");
                                    e |= 0;
                                    c |= 0;
                                    f |= 0;
                                    var g = da();
                                    J(g, l);
                                    g.width = 0;
                                    g.height = 0;
                                    I(g, d);
                                    g.width = g.width || (l.width >> f) - e;
                                    g.height = g.height || (l.height >> f) - c;
                                    a(l.type === g.type && l.format === g.format && l.internalformat === g.internalformat, "incompatible format for texture.subimage");
                                    a(0 <= e && 0 <= c && e + g.width <= l.width && c + g.height <= l.height, "texture.subimage write out of bounds");
                                    a(l.mipmask & 1 << f, "missing mipmap data");
                                    a(g.data || g.element || g.needsCopy, "missing image data");
                                    ma(l);
                                    Y(g, 34069 + b, e, c, f);
                                    na();
                                    pa(g);
                                    return m
                                }
                                ;
                                m.resize = function(a) {
                                    a |= 0;
                                    if (a !== l.width) {
                                        m.width = l.width = a;
                                        m.height = l.height = a;
                                        ma(l);
                                        for (var d = 0; 6 > d; ++d)
                                            for (var c = 0; l.mipmask >> c; ++c)
                                                b.texImage2D(34069 + d, c, l.format, a >> c, a >> c, 0, l.format, l.type, null);
                                        na();
                                        L.profile && (l.stats.size = h(l.internalformat, l.type, m.width, m.height, !1, !0));
                                        return m
                                    }
                                }
                                ;
                                m._reglType = "textureCube";
                                m._texture = l;
                                L.profile && (m.stats = l.stats);
                                m.destroy = function() {
                                    l.decRef()
                                }
                                ;
                                return m
                            },
                            clear: function() {
                                for (var a = 0; a < ra; ++a)
                                    b.activeTexture(33984 + a),
                                    b.bindTexture(3553, null),
                                    ga[a] = null;
                                B(ua).forEach(qa);
                                Z.cubeCount = 0;
                                Z.textureCount = 0
                            },
                            getTexture: function(a) {
                                return null
                            },
                            restore: function() {
                                B(ua).forEach(function(a) {
                                    a.texture = b.createTexture();
                                    b.bindTexture(a.target, a.texture);
                                    for (var c = 0; 32 > c; ++c)
                                        if (0 !== (a.mipmask & 1 << c))
                                            if (3553 === a.target)
                                                b.texImage2D(3553, c, a.internalformat, a.width >> c, a.height >> c, 0, a.internalformat, a.type, null);
                                            else
                                                for (var f = 0; 6 > f; ++f)
                                                    b.texImage2D(34069 + f, c, a.internalformat, a.width >> c, a.height >> c, 0, a.internalformat, a.type, null);
                                    ka(a.texInfo, a.target)
                                })
                            }
                        }
                    }
                }
                , {
                    "./constants/arraytypes.json": 4,
                    "./util/check": 21,
                    "./util/extend": 24,
                    "./util/flatten": 25,
                    "./util/is-array-like": 26,
                    "./util/is-ndarray": 27,
                    "./util/is-typed-array": 28,
                    "./util/pool": 30,
                    "./util/to-half-float": 32,
                    "./util/values": 33
                }],
                20: [function(c, r, A) {
                    r.exports = function(c, m) {
                        function k() {
                            this.endQueryIndex = this.startQueryIndex = -1;
                            this.sum = 0;
                            this.stats = null
                        }
                        function l(a, c, f) {
                            var g = q.pop() || new k;
                            g.startQueryIndex = a;
                            g.endQueryIndex = c;
                            g.sum = 0;
                            g.stats = f;
                            r.push(g)
                        }
                        var g = m.ext_disjoint_timer_query;
                        if (!g)
                            return null;
                        var h = []
                          , a = []
                          , q = []
                          , r = []
                          , E = []
                          , v = [];
                        return {
                            beginQuery: function(c) {
                                var f = h.pop() || g.createQueryEXT();
                                g.beginQueryEXT(35007, f);
                                a.push(f);
                                l(a.length - 1, a.length, c)
                            },
                            endQuery: function() {
                                g.endQueryEXT(35007)
                            },
                            pushScopeStats: l,
                            update: function() {
                                var c, f;
                                c = a.length;
                                if (0 !== c) {
                                    v.length = Math.max(v.length, c + 1);
                                    E.length = Math.max(E.length, c + 1);
                                    E[0] = 0;
                                    var k = v[0] = 0;
                                    for (f = c = 0; f < a.length; ++f) {
                                        var l = a[f];
                                        g.getQueryObjectEXT(l, 34919) ? (k += g.getQueryObjectEXT(l, 34918),
                                        h.push(l)) : a[c++] = l;
                                        E[f + 1] = k;
                                        v[f + 1] = c
                                    }
                                    a.length = c;
                                    for (f = c = 0; f < r.length; ++f) {
                                        var k = r[f]
                                          , m = k.startQueryIndex
                                          , l = k.endQueryIndex;
                                        k.sum += E[l] - E[m];
                                        m = v[m];
                                        l = v[l];
                                        l === m ? (k.stats.gpuTime += k.sum / 1E6,
                                        q.push(k)) : (k.startQueryIndex = m,
                                        k.endQueryIndex = l,
                                        r[c++] = k)
                                    }
                                    r.length = c
                                }
                            },
                            getNumPendingQueries: function() {
                                return a.length
                            },
                            clear: function() {
                                h.push.apply(h, a);
                                for (var c = 0; c < h.length; c++)
                                    g.deleteQueryEXT(h[c]);
                                a.length = 0;
                                h.length = 0
                            },
                            restore: function() {
                                a.length = 0;
                                h.length = 0
                            }
                        }
                    }
                }
                , {}],
                21: [function(c, r, A) {
                    function f(a) {
                        return "undefined" !== typeof btoa ? btoa(a) : "base64:" + a
                    }
                    function m(a) {
                        a = Error("(regl) " + a);
                        console.error(a);
                        throw a;
                    }
                    function k(a, e) {
                        a || m(e)
                    }
                    function l(a) {
                        return a ? ": " + a : ""
                    }
                    function g(a, e, c) {
                        0 > e.indexOf(a) && m("invalid value" + l(c) + ". must be one of: " + e)
                    }
                    function h(a, e) {
                        for (a += ""; a.length < e; )
                            a = " " + a;
                        return a
                    }
                    function a() {
                        this.name = "unknown";
                        this.lines = [];
                        this.index = {};
                        this.hasErrors = !1
                    }
                    function q(a, e) {
                        this.number = a;
                        this.line = e;
                        this.errors = []
                    }
                    function B(a, e, c) {
                        this.file = a;
                        this.line = e;
                        this.message = c
                    }
                    function E() {
                        var a = Error()
                          , a = (a.stack || a).toString()
                          , e = /compileProcedure.*\n\s*at.*\((.*)\)/.exec(a);
                        return e ? e[1] : (a = /compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(a)) ? a[1] : "unknown"
                    }
                    function v() {
                        var a = Error()
                          , a = (a.stack || a).toString()
                          , e = /at REGLCommand.*\n\s+at.*\((.*)\)/.exec(a);
                        return e ? e[1] : (a = /at REGLCommand.*\n\s+at\s+(.*)\n/.exec(a)) ? a[1] : "unknown"
                    }
                    function n(b, e) {
                        var c = b.split("\n")
                          , g = 1
                          , h = 0
                          , k = {
                            unknown: new a,
                            0: new a
                        };
                        k.unknown.name = k[0].name = e || E();
                        k.unknown.lines.push(new q(0,""));
                        for (var l = 0; l < c.length; ++l) {
                            var m = c[l]
                              , n = /^\s*\#\s*(\w+)\s+(.+)\s*$/.exec(m);
                            if (n)
                                switch (n[1]) {
                                case "line":
                                    if (n = /(\d+)(\s+\d+)?/.exec(n[2]))
                                        g = n[1] | 0,
                                        n[2] && (h = n[2] | 0,
                                        h in k || (k[h] = new a));
                                    break;
                                case "define":
                                    if (n = /SHADER_NAME(_B64)?\s+(.*)$/.exec(n[2]))
                                        k[h].name = n[1] ? f(n[2]) : n[2]
                                }
                            k[h].lines.push(new q(g++,m))
                        }
                        Object.keys(k).forEach(function(a) {
                            var b = k[a];
                            b.lines.forEach(function(a) {
                                b.index[a.number] = a
                            })
                        });
                        return k
                    }
                    function H(a) {
                        var e = [];
                        a.split("\n").forEach(function(a) {
                            if (!(5 > a.length)) {
                                var b = /^ERROR\:\s+(\d+)\:(\d+)\:\s*(.*)$/.exec(a);
                                b ? e.push(new B(b[1] | 0,b[2] | 0,b[3].trim())) : 0 < a.length && e.push(new B("unknown",0,a))
                            }
                        });
                        return e
                    }
                    function F(a, e) {
                        e.forEach(function(e) {
                            var c = a[e.file];
                            if (c) {
                                var f = c.index[e.line];
                                if (f) {
                                    f.errors.push(e);
                                    c.hasErrors = !0;
                                    return
                                }
                            }
                            a.unknown.hasErrors = !0;
                            a.unknown.lines[0].errors.push(e)
                        })
                    }
                    function K(a) {
                        a._commandRef = E()
                    }
                    function O(a, e) {
                        var c = v();
                        m(a + " in command " + (e || E()) + ("unknown" === c ? "" : " called from " + c))
                    }
                    function z(a, e, c, f) {
                        typeof a !== e && O("invalid parameter type" + l(c) + ". expected " + e + ", got " + typeof a, f || E())
                    }
                    function u(a, e) {
                        return 32820 === a || 32819 === a || 33635 === a ? 2 : 34042 === a ? 4 : G[a] * e
                    }
                    var Q = c("./is-typed-array");
                    c = c("./extend");
                    var Y = "gl canvas container attributes pixelRatio extensions optionalExtensions profile onDone".split(" ")
                      , G = {};
                    G[5120] = G[5121] = 1;
                    G[5122] = G[5123] = G[36193] = G[33635] = G[32819] = G[32820] = 2;
                    G[5124] = G[5125] = G[5126] = G[34042] = 4;
                    r.exports = c(k, {
                        optional: function(a) {
                            a()
                        },
                        raise: m,
                        commandRaise: O,
                        command: function(a, e, c) {
                            a || O(e, c || E())
                        },
                        parameter: function(a, e, c) {
                            a in e || m("unknown parameter (" + a + ")" + l(c) + ". possible values: " + Object.keys(e).join())
                        },
                        commandParameter: function(a, e, c, f) {
                            a in e || O("unknown parameter (" + a + ")" + l(c) + ". possible values: " + Object.keys(e).join(), f || E())
                        },
                        constructor: function(a) {
                            Object.keys(a).forEach(function(a) {
                                0 > Y.indexOf(a) && m('invalid regl constructor argument "' + a + '". must be one of ' + Y)
                            })
                        },
                        type: function(a, e, c) {
                            typeof a !== e && m("invalid parameter type" + l(c) + ". expected " + e + ", got " + typeof a)
                        },
                        commandType: z,
                        isTypedArray: function(a, e) {
                            Q(a) || m("invalid parameter type" + l(e) + ". must be a typed array")
                        },
                        nni: function(a, e) {
                            0 <= a && (a | 0) === a || m("invalid parameter type, (" + a + ")" + l(e) + ". must be a nonnegative integer")
                        },
                        oneOf: g,
                        shaderError: function(a, e, c, f, g) {
                            if (!a.getShaderParameter(e, a.COMPILE_STATUS)) {
                                e = a.getShaderInfoLog(e);
                                a = f === a.FRAGMENT_SHADER ? "fragment" : "vertex";
                                z(c, "string", a + " shader source must be a string", g);
                                var l = n(c, g);
                                c = H(e);
                                F(l, c);
                                Object.keys(l).forEach(function(a) {
                                    function b(a, e) {
                                        c.push(a);
                                        f.push(e || "")
                                    }
                                    var e = l[a];
                                    if (e.hasErrors) {
                                        var c = [""]
                                          , f = [""];
                                        b("file number " + a + ": " + e.name + "\n", "color:red;text-decoration:underline;font-weight:bold");
                                        e.lines.forEach(function(a) {
                                            if (0 < a.errors.length) {
                                                b(h(a.number, 4) + "|  ", "background-color:yellow; font-weight:bold");
                                                b(a.line + "\n", "color:red; background-color:yellow; font-weight:bold");
                                                var e = 0;
                                                a.errors.forEach(function(c) {
                                                    c = c.message;
                                                    var f = /^\s*\'(.*)\'\s*\:\s*(.*)$/.exec(c);
                                                    if (f) {
                                                        var g = f[1];
                                                        c = f[2];
                                                        switch (g) {
                                                        case "assign":
                                                            g = "="
                                                        }
                                                        e = Math.max(a.line.indexOf(g, e), 0)
                                                    } else
                                                        e = 0;
                                                    b(h("| ", 6));
                                                    b(h("^^^", e + 3) + "\n", "font-weight:bold");
                                                    b(h("| ", 6));
                                                    b(c + "\n", "font-weight:bold")
                                                });
                                                b(h("| ", 6) + "\n")
                                            } else
                                                b(h(a.number, 4) + "|  "),
                                                b(a.line + "\n", "color:red")
                                        });
                                        "undefined" !== typeof document ? (f[0] = c.join("%c"),
                                        console.log.apply(console, f)) : console.log(c.join(""))
                                    }
                                });
                                k.raise("Error compiling " + a + " shader, " + l[0].name)
                            }
                        },
                        linkError: function(a, e, c, f, g) {
                            a.getProgramParameter(e, a.LINK_STATUS) || (a = a.getProgramInfoLog(e),
                            c = n(c, g),
                            f = 'Error linking program with vertex shader, "' + n(f, g)[0].name + '", and fragment shader "' + c[0].name + '"',
                            "undefined" !== typeof document ? console.log("%c" + f + "\n%c" + a, "color:red;text-decoration:underline;font-weight:bold", "color:red") : console.log(f + "\n" + a),
                            k.raise(f))
                        },
                        callSite: v,
                        saveCommandRef: K,
                        saveDrawInfo: function(a, e, c, f) {
                            function g(a) {
                                return a ? f.id(a) : 0
                            }
                            function h(a, b) {
                                Object.keys(b).forEach(function(b) {
                                    a[f.id(b)] = !0
                                })
                            }
                            K(a);
                            a._fragId = g(a["static"].frag);
                            a._vertId = g(a["static"].vert);
                            var k = a._uniformSet = {};
                            h(k, e["static"]);
                            h(k, e.dynamic);
                            e = a._attributeSet = {};
                            h(e, c["static"]);
                            h(e, c.dynamic);
                            a._hasCount = "count"in a["static"] || "count"in a.dynamic || "elements"in a["static"] || "elements"in a.dynamic
                        },
                        framebufferFormat: function(a, e, c) {
                            a.texture ? g(a.texture._texture.internalformat, e, "unsupported texture format for attachment") : g(a.renderbuffer._renderbuffer.format, c, "unsupported renderbuffer format for attachment")
                        },
                        guessCommand: E,
                        texture2D: function(a, e, c) {
                            var f = e.width
                              , g = e.height
                              , h = e.channels;
                            k(0 < f && f <= c.maxTextureSize && 0 < g && g <= c.maxTextureSize, "invalid texture shape");
                            33071 === a.wrapS && 33071 === a.wrapT || k(!(f & f - 1) && !!f && !(g & g - 1) && !!g, "incompatible wrap mode for texture, both width and height must be power of 2");
                            1 === e.mipmask ? 1 !== f && 1 !== g && k(9984 !== a.minFilter && 9986 !== a.minFilter && 9985 !== a.minFilter && 9987 !== a.minFilter, "min filter requires mipmap") : (k(!(f & f - 1) && !!f && !(g & g - 1) && !!g, "texture must be a square power of 2 to support mipmapping"),
                            k(e.mipmask === (f << 1) - 1, "missing or incomplete mipmap data"));
                            5126 === e.type && (0 > c.extensions.indexOf("oes_texture_float_linear") && k(9728 === a.minFilter && 9728 === a.magFilter, "filter not supported, must enable oes_texture_float_linear"),
                            k(!a.genMipmaps, "mipmap generation not supported with float textures"));
                            var l = e.images;
                            for (c = 0; 16 > c; ++c)
                                if (l[c]) {
                                    var n = f >> c
                                      , m = g >> c;
                                    k(e.mipmask & 1 << c, "missing mipmap data");
                                    var q = l[c];
                                    k(q.width === n && q.height === m, "invalid shape for mip images");
                                    k(q.format === e.format && q.internalformat === e.internalformat && q.type === e.type, "incompatible type for mip image");
                                    q.compressed || q.data && k(q.data.byteLength === n * m * Math.max(u(q.type, h), q.unpackAlignment), "invalid data for image, buffer size is inconsistent with image format")
                                } else
                                    a.genMipmaps || k(0 === (e.mipmask & 1 << c), "extra mipmap data");
                            e.compressed && k(!a.genMipmaps, "mipmap generation for compressed images not supported")
                        },
                        textureCube: function(a, e, c, f) {
                            var g = a.width
                              , h = a.height
                              , l = a.channels;
                            k(0 < g && g <= f.maxTextureSize && 0 < h && h <= f.maxTextureSize, "invalid texture shape");
                            k(g === h, "cube map must be square");
                            k(33071 === e.wrapS && 33071 === e.wrapT, "wrap mode not supported by cube map");
                            for (f = 0; f < c.length; ++f) {
                                var n = c[f];
                                k(n.width === g && n.height === h, "inconsistent cube map face shape");
                                e.genMipmaps && (k(!n.compressed, "can not generate mipmap for compressed textures"),
                                k(1 === n.mipmask, "can not specify mipmaps and generate mipmaps"));
                                for (var m = n.images, q = 0; 16 > q; ++q) {
                                    var v = m[q];
                                    if (v) {
                                        var r = g >> q
                                          , B = h >> q;
                                        k(n.mipmask & 1 << q, "missing mipmap data");
                                        k(v.width === r && v.height === B, "invalid shape for mip images");
                                        k(v.format === a.format && v.internalformat === a.internalformat && v.type === a.type, "incompatible type for mip image");
                                        v.compressed || v.data && k(v.data.byteLength === r * B * Math.max(u(v.type, l), v.unpackAlignment), "invalid data for image, buffer size is inconsistent with image format")
                                    }
                                }
                            }
                        }
                    })
                }
                , {
                    "./extend": 24,
                    "./is-typed-array": 28
                }],
                22: [function(c, r, A) {
                    r.exports = "undefined" !== typeof performance && performance.now ? function() {
                        return performance.now()
                    }
                    : function() {
                        return +new Date
                    }
                }
                , {}],
                23: [function(c, r, A) {
                    function f(c) {
                        return Array.prototype.slice.call(c)
                    }
                    function m(c) {
                        return f(c).join("")
                    }
                    var k = c("./extend");
                    r.exports = function() {
                        function c() {
                            var a = []
                              , g = [];
                            return k(function() {
                                a.push.apply(a, f(arguments))
                            }, {
                                def: function() {
                                    var c = "v" + h++;
                                    g.push(c);
                                    0 < arguments.length && (a.push(c, "="),
                                    a.push.apply(a, f(arguments)),
                                    a.push(";"));
                                    return c
                                },
                                toString: function() {
                                    return m([0 < g.length ? "var " + g + ";" : "", m(a)])
                                }
                            })
                        }
                        function g() {
                            function a(c, f) {
                                h(c, f, "=", g.def(c, f), ";")
                            }
                            var g = c()
                              , h = c()
                              , m = g.toString
                              , q = h.toString;
                            return k(function() {
                                g.apply(g, f(arguments))
                            }, {
                                def: g.def,
                                entry: g,
                                exit: h,
                                save: a,
                                set: function(c, f, h) {
                                    a(c, f);
                                    g(c, f, "=", h, ";")
                                },
                                toString: function() {
                                    return m() + q()
                                }
                            })
                        }
                        var h = 0
                          , a = []
                          , q = []
                          , r = c()
                          , E = {};
                        return {
                            global: r,
                            link: function(c) {
                                for (var f = 0; f < q.length; ++f)
                                    if (q[f] === c)
                                        return a[f];
                                f = "g" + h++;
                                a.push(f);
                                q.push(c);
                                return f
                            },
                            block: c,
                            proc: function(a, c) {
                                function f() {
                                    var a = "a" + h.length;
                                    h.push(a);
                                    return a
                                }
                                var h = [];
                                c = c || 0;
                                for (var l = 0; l < c; ++l)
                                    f();
                                var l = g()
                                  , q = l.toString;
                                return E[a] = k(l, {
                                    arg: f,
                                    toString: function() {
                                        return m(["function(", h.join(), "){", q(), "}"])
                                    }
                                })
                            },
                            scope: g,
                            cond: function() {
                                var a = m(arguments)
                                  , c = g()
                                  , h = g()
                                  , l = c.toString
                                  , q = h.toString;
                                return k(c, {
                                    then: function() {
                                        c.apply(c, f(arguments));
                                        return this
                                    },
                                    "else": function() {
                                        h.apply(h, f(arguments));
                                        return this
                                    },
                                    toString: function() {
                                        var c = q();
                                        c && (c = "else{" + c + "}");
                                        return m(["if(", a, "){", l(), "}", c])
                                    }
                                })
                            },
                            compile: function() {
                                var c = ['"use strict";', r, "return {"];
                                Object.keys(E).forEach(function(a) {
                                    c.push('"', a, '":', E[a].toString(), ",")
                                });
                                c.push("}");
                                var f = m(c).replace(/;/g, ";\n").replace(/}/g, "}\n").replace(/{/g, "{\n");
                                return Function.apply(null, a.concat(f)).apply(null, q)
                            }
                        }
                    }
                }
                , {
                    "./extend": 24
                }],
                24: [function(c, r, A) {
                    r.exports = function(c, m) {
                        for (var k = Object.keys(m), l = 0; l < k.length; ++l)
                            c[k[l]] = m[k[l]];
                        return c
                    }
                }
                , {}],
                25: [function(c, r, A) {
                    function f(c, f, h, a, k, m) {
                        for (var r = 0; r < f; ++r)
                            for (var v = c[r], n = 0; n < h; ++n)
                                for (var A = v[n], F = 0; F < a; ++F)
                                    k[m++] = A[F]
                    }
                    function m(c, g, h, a, k) {
                        for (var r = 1, E = h + 1; E < g.length; ++E)
                            r *= g[E];
                        var v = g[h];
                        if (4 === g.length - h) {
                            var n = g[h + 1]
                              , A = g[h + 2];
                            g = g[h + 3];
                            for (E = 0; E < v; ++E)
                                f(c[E], n, A, g, a, k),
                                k += r
                        } else
                            for (E = 0; E < v; ++E)
                                m(c[E], g, h + 1, a, k),
                                k += r
                    }
                    var k = c("./pool");
                    r.exports = {
                        shape: function(c) {
                            for (var f = []; c.length; c = c[0])
                                f.push(c.length);
                            return f
                        },
                        flatten: function(c, g, h, a) {
                            var q = 1;
                            if (g.length)
                                for (var r = 0; r < g.length; ++r)
                                    q *= g[r];
                            else
                                q = 0;
                            h = a || k.allocType(h, q);
                            switch (g.length) {
                            case 0:
                                break;
                            case 1:
                                a = g[0];
                                for (g = 0; g < a; ++g)
                                    h[g] = c[g];
                                break;
                            case 2:
                                a = g[0];
                                g = g[1];
                                for (r = q = 0; r < a; ++r)
                                    for (var E = c[r], v = 0; v < g; ++v)
                                        h[q++] = E[v];
                                break;
                            case 3:
                                f(c, g[0], g[1], g[2], h, 0);
                                break;
                            default:
                                m(c, g, 0, h, 0)
                            }
                            return h
                        }
                    }
                }
                , {
                    "./pool": 30
                }],
                26: [function(c, r, A) {
                    var f = c("./is-typed-array");
                    r.exports = function(c) {
                        return Array.isArray(c) || f(c)
                    }
                }
                , {
                    "./is-typed-array": 28
                }],
                27: [function(c, r, A) {
                    var f = c("./is-typed-array");
                    r.exports = function(c) {
                        return !!c && "object" === typeof c && Array.isArray(c.shape) && Array.isArray(c.stride) && "number" === typeof c.offset && c.shape.length === c.stride.length && (Array.isArray(c.data) || f(c.data))
                    }
                }
                , {
                    "./is-typed-array": 28
                }],
                28: [function(c, r, A) {
                    var f = c("../constants/arraytypes.json");
                    r.exports = function(c) {
                        return Object.prototype.toString.call(c)in f
                    }
                }
                , {
                    "../constants/arraytypes.json": 4
                }],
                29: [function(c, r, A) {
                    r.exports = function(c, m) {
                        for (var k = Array(c), l = 0; l < c; ++l)
                            k[l] = m(l);
                        return k
                    }
                }
                , {}],
                30: [function(c, r, A) {
                    function f(c) {
                        var f, a;
                        f = (65535 < c) << 4;
                        c >>>= f;
                        a = (255 < c) << 3;
                        c >>>= a;
                        f |= a;
                        a = (15 < c) << 2;
                        c >>>= a;
                        f |= a;
                        a = (3 < c) << 1;
                        return f | a | c >>> a >> 1
                    }
                    function m(c) {
                        a: {
                            for (var h = 16; 268435456 >= h; h *= 16)
                                if (c <= h) {
                                    c = h;
                                    break a
                                }
                            c = 0
                        }
                        h = l[f(c) >> 2];
                        return 0 < h.length ? h.pop() : new ArrayBuffer(c)
                    }
                    function k(c) {
                        l[f(c.byteLength) >> 2].push(c)
                    }
                    var l = c("./loop")(8, function() {
                        return []
                    });
                    r.exports = {
                        alloc: m,
                        free: k,
                        allocType: function(c, f) {
                            var a = null;
                            switch (c) {
                            case 5120:
                                a = new Int8Array(m(f),0,f);
                                break;
                            case 5121:
                                a = new Uint8Array(m(f),0,f);
                                break;
                            case 5122:
                                a = new Int16Array(m(2 * f),0,f);
                                break;
                            case 5123:
                                a = new Uint16Array(m(2 * f),0,f);
                                break;
                            case 5124:
                                a = new Int32Array(m(4 * f),0,f);
                                break;
                            case 5125:
                                a = new Uint32Array(m(4 * f),0,f);
                                break;
                            case 5126:
                                a = new Float32Array(m(4 * f),0,f);
                                break;
                            default:
                                return null
                            }
                            return a.length !== f ? a.subarray(0, f) : a
                        },
                        freeType: function(c) {
                            k(c.buffer)
                        }
                    }
                }
                , {
                    "./loop": 29
                }],
                31: [function(c, r, A) {
                    r.exports = {
                        next: "function" === typeof requestAnimationFrame ? function(c) {
                            return requestAnimationFrame(c)
                        }
                        : function(c) {
                            return setTimeout(c, 16)
                        }
                        ,
                        cancel: "function" === typeof cancelAnimationFrame ? function(c) {
                            return cancelAnimationFrame(c)
                        }
                        : clearTimeout
                    }
                }
                , {}],
                32: [function(c, r, A) {
                    var f = c("./pool")
                      , m = new Float32Array(1)
                      , k = new Uint32Array(m.buffer);
                    r.exports = function(c) {
                        for (var g = f.allocType(5123, c.length), h = 0; h < c.length; ++h)
                            if (isNaN(c[h]))
                                g[h] = 65535;
                            else if (Infinity === c[h])
                                g[h] = 31744;
                            else if (-Infinity === c[h])
                                g[h] = 64512;
                            else {
                                m[0] = c[h];
                                var a = k[0]
                                  , q = a >>> 31 << 15
                                  , r = (a << 1 >>> 24) - 127
                                  , a = a >> 13 & 1023;
                                g[h] = -24 > r ? q : -14 > r ? q + (a + 1024 >> -14 - r) : 15 < r ? q + 31744 : q + (r + 15 << 10) + a
                            }
                        return g
                    }
                }
                , {
                    "./pool": 30
                }],
                33: [function(c, r, A) {
                    r.exports = function(c) {
                        return Object.keys(c).map(function(m) {
                            return c[m]
                        })
                    }
                }
                , {}],
                34: [function(c, r, A) {
                    function f(a, c, f) {
                        function g() {
                            var c = window.innerWidth
                              , l = window.innerHeight;
                            a !== document.body && (l = a.getBoundingClientRect(),
                            c = l.right - l.left,
                            l = l.bottom - l.top);
                            k.width = f * c;
                            k.height = f * l;
                            h(k.style, {
                                width: c + "px",
                                height: l + "px"
                            })
                        }
                        var k = document.createElement("canvas");
                        h(k.style, {
                            border: 0,
                            margin: 0,
                            padding: 0,
                            top: 0,
                            left: 0
                        });
                        a.appendChild(k);
                        a === document.body && (k.style.position = "absolute",
                        h(a.style, {
                            margin: 0,
                            padding: 0
                        }));
                        window.addEventListener("resize", g, !1);
                        g();
                        return {
                            canvas: k,
                            onDestroy: function() {
                                window.removeEventListener("resize", g);
                                a.removeChild(k)
                            }
                        }
                    }
                    function m(a, c) {
                        function f(g) {
                            try {
                                return a.getContext(g, c)
                            } catch (k) {
                                return null
                            }
                        }
                        return f("webgl") || f("experimental-webgl") || f("webgl-experimental")
                    }
                    function k(a) {
                        if ("string" === typeof a)
                            return a.split();
                        g(Array.isArray(a), "invalid extension array");
                        return a
                    }
                    function l(a) {
                        return "string" === typeof a ? (g("undefined" !== typeof document, "not supported outside of DOM"),
                        document.querySelector(a)) : a
                    }
                    var g = c("./util/check")
                      , h = c("./util/extend");
                    r.exports = function(a) {
                        var c = a || {}, h, r, v, n;
                        a = {};
                        var A = []
                          , F = []
                          , K = "undefined" === typeof window ? 1 : window.devicePixelRatio
                          , O = !1
                          , z = function(a) {
                            a && g.raise(a)
                        }
                          , u = function() {};
                        "string" === typeof c ? (g("undefined" !== typeof document, "selector queries only supported in DOM enviroments"),
                        h = document.querySelector(c),
                        g(h, "invalid query string for element")) : "object" === typeof c ? "string" === typeof c.nodeName && "function" === typeof c.appendChild && "function" === typeof c.getBoundingClientRect ? h = c : "function" === typeof c.drawArrays || "function" === typeof c.drawElements ? (n = c,
                        v = n.canvas) : (g.constructor(c),
                        "gl"in c ? n = c.gl : "canvas"in c ? v = l(c.canvas) : "container"in c && (r = l(c.container)),
                        "attributes"in c && (a = c.attributes,
                        g.type(a, "object", "invalid context attributes")),
                        "extensions"in c && (A = k(c.extensions)),
                        "optionalExtensions"in c && (F = k(c.optionalExtensions)),
                        "onDone"in c && (g.type(c.onDone, "function", "invalid or missing onDone callback"),
                        z = c.onDone),
                        "profile"in c && (O = !!c.profile),
                        "pixelRatio"in c && (K = +c.pixelRatio,
                        g(0 < K, "invalid pixel ratio"))) : g.raise("invalid arguments to regl");
                        h && ("canvas" === h.nodeName.toLowerCase() ? v = h : r = h);
                        if (!n) {
                            if (!v) {
                                g("undefined" !== typeof document, "must manually specify webgl context outside of DOM environments");
                                h = f(r || document.body, z, K);
                                if (!h)
                                    return null;
                                v = h.canvas;
                                u = h.onDestroy
                            }
                            n = m(v, a)
                        }
                        return n ? {
                            gl: n,
                            canvas: v,
                            container: r,
                            extensions: A,
                            optionalExtensions: F,
                            pixelRatio: K,
                            profile: O,
                            onDone: z,
                            onDestroy: u
                        } : (u(),
                        z("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),
                        null)
                    }
                }
                , {
                    "./util/check": 21,
                    "./util/extend": 24
                }],
                35: [function(c, r, A) {
                    function f(a, c) {
                        for (var f = 0; f < a.length; ++f)
                            if (a[f] === c)
                                return f;
                        return -1
                    }
                    var m = c("./lib/util/check")
                      , k = c("./lib/util/extend")
                      , l = c("./lib/dynamic")
                      , g = c("./lib/util/raf")
                      , h = c("./lib/util/clock")
                      , a = c("./lib/strings")
                      , q = c("./lib/webgl")
                      , B = c("./lib/extension")
                      , E = c("./lib/limits")
                      , v = c("./lib/buffer")
                      , n = c("./lib/elements")
                      , H = c("./lib/texture")
                      , F = c("./lib/renderbuffer")
                      , K = c("./lib/framebuffer")
                      , O = c("./lib/attribute")
                      , z = c("./lib/shader")
                      , u = c("./lib/read")
                      , Q = c("./lib/core")
                      , Y = c("./lib/stats")
                      , G = c("./lib/timer");
                    r.exports = function(b) {
                        function c() {
                            if (0 === S.length)
                                N && N.update(),
                                ja = null;
                            else {
                                ja = g.next(c);
                                ba();
                                for (var a = S.length - 1; 0 <= a; --a) {
                                    var b = S[a];
                                    b && b(fa, null, 0)
                                }
                                I.flush();
                                N && N.update()
                            }
                        }
                        function r() {
                            !ja && 0 < S.length && (ja = g.next(c))
                        }
                        function A() {
                            ja && (g.cancel(c),
                            ja = null)
                        }
                        function Ga(a) {
                            a.preventDefault();
                            da = !0;
                            A();
                            ca.forEach(function(a) {
                                a()
                            })
                        }
                        function Ca(a) {
                            I.getError();
                            da = !1;
                            pa.restore();
                            na.restore();
                            la.restore();
                            qa.restore();
                            xa.restore();
                            X.restore();
                            N && N.restore();
                            R.procs.refresh();
                            r();
                            ha.forEach(function(a) {
                                a()
                            })
                        }
                        function Z(a) {
                            function b(a) {
                                var c = {}
                                  , e = {};
                                Object.keys(a).forEach(function(b) {
                                    var f = a[b];
                                    l.isDynamic(f) ? e[b] = l.unbox(f, b) : c[b] = f
                                });
                                return {
                                    dynamic: e,
                                    "static": c
                                }
                            }
                            function c(a) {
                                for (; u.length < a; )
                                    u.push(null);
                                return u
                            }
                            m(!!a, "invalid args to regl({...})");
                            m.type(a, "object", "invalid args to regl({...})");
                            var e = b(a.context || {})
                              , f = b(a.uniforms || {})
                              , g = b(a.attributes || {})
                              , h = b(function(a) {
                                function b(a) {
                                    if (a in c) {
                                        var d = c[a];
                                        delete c[a];
                                        Object.keys(d).forEach(function(b) {
                                            c[a + "." + b] = d[b]
                                        })
                                    }
                                }
                                var c = k({}, a);
                                delete c.uniforms;
                                delete c.attributes;
                                delete c.context;
                                "stencil"in c && c.stencil.op && (c.stencil.opBack = c.stencil.opFront = c.stencil.op,
                                delete c.stencil.op);
                                b("blend");
                                b("depth");
                                b("cull");
                                b("stencil");
                                b("polygonOffset");
                                b("scissor");
                                b("sample");
                                return c
                            }(a));
                            a = {
                                gpuTime: 0,
                                cpuTime: 0,
                                count: 0
                            };
                            var e = R.compile(h, g, f, e, a)
                              , n = e.draw
                              , q = e.batch
                              , r = e.scope
                              , u = [];
                            return k(function(a, b) {
                                var e;
                                da && m.raise("context lost");
                                if ("function" === typeof a)
                                    return r.call(this, null, a, 0);
                                if ("function" === typeof b)
                                    if ("number" === typeof a)
                                        for (e = 0; e < a; ++e)
                                            r.call(this, null, b, e);
                                    else if (Array.isArray(a))
                                        for (e = 0; e < a.length; ++e)
                                            r.call(this, a[e], b, e);
                                    else
                                        return r.call(this, a, b, 0);
                                else if ("number" === typeof a) {
                                    if (0 < a)
                                        return q.call(this, c(a | 0), a | 0)
                                } else if (Array.isArray(a)) {
                                    if (a.length)
                                        return q.call(this, a, a.length)
                                } else
                                    return n.call(this, a)
                            }, {
                                stats: a
                            })
                        }
                        function L(a, b) {
                            var c = 0;
                            R.procs.poll();
                            var e = b.color;
                            e && (I.clearColor(+e[0] || 0, +e[1] || 0, +e[2] || 0, +e[3] || 0),
                            c |= 16384);
                            "depth"in b && (I.clearDepth(+b.depth),
                            c |= 256);
                            "stencil"in b && (I.clearStencil(b.stencil | 0),
                            c |= 1024);
                            m(!!c, "called regl.clear with no buffer specified");
                            I.clear(c)
                        }
                        function W(a) {
                            m.type(a, "function", "regl.frame() callback must be a function");
                            S.push(a);
                            r();
                            return {
                                cancel: function() {
                                    function b() {
                                        var a = f(S, b);
                                        S[a] = S[S.length - 1];
                                        --S.length;
                                        0 >= S.length && A()
                                    }
                                    var c = f(S, a);
                                    m(0 <= c, "cannot cancel a frame twice");
                                    S[c] = b
                                }
                            }
                        }
                        function J() {
                            var a = ia.viewport
                              , b = ia.scissor_box;
                            a[0] = a[1] = b[0] = b[1] = 0;
                            fa.viewportWidth = fa.framebufferWidth = fa.drawingBufferWidth = a[2] = b[2] = I.drawingBufferWidth;
                            fa.viewportHeight = fa.framebufferHeight = fa.drawingBufferHeight = a[3] = b[3] = I.drawingBufferHeight
                        }
                        function ba() {
                            fa.tick += 1;
                            fa.time = x();
                            J();
                            R.procs.poll()
                        }
                        function aa() {
                            J();
                            R.procs.refresh();
                            N && N.update()
                        }
                        function x() {
                            return (h() - Ba) / 1E3
                        }
                        b = q(b);
                        if (!b)
                            return null;
                        var I = b.gl
                          , Da = I.getContextAttributes()
                          , da = I.isContextLost()
                          , pa = B(I, b);
                        if (!pa)
                            return null;
                        var va = a()
                          , ea = Y()
                          , T = pa.extensions
                          , N = G(I, T)
                          , Ba = h()
                          , sa = I.drawingBufferWidth
                          , wa = I.drawingBufferHeight
                          , fa = {
                            tick: 0,
                            time: 0,
                            viewportWidth: sa,
                            viewportHeight: wa,
                            framebufferWidth: sa,
                            framebufferHeight: wa,
                            drawingBufferWidth: sa,
                            drawingBufferHeight: wa,
                            pixelRatio: b.pixelRatio
                        }
                          , ka = E(I, T)
                          , la = v(I, ea, b)
                          , ma = n(I, T, la, ea)
                          , sa = O(I, T, ka, la, va)
                          , na = z(I, va, ea, b)
                          , qa = H(I, T, ka, function() {
                            R.procs.poll()
                        }, fa, ea, b)
                          , xa = F(I, T, ka, ea, b)
                          , X = K(I, T, ka, qa, xa, ea)
                          , R = Q(I, va, T, ka, la, ma, qa, X, {}, sa, na, {
                            elements: null,
                            primitive: 4,
                            count: -1,
                            offset: 0,
                            instances: -1
                        }, fa, N, b)
                          , va = u(I, X, R.procs.poll, fa, Da, T)
                          , ia = R.next
                          , oa = I.canvas
                          , S = []
                          , ca = []
                          , ha = []
                          , ya = [b.onDestroy]
                          , ja = null;
                        oa && (oa.addEventListener("webglcontextlost", Ga, !1),
                        oa.addEventListener("webglcontextrestored", Ca, !1));
                        var ta = X.setFBO = Z({
                            framebuffer: l.define.call(null, 1, "framebuffer")
                        });
                        aa();
                        Da = k(Z, {
                            clear: function(a) {
                                m("object" === typeof a && a, "regl.clear() takes an object as input");
                                if ("framebuffer"in a)
                                    if (a.framebuffer && "framebufferCube" === a.framebuffer_reglType)
                                        for (var b = 0; 6 > b; ++b)
                                            ta(k({
                                                framebuffer: a.framebuffer.faces[b]
                                            }, a), L);
                                    else
                                        ta(a, L);
                                else
                                    L(null, a)
                            },
                            prop: l.define.bind(null, 1),
                            context: l.define.bind(null, 2),
                            "this": l.define.bind(null, 3),
                            draw: Z({}),
                            buffer: function(a) {
                                return la.create(a, 34962, !1, !1)
                            },
                            elements: function(a) {
                                return ma.create(a, !1)
                            },
                            texture: qa.create2D,
                            cube: qa.createCube,
                            renderbuffer: xa.create,
                            framebuffer: X.create,
                            framebufferCube: X.createCube,
                            attributes: Da,
                            frame: W,
                            on: function(a, b) {
                                m.type(b, "function", "listener callback must be a function");
                                var c;
                                switch (a) {
                                case "frame":
                                    return W(b);
                                case "lost":
                                    c = ca;
                                    break;
                                case "restore":
                                    c = ha;
                                    break;
                                case "destroy":
                                    c = ya;
                                    break;
                                default:
                                    m.raise("invalid event, must be one of frame,lost,restore,destroy")
                                }
                                c.push(b);
                                return {
                                    cancel: function() {
                                        for (var a = 0; a < c.length; ++a)
                                            if (c[a] === b) {
                                                c[a] = c[c.length - 1];
                                                c.pop();
                                                break
                                            }
                                    }
                                }
                            },
                            limits: ka,
                            hasExtension: function(a) {
                                return 0 <= ka.extensions.indexOf(a.toLowerCase())
                            },
                            read: va,
                            destroy: function() {
                                S.length = 0;
                                A();
                                oa && (oa.removeEventListener("webglcontextlost", Ga),
                                oa.removeEventListener("webglcontextrestored", Ca));
                                na.clear();
                                X.clear();
                                xa.clear();
                                qa.clear();
                                ma.clear();
                                la.clear();
                                N && N.clear();
                                ya.forEach(function(a) {
                                    a()
                                })
                            },
                            _gl: I,
                            _refresh: aa,
                            poll: function() {
                                ba();
                                N && N.update()
                            },
                            now: x,
                            stats: ea
                        });
                        b.onDone(null, Da);
                        return Da
                    }
                }
                , {
                    "./lib/attribute": 2,
                    "./lib/buffer": 3,
                    "./lib/core": 8,
                    "./lib/dynamic": 9,
                    "./lib/elements": 10,
                    "./lib/extension": 11,
                    "./lib/framebuffer": 12,
                    "./lib/limits": 13,
                    "./lib/read": 14,
                    "./lib/renderbuffer": 15,
                    "./lib/shader": 16,
                    "./lib/stats": 17,
                    "./lib/strings": 18,
                    "./lib/texture": 19,
                    "./lib/timer": 20,
                    "./lib/util/check": 21,
                    "./lib/util/clock": 22,
                    "./lib/util/extend": 24,
                    "./lib/util/raf": 31,
                    "./lib/webgl": 34
                }]
            }, {}, [1]);
    </script>
    <style>
        body {
            margin: 0px;
        }

        canvas {
            width: 100% !important;
            height: 100% !important;
            object-fit: contain;
            position: fixed;
            top: 0;
            left: 0;
        }
    </style>
</head>
<body>
<script type="text/javascript">
    const rand = mathRand();

    // ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ Add traits here ↓↓↓↓↓↓↓↓↓↓↓↓↓↓

    function T1(rand) {
        // calculate rarity by yourself
        if (rand > 0.1) {
            return true;
        } else {
            return false
        }
    }
        function T2(rand) {
        // calculate rarity by yourself
        if (rand > 0.2) {
            return true;
        } else {
            return false
        }
    }
        function T3(rand) {
        // calculate rarity by yourself
        if (rand > 0.3) {
            return true;
        } else {
            return false
        }
    }
        function T4(rand) {
        // calculate rarity by yourself
        if (rand > 0.4) {
            return true;
        } else {
            return false
        }
    }
        function T5(rand) {
        // calculate rarity by yourself
        if (rand > 0.5) {
            return true;
        } else {
            return false
        }
    }

    // window.$generativeTraits contain list traits for token
    // you need to populate a $generativeTraits object in the window object
    window.$generativeTraits = {
        "T1": T1(rand),
        "T2": T2(rand),
        "T3": T3(rand),
        "T4": T4(rand),
        "T5": T5(rand),
        
    }
    console.log(window.$generativeTraits)

    // ↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑ Add traits here ↑↑↑↑↑↑↑↑↑↑↑↑↑↑


    // ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ Add your code here ↓↓↓↓↓↓↓↓↓↓↓↓↓↓

    const container = document.createElement("div")
    container.innerHTML = "<span>seed: " + seed + "</span><br>";
    document.body.prepend(container)

        // Generative code using regl, mathRand, and life.js
        const draw = regl({
            frag: `
                precision mediump float;
                uniform float time;
                void main () {
                    gl_FragColor = vec4(mathRand(0.0, 1.0), mathRand(0.0, 1.0), mathRand(0.0, 1.0), 1.0);
                }
            `,
            vert: `
                precision mediump float;
                attribute vec2 position;
                void main () {
                    gl_Position = vec4(position, 0, 1);
                }
            `,
            attributes: {
                position: [mathRand(-2, 2), mathRand(-2, 2), mathRand(-2, 2), mathRand(-2, 2), mathRand(-2, 2), mathRand(-2, 2)],
            },
            count: 3,
            uniforms: {
                time: ({ time }) => time,
            },
        });

        // Life.js rendering
        const lifeDraw = life({
            // Configuration options for life.js
            // ...
        });

        // Rendering loop
        function render() {
            regl.clear({
                color: [0, 0, 0, 1],
            });
            draw();
            lifeDraw();
            requestAnimationFrame(render);
        }

        // Start rendering loop
        render();

    // ↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑ Add your code here ↑↑↑↑↑↑↑↑↑↑↑↑↑↑

</script>
</body>
</html>
        // ↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑ Add your script for lib here ↑↑↑↑↑↑↑↑↑↑↑↑↑↑

    </script>

    <script id="snippet-random-code" type="text/javascript">

        // DO NOT EDIT THIS SECTION

        let seed = window.location.href.split('/').find(t => t.includes('i0'));

        if (seed == null) {
            const alphabet = "0123456789abcdefghijklmnopqrstuvwsyz";
            seed = new URLSearchParams(window.location.search).get("seed") || Array(64).fill(0).map(_ => alphabet[(Math.random() * alphabet.length) | 0]).join('') + "i0";
        } else {
            let pattern = "seed=";
            for (let i = 0; i < seed.length - pattern.length; ++i) {
                if (seed.substring(i, i + pattern.length) == pattern) {
                    seed = seed.substring(i + pattern.length);
                    break;
                }
            }
        }

        function cyrb128($) {
            let _ = 1779033703, u = 3144134277, i = 1013904242, l = 2773480762;
            for (let n = 0, r; n < $.length; n++) _ = u ^ Math.imul(_ ^ (r = $.charCodeAt(n)), 597399067), u = i ^ Math.imul(u ^ r, 2869860233), i = l ^ Math.imul(i ^ r, 951274213), l = _ ^ Math.imul(l ^ r, 2716044179);
            return _ = Math.imul(i ^ _ >>> 18, 597399067), u = Math.imul(l ^ u >>> 22, 2869860233), i = Math.imul(_ ^ i >>> 17, 951274213), l = Math.imul(u ^ l >>> 19, 2716044179), [(_ ^ u ^ i ^ l) >>> 0, (u ^ _) >>> 0, (i ^ _) >>> 0, (l ^ _) >>> 0]
        }

        function sfc32($, _, u, i) {
            return function () {
                u >>>= 0, i >>>= 0;
                var l = ($ >>>= 0) + (_ >>>= 0) | 0;
                return $ = _ ^ _ >>> 9, _ = u + (u << 3) | 0, u = (u = u << 21 | u >>> 11) + (l = l + (i = i + 1 | 0) | 0) | 0, (l >>> 0) / 4294967296
            }
        }


        // IMPORTANT: Instead of Math.random(), use this function mathRand() for random number generation.
        // This function generates a random number between 0 and 1 with on-chain seed.

        let mathRand = sfc32(...cyrb128(seed));

    </script>
    <style>
        body {
            margin: 0px;
        }

        canvas {
            width: 100% !important;
            height: 100% !important;
            object-fit: contain;
            position: fixed;
            top: 0;
            left: 0;
        }
    </style>
</head>
<body>
<script type="text/javascript">
    const rand = mathRand();

    // ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ Add traits here ↓↓↓↓↓↓↓↓↓↓↓↓↓↓

    function T1(rand) {
        // calculate rarity by yourself
        if (rand > 0.1) {
            return true;
        } else {
            return false
        }
    }
        function T2(rand) {
        // calculate rarity by yourself
        if (rand > 0.2) {
            return true;
        } else {
            return false
        }
    }
        function T3(rand) {
        // calculate rarity by yourself
        if (rand > 0.3) {
            return true;
        } else {
            return false
        }
    }
        function T4(rand) {
        // calculate rarity by yourself
        if (rand > 0.4) {
            return true;
        } else {
            return false
        }
    }
        function T5(rand) {
        // calculate rarity by yourself
        if (rand > 0.5) {
            return true;
        } else {
            return false
        }
    }

    // window.$generativeTraits contain list traits for token
    // you need to populate a $generativeTraits object in the window object
    window.$generativeTraits = {
        "T1": T1(rand),
        "T2": T2(rand),
        "T3": T3(rand),
        "T4": T4(rand),
        "T5": T5(rand),
        
    }
    console.log(window.$generativeTraits)

    // ↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑ Add traits here ↑↑↑↑↑↑↑↑↑↑↑↑↑↑


    // ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ Add your code here ↓↓↓↓↓↓↓↓↓↓↓↓↓↓

    const container = document.createElement("div")
    container.innerHTML = "<span>seed: " + seed + "</span><br>";
    document.body.prepend(container)

        // Generative code using regl, mathRand, and life.js
        const draw = regl({
            frag: `
                precision mediump float;
                uniform float time;
                void main () {
                    gl_FragColor = vec4(mathRand(0.0, 1.0), mathRand(0.0, 1.0), mathRand(0.0, 1.0), 1.0);
                }
            `,
            vert: `
                precision mediump float;
                attribute vec2 position;
                void main () {
                    gl_Position = vec4(position, 0, 1);
                }
            `,
            attributes: {
                position: [mathRand(-2, 2), mathRand(-2, 2), mathRand(-2, 2), mathRand(-2, 2), mathRand(-2, 2), mathRand(-2, 2)],
            },
            count: 3,
            uniforms: {
                time: ({ time }) => time,
            },
        });

        // Life.js rendering
        const lifeDraw = life({
            // Configuration options for life.js
            // ...
        });

        // Rendering loop
        function render() {
            regl.clear({
                color: [0, 0, 0, 1],
            });
            draw();
            lifeDraw();
            requestAnimationFrame(render);
        }

        // Start rendering loop
        render();

    // ↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑ Add your code here ↑↑↑↑↑↑↑↑↑↑↑↑↑↑

</script>
</body>
</html>
